var ControlsMessage={TimesetError:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u5b9a\u65f6\u53d1\u4fe1\u8bb0\u5f55\u5417\uff1f",Disk_img_3ImgError:"\u8bf7\u8f93\u5165\u56fe\u7247\u5730\u5740",Disk_img_3RightError:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u56fe\u7247\u5730\u5740",Disk_img_1SelError:"\u8bf7\u9009\u62e9jpg\u3001jpeg\u3001gif\u3001png\u3001bmp\u683c\u5f0f\u7684\u56fe\u7247",Disk_img_1ImgError:"\u8bf7\u9009\u62e9\u56fe\u7247",Disk_img_1InsertError:"\u63d2\u5165\u56fe\u7247\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",WeatherSetSuccess:"\u8bbe\u7f6e\u6210\u529f",WeatherCityError:"\u8bf7\u9009\u62e9\u57ce\u5e02!",CustomfunRetainError:"\u8bf7\u81f3\u5c11\u4fdd\u7559\u4e00\u9879\u5e94\u7528",AddfolderDirEmptyError:"\u6587\u4ef6\u5939\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a",AddfolderDirOverError:"\u5bf9\u4e0d\u8d77\uff0c\u81ea\u5b9a\u4e49\u6587\u4ef6\u5939\u4e2a\u6570\u4e0d\u80fd\u8d85\u8fc7{0}\u4e2a",AddfolderMailError:"\u8bf7\u586b\u5199\u90ae\u7bb1\u5730\u5740",AddfolderWrongfulError:"\u90ae\u4ef6\u5730\u5740\u4e0d\u5408\u6cd5\uff0c\u8bf7\u91cd\u65b0\u586b\u5199\uff01",AddfolderAddNotice:"\u6b63\u5728\u6dfb\u52a0...",ContactWhiteError:"\u8be5\u5e10\u53f7\u5df2\u7ecf\u5728\u767d\u540d\u5355\u4e2d",ContactTryError:"\u670d\u52a1\u5668\u7e41\u5fd9,\u8bf7\u7a0d\u540e\u518d\u8bd5",ContactBlackError:"\u8be5\u5e10\u53f7\u5df2\u7ecf\u5728\u9ed1\u540d\u5355\u4e2d",ContactAddSuccess:"\u6dfb\u52a0\u6210\u529f!",ContactSaveSuccess:"\u4fdd\u5b58\u6210\u529f",ContactMobileEmpty:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801",ContactMobileError:"\u624b\u673a\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u586b\u5199\uff01",ContactWhiteConfirm:"<div style='font-size:12px'>\u6dfb\u52a0\u5230\u624b\u673a\u90ae\u4ef6<span style='color:rgb(246,110,33)'>\u767d\u540d\u5355</span>\uff0c\u6b64\u8054\u7cfb\u4eba\u6765\u4fe1\u901a\u77e5<br/><span style='color:rgb(246,110,33)'>\u53d1\u9001\u5230\u624b\u673a</span><br />    \u60a8\u53ef\u4ee5<a href='javascript:;' onclick='top.Links.show(\"mailnotify\",\"&whiteList=true\");FF.close();return false;'>\u6dfb\u52a0\u591a\u4e2a\u5730\u5740\u5230\u767d\u540d\u5355</a></div>",ContactBlackConfirm:"<div style='font-size:12px'>\u6dfb\u52a0\u5230\u624b\u673a\u90ae\u4ef6<span style='color:rgb(246,110,33)'>\u9ed1\u540d\u5355</span>\uff0c\u6b64\u8054\u7cfb\u4eba\u6765\u4fe1\u901a\u77e5<br/><span style='color:rgb(246,110,33)'>\u4e0d\u53d1\u9001\u5230\u624b\u673a</span><br />    \u60a8\u53ef\u4ee5<a href='javascript:;' onclick='top.Links.show(\"mailnotify\",\"&whiteList=true\");FF.close();return false;'>\u6dfb\u52a0\u591a\u4e2a\u5730\u5740\u5230\u9ed1\u540d\u5355</a></div>",ContactLoading:"\u52a0\u8f7d\u4e2d...",ScreenshotLoading:"\u6587\u4ef6\u4e0a\u4f20\u4e2d,\u8bf7\u7a0d\u5019...",UtilsScreenError:"\u622a\u5c4f\u529f\u80fd\u4ec5\u80fd\u5728IE\u6d4f\u89c8\u5668\u4e0b\u4f7f\u7528",UtilsDebugError:"\u8c03\u8bd5\u5668\u9519\u8bef",UtilsInvalidError:"Passing invalid object: ",UtilsTimeoutError:"\u64cd\u4f5c\u8d85\u65f6\u3002<br>\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u6ca1\u6709\u64cd\u4f5c\uff0c<a  style='text-decoration:underline' href=\"javascript:document.location.href='{0}'\">\u8bf7\u91cd\u65b0\u767b\u5f55</a>\u3002",UtilsRequestError:"\u8bf7\u6c42\u51fa\u9519:",UtilsNoloadError:"\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",UtilsUploadConfirm:"\u4e0a\u4f20\u6587\u4ef6\u5fc5\u987b\u5b89\u88c5139\u90ae\u7bb1\u63a7\u4ef6,\u662f\u5426\u5b89\u88c5?",UtilsUpdateConfirm:"\u60a8\u5b89\u88c5\u7684\u4e0a\u4f20\u63a7\u4ef6\u5df2\u7ecf\u4e0d\u80fd\u4f7f\u7528,\u662f\u5426\u66f4\u65b0?",UtilsScreenInstallConfirm:"\u4f7f\u7528\u622a\u5c4f\u529f\u80fd\u5fc5\u987b\u5b89\u88c5139\u90ae\u7bb1\u63a7\u4ef6,\u662f\u5426\u5b89\u88c5?",UtilsUpgradeConfirm:"\u5f53\u524d\u7684\u622a\u5c4f\u63a7\u4ef6\u9700\u8981\u5347\u7ea7\u624d\u53ef\u7ee7\u7eed\u4f7f\u7528"},UtilsMessage={ForwardEmptyError:"\u90ae\u7bb1\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a",ForwardOneError:"\u5f88\u62b1\u6b49\uff0c\u53ea\u80fd\u8f6c\u53d1\u5230\u4e00\u4e2a\u90ae\u7bb1\u5730\u5740\u3002",ForwardRightError:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740\uff08\u4f8b\uff1aexample@139.com\uff09",ForwardSelfError:"\u8f6c\u53d1\u7528\u6237\u4e0d\u80fd\u586b\u5199\u81ea\u5df1\u7684\u90ae\u7bb1\u5730\u5740",PopfolderFulledError:"\u90ae\u7bb1\u5bb9\u91cf\u5df2\u6ee1, \u8bf7\u6e05\u7406\u8fc7\u671f\u90ae\u4ef6",PopfolderFullError:"\u90ae\u7bb1\u5bb9\u91cf\u5c06\u6ee1,\u8bf7\u53ca\u65f6\u6e05\u7406",Folder_smsNoError:"\u60a8\u8fd8\u672a\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801\uff0c\u8bf7\u70b9\u51fb\u4e0a\u65b9\u7684\u6309\u94ae\u83b7\u53d6\u3002",Folder_smsError:"\u77ed\u4fe1\u9a8c\u8bc1\u7801\u8f93\u5165\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165!",Folder_smsNotice:"\u6b63\u5728\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801",FoldermanageError:"\u6392\u5e8f\u64cd\u4f5c\u5931\u8d25\uff01",ChecksecretfolderpwdError:"\u5bc6\u7801\u9519\u8bef",AddsendcontactsTeamError:"\u8bf7\u8f93\u5165\u7ec4\u540d",AddsendcontactsOneError:"\u8bf7\u81f3\u5c11\u9009\u4e2d\u4e00\u884c!",AddsendcontactsAddSuccess:"\u6dfb\u52a0\u6210\u529f!",AddsendcontactsAddError:"\u6dfb\u52a0\u5931\u8d25!",AddsendcontactsNotice:"\u6b63\u5728\u6dfb\u52a0\u8054\u7cfb\u4eba...",UtilsScreenError:"\u622a\u5c4f\u529f\u80fd\u4ec5\u80fd\u5728IE\u6d4f\u89c8\u5668\u4e0b\u4f7f\u7528",UtilsDebugError:"\u8c03\u8bd5\u5668\u9519\u8bef",UtilsInvalidError:"Passing invalid object: {0}",UtilsTimeoutError:" <b>\u767b\u5f55\u8d85\u65f6\uff0c\u53ef\u80fd\u7531\u4e8e\u4ee5\u4e0b\u539f\u56e0\uff1a</b><br/>1\u3001\u60a8\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u5e10\u53f7\u6216\u591a\u6b21\u767b\u5f55\u90ae\u7bb1<br/>2\u3001\u60a8\u7684\u7f51\u7edc\u94fe\u63a5\u957f\u65f6\u95f4\u65ad\u5f00<br/>3\u3001\u5f53\u524d\u9875\u9762\u95f2\u7f6e\u592a\u4e45",UtilsRequestError:"\u8bf7\u6c42\u51fa\u9519:",UtilsNoloadError:"\u6570\u636e\u672a\u52a0\u8f7d\u6210\u529f\uff0c\u53ef\u80fd\u7684\u539f\u56e0\u662f\u767b\u5f55\u8d85\u65f6\u4e86\u3002",UtilsUploadConfirm:"\u4e0a\u4f20\u6587\u4ef6\u5fc5\u987b\u5b89\u88c5139\u90ae\u7bb1\u63a7\u4ef6,\u662f\u5426\u5b89\u88c5?",UtilsUpdateConfirm:"\u60a8\u5b89\u88c5\u7684\u4e0a\u4f20\u63a7\u4ef6\u5df2\u7ecf\u4e0d\u80fd\u4f7f\u7528,\u662f\u5426\u66f4\u65b0?",UtilsScreenInstallConfirm:"\u4f7f\u7528\u622a\u5c4f\u529f\u80fd\u5fc5\u987b\u5b89\u88c5139\u90ae\u7bb1\u63a7\u4ef6,\u662f\u5426\u5b89\u88c5?",UtilsUpgradeConfirm:"\u5f53\u524d\u7684\u622a\u5c4f\u63a7\u4ef6\u9700\u8981\u5347\u7ea7\u624d\u53ef\u7ee7\u7eed\u4f7f\u7528",AddcontactSuccess:"\u6dfb\u52a0\u6210\u529f!",AddcontactEmptyError:"\u5206\u7ec4\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002",AddcontactSpecialError:"\u7ec4\u540d\u4e2d\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26\u3002",vipNoPermissionNotice:"VIP{0}{2}\u4e3a{0}\u5143\u7248{1}\u90ae\u7bb1\u4e13\u5c5e{2}\u3002<br/>\u7acb\u5373\u5347\u7ea7\uff0c\u91cd\u65b0\u767b\u5f55\u540e\u5373\u53ef\u4f7f\u7528\u3002"};
Utils={offsetHost:function(B,A,_){
    var F=$(B).offset(),E=F.left,G=F.top;
    switch(_){
    case "top":
      A.style.left=E+"px";
      A.style.top=G-A.offsetHeight+"px";
      break ;
    case "left":
      A.style.left=E-A.offsetWidth+"px";
      A.style.top=G+"px";
      break ;
    case "right":
      A.style.left=E+B.offsetWidth+"px";
      A.style.top=G+"px";
      break ;
    default:
      var D=E+A.offsetWidth,C=A.parentNode.offsetWidth;
      if(D>C){
        A.style.left=E-(D-C)+"px";
      }else {
        A.style.left=E+"px";
      }
      Utils.fixElementOutOfView(A);
      A.style.top=G+B.offsetHeight+"px";
      break ;
    }
  },fixElementOutOfView:function(A){
    var C=$(A),B=C.offset(),_=B.left+C.width()>$(document.body).width();
    if(_>0){
      C.css({left:B.left-_+"px"});
    }
  },htmlEncode:function($){
    if(typeof $=="undefined"){
      return "";
    }
    $=$.replace(/&/g,"&amp;");
    $=$.replace(/</g,"&lt;");
    $=$.replace(/>/g,"&gt;");
    $=$.replace(/\"/g,"&quot;");
    $=$.replace(/ /g,"&nbsp;");
    $=$.replace(/&amp;#([^\;]+);/ig,"&#$1;");
    return $;
  },htmlDecode:function($){
    if(typeof $=="undefined"){
      return "";
    }
    $=$.replace(/&lt;/g,"<");
    $=$.replace(/&gt;/g,">");
    $=$.replace(/&quot;/g,"\"");
    $=$.replace(/&apos;/g,"'");
    $=$.replace(/&nbsp;/g," ");
    $=$.replace(/&amp;/g,"&");
    return $;
  },xmlEncode:function($){
    if(typeof $=="undefined"){
      return "";
    }
    $=$.replace(/&/g,"&amp;");
    $=$.replace(/</g,"&lt;");
    $=$.replace(/>/g,"&gt;");
    $=$.replace(/\"/g,"&quot;");
    $=$.replace(/&amp;#([^\;]+);/ig,"&#$1;");
    return $;
  },getFileNameByPath:function(A){
    var _="",$=A.lastIndexOf("\\");
    if($!=-1){
      _=A.substr($+1);
    }
    return _;
  },requestByScript:function(I,C,H,E,K){
    var $=false;
    if(H){
      if(typeof (H)=="string"){
        E=H;
        H=null;
      }
    }
    var L=document.getElementsByTagName("head")[0],D=document.getElementById(I),_=!document.all&&true||false,B=["msie 9.0","chrome","firefox"],G=0,J=B.length-1;
    currVersion=window.navigator.userAgent.toLowerCase()||"";
    while(G<=J){
      _=currVersion.indexOf(B[G])>-1&&true||false;
      if(_){
        break ;
      }
      G++;
    }
    B=null;
    try{
      if(D&&_){
        D.src="";
        D.parentNode.removeChild(D);
        D=null;
      }
    }
    catch(A){
    }
    if(D!=null){
      if(C.indexOf("?")==-1){
        C+="?";
      }
      C+="&"+Math.random();
      D.src=C;
      var F=D;
    }else {
      F=document.createElement("script");
      F.id=I;
      if(E){
        F.charset=E;
      }else {
        F.charset="GB2312";
      }
      F.src=C;
      F.defer=true;
      F.type="text/javascript";
      L.appendChild(F);
    }
    if(document.all){
      F.onreadystatechange=function(){
        if(F.readyState=="loaded"||F.readyState=="complete"){
          $=true;
          if(H){
            H();
          }
        }
      };
    }else {
      F.onload=function(){
        $=true;
        if(H){
          H();
        }
      };
    }
    if(K){
      setTimeout(function(){
        if(K.times>0&&!$){
          K.times--;
          if(C.indexOf("?")==-1){
            C+="?";
          }
          C+="&"+Math.random();
          Utils.requestByScript(I,C,H,E,K);
        }
      },K.timeout);
    }
  },logReports:function(B){
    var C={serviceId:10||B.serviceId,mouduleId:B.mouduleId,action:B.action,pageId:B.pageId||12,channelId:B.channelId||12,thingId:B.thingId||0,thing:B.thing,ext1:B.ext1||0,ext2:B.ext2||0,comeFrom:B.comeFrom||1002,outUrl:location.href.replace(/\?(\S)*$/,""),userIp:top.UserData.lastLoginIp},_=top.namedVarToXML("",C,""),D=this.getAddedSiteUrl("logInterface");
    try{
      $.ajax({type:"POST",url:D,dataType:"json",cache:false,data:_,contentType:"application/xml;charset:utf-8"});
    }
    catch(A){
    }
  },getAddedSiteUrl:function(_){
    var B="func=mms:",$={"rm":top.SiteConfig.mmsMiddleware,"cm":top.ucDomain+"/mms/mmsservices.ashx"},A=function(D,B,C,_){
      var A="",$="&sid="+top.UserData.ssoSid+"&rnd="+Math.random();
      if("string"==typeof D){
        if(top.isRichmail){
          A=B["rm"]+"mms";
        }else {
          A=B["cm"];
        }
        A=A+"?"+C+_+$;
      }
      return A;
    };
    return (function($,B,C,_){
      return $&&B&&C&&_&&A($.match(/[^.]+\.[^.]+$/)[0],B,C,_)||"";
    })(window.location.host,$,B,_);
  }};
Utils.waitForReady=function(query,callback,win){
  var tryTimes=0,done=false;
  checkReady();
  if(!done){
    var intervalId=setInterval(checkReady,300);
  }
  function checkReady(){
    tryTimes++;
    try{
      var result;
      if(win!=undefined){
        result=win.document.getElementById(query);
      }else {
        result=eval(query);
      }
      if(result||tryTimes>200){
        done=true;
        if(intervalId){
          clearInterval(intervalId);
        }
        callback();
      }
    }
    catch(ex){
    }
  }
};
Utils.queryString=function(A,C){
  if(!C){
    C=location.search;
  }
  var B=new RegExp("[?#&]"+A+"=([^&]*)","i"),_=C.match(B),$=_?unescape(_[1]):null;
  if(!$&&location.hash){
    _=location.hash.match(B);
    $=_?unescape(_[1]):null;
  }
  return $;
};
Utils.getEvent=function(A){
  var D=A||window.event;
  if(!D){
    var _=[],C=this.getEvent.caller;
    while(C){
      D=C.arguments[0];
      if(D&&(D.constructor.target||D.srcElement)){
        break ;
      }
      var B=false;
      for(var $=0;$<_.length;$++){
        if(C==_[$]){
          B=true;
          break ;
        }
      }
      if(B){
        break ;
      }else {
        _.push(C);
      }
      C=C.caller;
    }
  }
  return D;
};
Utils.stopEvent=function($){
  if(!$){
    $=this.getEvent();
  }
  if($){
    if($.stopPropagation){
      $.stopPropagation();
      $.preventDefault();
    }else {
      $.cancelBubble=true;
      $.returnValue=false;
    }
  }
};
Utils.addEvent=function(A,_,$){
  if(A.attachEvent){
    A.attachEvent(_,$);
  }else {
    A.addEventListener(_.substring(2),$,false);
  }
};
Utils.removeEvent=function(A,_,$){
  if(A.detachEvent){
    A.detachEvent(_,$);
  }else {
    A.removeEventListener(_.substring(2),$,false);
  }
};
Utils.getLength=function($){
  var _=0;
  for(elem in $){
    _++;
  }
  return _;
};
Utils.toArray=function(A,_){
  var $=new Array();
  for(elem in A){
    if(_){
      $.push(elem);
    }else {
      $.push(A[elem]);
    }
  }
  return $;
};
Utils.findParent=function(_,$){
  while(_.parentNode){
    if(_.tagName.toLowerCase()==$.toLowerCase()){
      return _;
    }
    _=_.parentNode;
  }
};
Utils.findPosition=function(_){
  var $=0,A=0;
  if(_.offsetParent){
    do {
      $+=_.offsetLeft;
      A+=_.offsetTop;
    }while(_=_.offsetParent);
  }
  return [$,A];
};
Utils.findChild=function(_,A,C,D){
  var $=null;
  for(var E=0;E<_.childNodes.length;E++){
    var B=_.childNodes[E];
    if(B.nodeType==1){
      if(B.tagName.toLowerCase()==A.toLowerCase()){
        if(C){
          if(B.getAttribute(C)==D){
            return B;
          }
        }else {
          return B;
        }
      }
      $=this.findChild(B,A,C,D);
    }
  }
  return $;
};
Utils.preloadImages=function(){
  var $=[];
  for(var _=0;_<arguments.length;_++){
    $[_]=new Image();
    $[_].src=arguments[_];
  }
};
Date.prototype.format=function(B){
  var _={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds(),"w":"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(this.getDay())};
  B=B.replace(/y{4}/,this.getFullYear()).replace(/y{2}/,this.getFullYear().toString().substring(2));
  for(var C in _){
    var $=new RegExp(C);
    B=B.replace($,A);
  }
  function A($){
    return $.length==1?_[C]:("00"+_[C]).substr((""+_[C]).length);
  }
  return B;
};
Utils.dayDiff=function(B,_){
  var $=_.getTime()-B.getTime(),A=Math.round($/1000/60/60/24);
  if(A==0||A==1){
    A=B.getDate()==_.getDate()?0:1;
  }
  return A;
};
Utils.parseDate=function(A){
  var E=A.split(" "),I=E[0],$=I.split("."),H=$[0],F=$[1],G=$[2],D=E[1],C=D.split(":"),_=C[0],B=C[1];
  return new Date(H,F-1,G,_,B);
};
Utils.parseDateString=function(_){
  _=_.trim();
  var B=/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})$/,G=_.match(B);
  if(G){
    var D=G[1],C=G[2]-1,F=G[3],E=G[4],$=G[5],A=G[6];
    return new Date(D,C,F,E,$,A);
  }else {
    return null;
  }
};
Number.prototype.toDate=function(){
  return new Date(this*1000);
};
Utils.getCookie=function(_){
  var $=document.cookie.match(new RegExp("(^|\\W)"+_+"=([^;]*)(;|$)"));
  if($!=null){
    return unescape($[2]);
  }
  return "";
};
Utils.setCookie=function(_,B,$,A){
  if(!$){
    $=new Date();
    $.setYear($.getFullYear()+10);
  }
  document.cookie=_+" = "+escape(B)+"; path=/; "+(A&&"domain="+A+";"||"")+" expires="+$.toGMTString();
};
String.format=function(_,A){
  var B;
  if(A.constructor==Array){
    for(var D=0;D<A.length;D++){
      var C=new RegExp("\\{"+(D)+"\\}","gm");
      B=String(A[D]).replace(/\$/g,"$$$$");
      _=_.replace(C,B);
    }
  }else {
    for(var $ in A){
      C=new RegExp("\\{"+$+"\\}","gm");
      B=String(A[$]).replace(/\$/g,"$$$$");
      _=_.replace(C,B);
    }
  }
  return _;
};
String.prototype.getBytes=function(){
  var $=this.match(/[^\x00-\xff]/ig);
  return this.length+($==null?0:$.length);
};
String.prototype.getByteCount=function(){
  var A=this.length,_,$=0;
  while(A--){
    _=this.charCodeAt(A);
    switch(true){
    case _<=127:
      $+=1;
      break ;
    case _<=2047:
      $+=2;
      break ;
    case _<=65535:
      $+=3;
      break ;
    case _<=131071:
      $+=4;
      break ;
    case _<=34359738367:
      $+=5;
      break ;
    }
  }
  return $;
};
String.prototype.trim=function(){
  return this.replace(/^\s+|\s+$/g,"");
};
String.prototype.format=function(){
  var str=this,tmp;
  for(var i=0;i<arguments.length;i++){
    tmp=String(arguments[i]).replace(/\$/g,"$$$$");
    str=str.replace(eval("/\\{"+i+"\\}/g"),tmp);
  }
  return str;
};
String.prototype.getLeftStr=function(B,$){
  var A=this,_=0;
  for(var C=0;C<this.length;C++){
    _+=this.charCodeAt(C)>255?2:1;
    if(_>B){
      A=this.substring(0,C);
      break ;
    }else {
      if(_==B){
        A=this.substring(0,C+1);
        break ;
      }
    }
  }
  if($){
    if(A!=this){
      A+="...";
    }
  }
  return A;
};
String.prototype.$=function(A,$){
  if(!$){
    $=A;
    A=0;
  }
  var _=[];
  for(var B=A;B<=$;B++){
    _.push(this.replace(/\$i/g,B));
  }
  return _;
};
Utils.checkEmail=function($){
  var _=window.MailTool||top.MailTool;
  return _.checkEmail($);
};
Utils.getEmail=function($){
  var _=window.MailTool||top.MailTool;
  return [_.getName($),_.getAddr($)];
};
Utils.loadSkinCss=function(H,I,G,F){
  var J=false;
  if(!H){
    H=Utils.getCookie("SkinPath");
  }
  if(!H&&top.UserConfig){
    H=top.UserConfig["skinPath"];
  }
  if(!H){
    H="skin_snow";
  }
  if(H=="skin_red"){
    H="skin_xmas";
  }else {
    if(!!top.$App){
      H="skin_snow";
    }
  }
  if(G){
    H=H.replace("skin",G+"_skin");
  }
  if(!I){
    I=document;
  }
  var B="";
  if(top.SiteConfig&&top.SiteConfig.skinCSSCacheVersion){
    B="?v="+top.SiteConfig.skinCSSCacheVersion;
  }
  if(H.indexOf("new_")>-1){
    J=true;
    H=H.replace(/new_/gi,"");
    if(G=="player"){
      F="";
    }
  }
  var E=top.rmResourcePath+"/css/"+H+".css",D="";
  if(J){
    D=H.replace(/\S*skin_(\S+)/gi,"$1");
    E=E.replace(/css/,"theme/"+D);
  }
  if(I==top.document){
    if(!window.cssTag){
      document.write("<link id=\"skinLink\" rel=\"stylesheet\" type=\"text/css\" href=\"{0}\" />".format(E+B));
      window.cssTag=document.getElementById("skinLink");
    }else {
      window.cssTag.href=E+B;
    }
  }else {
    var _=I.getElementsByTagName("link");
    for(var C=0;C<_.length;C++){
      var A=_[C];
      if(A.getAttribute("skinnew")){
        A.href=top.rmResourcePath+"/theme/"+H.replace("skin_","")+"/skin.css"+B;
      }else {
        if(!A.href){
          if(F){
            A.href=F+H+".css";
          }else {
            A.href=E+B;
          }
        }else {
          if(A.href.match(/skin_\w+.css(?:\?v=\d+)?$/)){
            var $=A.href.replace(/skin_\w+/,H);
            if($.indexOf(".css")==-1){
              $=$+".css";
            }
            $=$.replace(/theme\/\S+\//gi,"theme/"+H.replace("skin_","")+"/");
            if(J){
              $=$.replace(/\/css\//,"/theme/"+D+"/");
              if(I.location.href.toLowerCase().indexOf("musicplayer")>-1){
                $=$.replace(/newnetdisk3/gi,"coremail");
              }
            }else {
              $=$.replace(/\/theme\/\S+\//gi,"/css/");
              if(I.location.href.toLowerCase().indexOf("musicplayer")>-1){
                $=$.replace(/\/coremail\/\S+\//gi,"/newnetdisk3/css/");
              }
            }
            A.href=$;
          }
        }
      }
    }
  }
};
Utils.setDomain=function(){
    document.domain = window.location.host.match(/([^.]+\.[^.:]+):?\d*$/)[1];
};
Utils.focusTextBox=function($){
  try{
    if(document.all){
      var A=$.createTextRange();
      A.moveStart("character",$.value.length);
      A.collapse(true);
      A.select();
    }else {
      $.setSelectionRange($.value.length,$.value.length);
      $.focus();
    }
  }
  catch(_){
  }
};
Utils.parseEmail=function(B){
  var C=/(?:[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}|(?:"[^"]*")?\s?<[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}>)\s*(?=;|,|，|；|$)/gi,$=/^"([^"]+)"|^([^<]+)</,E=/<?([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4})>?/i,A=B.match(C),_=[];
  if(A){
    for(var H=0,G=A.length;H<G;H++){
      var D={};
      D.all=A[H];
      var F=A[H].match($);
      if(F){
        D.name=F[1];
      }
      F=A[H].match(E);
      if(F){
        D.addr=F[1];
      }
      if(D.addr){
        D.account=D.addr.split("@")[0];
        D.domain=D.addr.split("@")[1];
        if(!D.name){
          D.name=D.account;
        }
        _.push(D);
      }
    }
  }
  return _;
};
Utils.testEmail=function(B){
  var $=/^[A-Z0-9._%+-]+@(?:[A-Z0-9-]+\.)+[A-Z]{2,4}$/i,A=/^<[A-Z0-9._%+-]+@(?:[A-Z0-9-]+\.)+[A-Z]{2,4}>$/i;
  B=B.replace(/"[^"]*"(?=\s*<)/g,"");
  var _=B.split(/[;,；，]/);
  for(var C=0;C<_.length;C++){
    _[C]=_[C].trim();
    if(_[C]==""){
      continue ;
    }
    if($.test(_[C])||A.test(_[C])){
      continue ;
    }else {
      Utils.testEmail.error=_[C];
      return false;
    }
  }
  return true;
};
Utils.toogle=function($,_,B,A){
  $.style.display=$.style.display=="none"?"":"none";
  _.className=_.className==B?A:B;
};
Utils.setBodyFixToFrame=function(){
  document.body.style.height=window.frameElement.offsetHeight+"px";
};
String.prototype.encode=function(){
  return Utils.htmlEncode(this);
};
String.prototype.encodeXML=function(){
  return Utils.xmlEncode(this);
};
String.prototype.decode=function(){
  return Utils.htmlDecode(this);
};
Utils.getGB2312=function(_,C){
  var E,A,$="",B="!\"#$%&'()*+,/:;<=>?@[]^`{|}~%",D=rmResourcePath+"/js/gb2312.js";
  this.requestByScript("script_gb2312data",D,function(){
    for(E=0;E<_.length;E++){
      if(_.charCodeAt(E)>=19968){
        A=Arr_GB2312[_.charCodeAt(E)-19968];
        $+="%"+A.slice(0,2)+"%"+A.slice(-2);
      }else {
        A=_.charAt(E);
        if(A==" "){
          $+="%20";
        }else {
          if(B.indexOf(A)!=-1){
            $+="%"+_.charCodeAt(E).toString(16);
          }else {
            $+=A;
          }
        }
      }
    }
    C($);
  });
};
Utils.getUserDataFromCookie=function(){
  var cookiesString=Utils.getCookie("UserData");
  if(cookiesString!=""){
    try{
      UserData=eval("("+cookiesString+")");
      UserData_bak=UserData;
      if(top.SiteConfig&&SiteConfig.MobileRegex){
        UserData.regex=SiteConfig.MobileRegex;
      }else {
        if(top.SiteConfig&&SiteConfig.SMSOpenRelease){
          UserData.regex="^86(134|135|136|137|138|139|147|150|151|152|157|158|159|182|183|187|188|130|131|132|155|156|185|186|145|133|153|180|189)\\d{8}$";
        }else {
          UserData.regex="^86(134|135|136|137|138|139|147|150|151|152|157|158|159|182|183|187|188)\\d{8}$";
        }
      }
    }
    catch(ex){
    }
  }
};
Utils.getXmlDoc=function($){
  if(document.all){
    var _=Utils.createIEXMLObject();
    _.loadXML($);
    return _;
  }
  var A=new DOMParser();
  return A.parseFromString($,"text/xml");
};
Utils.createIEXMLObject=function(){
  var A=["Microsoft.XMLDOM","MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.5.0","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"];
  if(window.enabledXMLObjectVersion){
    return new ActiveXObject(enabledXMLObjectVersion);
  }
  for(var C=0;C<A.length;C++){
    try{
      var B=A[C],_=new ActiveXObject(B);
      if(_){
        enabledXMLObjectVersion=B;
        return _;
      }
    }
    catch($){
    }
  }
  return null;
};
Utils.addEvent(document,"onclick",function($){
  $=$||event;
  var _=$.srcElement||$.target;
  try{
    behaviorClick(_);
  }
  catch($){
  }
});
function behaviorClick(E,G){
  if(window!=top){
    top.behaviorClick(E,window);
    return ;
  }
  var D,I,_=E,C="";
  if(typeof G!="undefined"){
    if(typeof G.behaviorPageId!="undefined"){
      C=G.behaviorPageId;
    }
  }else {
    if(typeof (window.behaviorPageId)!="undefined"){
      C=window.behaviorPageId;
    }
  }
  try{
    while(_){
      if(_.getAttribute("thingid")&&!_.getAttribute("behavior")){
        var $=_.getAttribute("thingid");
        if(/^\d+$/.test($)){
          addBehaviorExt({actionId:8000,thingId:$,moduleId:-1,pageId:C});
          return ;
        }
      }
      D=_.getAttribute("behavior");
      I=_.getAttribute("ext");
      if(D){
        break ;
      }else {
        var F=_.getAttribute("tj_actionid");
        if(F&&/^\d+$/.test(F)){
          var H=_.getAttribute("tj_thingid"),B=_.getAttribute("tj_moduleid");
          addBehaviorExt({actionId:tj_actionid,thingId:H,moduleId:B,pageId:C});
          return ;
        }
      }
      _=_.parentNode;
    }
  }
  catch(A){
  }
  if(D){
    top.addBehavior(D,I,C);
  }
}
function addBehavior(B,C){
  var _=arguments.length==3?_=arguments[2]:"",A=BehaviorConfigObj[B];
  if(!A){
    Debug.write("[\u884c\u4e3a\u7edf\u8ba1]\u6355\u83b7\u70b9\u51fb:\u3010{0}\u3011,\u627e\u4e0d\u5230\u8be5\u5143\u7d20\u7684\u914d\u7f6e\u7f16\u53f7,\u53ef\u80fd\u5df2\u79fb\u9664".format(B),"blue");
    return ;
  }else {
    Debug.write("[\u884c\u4e3a\u7edf\u8ba1]\u6355\u83b7\u70b9\u51fb:\u3010{0}\u3011".format(B));
  }
  if(C&&!/^\d+$/.test(C)){
    C=null;
  }
  var $={actionId:A.actionId,thingId:C||A.thingId,moduleId:A.moduleId,repeat:A.repeat,pageId:_,actionType:A.actionType,ext1:A.ext1||"",ext2:A.ext2||""};
  addBehaviorExt($);
}
var behaviorList=[],behaviorTimer,behaviorHadSendHuoyue=false;
function addBehaviorExt($){
  if($&&$.actionId){
    var _="";
    if(typeof $.pageId!="undefined"){
      _=$.pageId;
    }
    var A={id:$.actionId,extendID:$.thingId||0,moduleID:$.moduleId||14,pageId:_,actionType:$.actionType||20,ext1:$.ext1||"",ext2:$.ext2||""};
    behaviorList.push(A);
    top.Debug.write(String.format("\u8fdb\u5165\u961f\u5217\uff1aactionId:{id},thingId:{extendID},moduleId:{moduleID},pageId:{pageId},actionType:{actionType},ext1:{ext1},ext2:{ext2}",A));
    if($.actionId!=14&&!behaviorHadSendHuoyue){
      setTimeout(sendBehavior,1500);
      behaviorHadSendHuoyue=true;
    }
  }
  if(!behaviorTimer){
    behaviorTimer=setInterval(sendBehavior,8*1000);
  }
}
function sendBehavior(){
  if(!window.getProxyJQuery){
    return ;
  }
  if(getProxyJQuery()&&behaviorList.length>0){
    var C=[],A="<reports>";
    for(var D=0,B=behaviorList.length;D<B;D++){
      var _=behaviorList[D];
      if(!_.isSended){
        A+="<behavior id='{0}' extendID='{1}' mid='{2}' index='{3}' pageId='{4}' actionType='{5}' ext1='{6}' ext2='{7}'/>".format(_.id,_.extendID,_.moduleID,D+1,_.pageId,_.actionType,_.ext1,_.ext2);
        C.push(_);
        if(_.moduleID!="14"){
          businessBehaviorSended=true;
        }
      }
    }
    A+="</reports>";
    if(C.length==0){
      return ;
    }
    $();
  }
  function $(){
    Debug.write("[\u884c\u4e3a\u7edf\u8ba1]\u5373\u5c06\u53d1\u9001\u6570\u636e,\u8bf7\u67e5\u770b\u6293\u5305\u4fe1\u606f:"+A,"red");
    getProxyJQuery().ajax({type:"POST",url:top.ucDomain+"/Behavior/BehaviorGather.ashx?sid="+top.UserData.ssoSid+"&rnd="+Math.random(),data:{reports:A},success:function($){
        if($=="200"){
          for(var A=0,_=C.length;A<_;A++){
            C[A].isSended=true;
          }
          Debug.write("[\u884c\u4e3a\u7edf\u8ba1]\u4e0a\u62a5\u7ed3\u679c\uff1a\u8fd4\u56de\u6210\u529f","green");
        }else {
          Debug.write("[\u884c\u4e3a\u7edf\u8ba1]\u4e0a\u62a5\u7ed3\u679c\uff1a\u540e\u53f0\u7a0b\u5e8f\u63d0\u793a\u5199\u5165\u5931\u8d25","red");
        }
      },error:function(){
        Debug.write("[\u884c\u4e3a\u7edf\u8ba1]\u4e0a\u62a5\u7ed3\u679c\uff1a\u540e\u53f0\u7a0b\u5e8f\u51fa\u9519","red");
      }});
  }
}
Debug={write:function(A,C){
    if(!top.Debug.isDebugging){
      return ;
    }
    if(typeof A=="undefined"){
      A="undefined";
    }
    if(A==null){
      A="null";
    }
    if(window!=window.top){
      window.top.Debug.write(A,C);
      return ;
    }
    try{
      this.content.find("li").css("background-color","white");
      var _=$("<li></li>").text(A).css("background-color","silver").appendTo(this.content);
      if(C){
        _.css("color",C);
      }
      this.content.append("<hr />");
      this.content[0].scrollTop=1000000;
    }
    catch(B){
    }
  },init:function(){
    if(this.inited){
      return ;
    }
    this.inited=true;
    this.container=$("<div style='position:absolute;left:10px;top:10px;        width:300px;background:white;z-index:99999;        border:1px solid black;'><p style='margin:0;padding:3px;        width:100%;background:skyblue;color:white'>\u8c03\u8bd5\u7a97\u53e3</p><ul style='height:300px;overflow-x:hidden;overflow-y:auto;'></ul></div>").appendTo(document.body);
    this.content=this.container.find("ul").eq(0);
    new DragManager(this.container[0],this.container.find("p")[0]);
  },start:function(){
    this.init();
    this.isDebugging=true;
  }};
Utils.isUploadControlSetupExt=function(){
  if(/firefox/i.test(navigator.userAgent.toString())){
    var $=navigator.mimeTypes["application/x-shockwave-flash"];
    if($&&$.enabledPlugin){
      return true;
    }
    return false;
  }else {
    return false;
  }
};
Utils.isUploadControlSetup=function($){
  if(top.isUploadControlSetup){
    return true;
  }
  var A=false;
  Utils.checkUploadControlResult=0;
  try{
    var B=new ActiveXObject("Cxdndctrl.Upload");
    if(B){
      A=true;
    }
  }
  catch(_){
  }
  if(!A&&$){
    ___openWin("\u4e0a\u4f20\u6587\u4ef6\u5fc5\u987b\u5b89\u88c5139\u90ae\u7bb1\u63a7\u4ef6,\u662f\u5426\u5b89\u88c5?");
  }else {
    if(A&&B.getversion()<(top.SiteConfig.leastUploadControlVersion||0)){
      if($){
        ___openWin("\u60a8\u5b89\u88c5\u7684\u4e0a\u4f20\u63a7\u4ef6\u5df2\u7ecf\u4e0d\u80fd\u4f7f\u7528,\u662f\u5426\u66f4\u65b0?");
      }
      return false;
    }
  }
  top.isUploadControlSetup=A;
  return A;
};
function ___openWin($){
  top.FF.confirm($);
  top.FF.current.jContainer.find(".YesButton").unbind("click").attr("href",top.ucDomain+"/LargeAttachments/html/control139.htm").attr("target","_blank").click(function(){
    setTimeout(function(){
      try{
        FF.close(true);
        FF.close(true);
      }
      catch($){
      }
      removeUploadproxyWindow();
    },0);
  });
}
Utils.isScreenControlSetup=function($,B,C){
  if(C){
    return E();
  }
  if(top.isScreenControlSetup!=undefined&&B){
    return top.isScreenControlSetup;
  }
  if(!document.all){
    if($){
      alert("\u622a\u5c4f\u529f\u80fd\u4ec5\u80fd\u5728IE\u6d4f\u89c8\u5668\u4e0b\u4f7f\u7528");
    }
    return false;
  }
  var D=false;
  try{
    if(window.ActiveXObject){
      var F=new ActiveXObject("ScreenSnapshotCtrl.ScreenSnapshot.1");
      if(F){
        D=true;
      }
    }else {
      if(navigator.mimeTypes){
        var _=navigator.mimeTypes["application/x-richinfo-mailtoolautoupdate"];
        if(_&&_.enabledPlugin){
          D=true;
        }
      }
    }
  }
  catch(A){
  }
  if(!D&&$){
    E();
  }else {
    if(D&&$&&top.SiteConfig.screenControlVersion&&document.all){
      var G=F.GetVersion();
      if(G<top.SiteConfig.screenControlVersion||(location.host.indexOf("10086")>=0&&G==16777477)){
        D=false;
        E();
      }
    }
  }
  function E(){
    var _=top.ucDomain+"/ControlUpdate/mail139_tool_setup.exe",$="<p style='padding:10px 0 30px 10px;font-weight:bold;'>\u4f7f\u7528\u622a\u5c4f\u529f\u80fd\u5fc5\u987b\u5b89\u88c5139\u90ae\u7bb1\u63a7\u4ef6,\u662f\u5426\u5b89\u88c5?</p>        <p style='padding:0 20px 0 30px'><a id='aInstallOnline' class='but' href='javascript:;' onclick='setTimeout(function(){FF.close()},0);Utils.openControlDownload();return false;' target='_blank'>\u5728\u7ebf\u5b89\u88c5</a>        <a class='but' behavior='\u5b89\u88c5\u90ae\u7bb1\u5c0f\u5de5\u5177' ext='7' href='{0}' onclick='setTimeout(function(){FF.close()},0);' target='_blank'>\u624b\u52a8\u4e0b\u8f7d</a>        <a class='but' href='javascript:FF.close();'>\u53d6\u6d88</a></p>".format(_);
    FF.show($,"\u7cfb\u7edf\u63d0\u793a");
    top.$("#aInstallOnline").focus();
  }
  delete F;
  top.isScreenControlSetup=D;
  return D;
};
Utils.openControlDownload=function(_){
  var $=window.open(top.ucDomain+"/LargeAttachments/html/control139.htm");
  setTimeout(function(){
    $.focus();
  },0);
  top.addBehavior("\u6587\u4ef6\u5feb\u9012-\u5ba2\u6237\u7aef\u4e0b\u8f7d");
  if(_){
    removeUploadproxyWindow();
  }
};
function removeUploadproxyWindow(){
  try{
    top.addBehavior("\u6587\u4ef6\u5feb\u9012-\u5ba2\u6237\u7aef\u4e0b\u8f7d");
    top.$("#uploadproxy").attr("src","about:blank");
    top.$("#uploadproxy").remove();
  }
  catch($){
  }
}
Utils.addEvent(document,"onkeydown",function($){
  $=$||event;
  try{
    if(window.top.globalKeyDownEvent){
      return window.top.globalKeyDownEvent($,window);
    }
  }
  catch($){
  }
});
Utils.addEvent(document,"onclick",function($){
  $=$||event;
  try{
    if(window.top.globalClickEvent){
      window.top.globalClickEvent($,window);
    }
  }
  catch($){
  }
});
Utils.isChinaMobileNumber=function($){
  if(window.NumberTool){
    return NumberTool.isChinaMobileNumber($);
  }
  if($.length!=13&&$.length!=11){
    return false;
  }
  if($.length==11){
    $="86"+$;
  }
  var _=new RegExp(top.UserData.regex);
  return _.test($);
};
ScriptErrorLog={addLog:function($){
    this.sendLog($);
  },sendLog:function($){
    SendScriptLog($);
  }};
function window_onerror(F,B,C){
  if(typeof F!="string"){
    return ;
  }
  var E=[],$=arguments.callee.caller,_=/function (\w*\([^(]*\))/;
  while($){
    var A=$.toString(),D=A.match(_);
    E.push((D&&D[1])||A);
    $=$.caller;
  }
  Utils.Logger.sendClientLog({level:"ERROR",name:"SCRIPTERROR",file:B,errorMsg:F,lines:C,stack:E.join("").substring(0,200)});
}
function _logScriptError_(){
  if(location.host.indexOf("10086.cn")==-1){
    return ;
  }
  window.onerror=window_onerror;
}
_logScriptError_();
function randomSortArray(_){
  var A,B,D=[],C=0,$=[];
  for(i=0;i<_.length;i++){
    $[i]=_[i];
  }
  for(i=$.length;i>=1;i--){
    B=Math.floor(Math.random()*$.length);
    D[C]=$[B];
    $.splice(B,1);
    C++;
  }
  return D;
}
Utils.getDisplaySize=function($,_){
  if(!_){
    _="\u5b57\u8282";
  }
  if($<1024){
    $=Math.round($).toString()+_;
  }else {
    if($<1024*1024){
      $=(Math.round($*100/1024)/100).toString()+"K";
    }else {
      if($<1024*1024*1024){
        $=(Math.round($*100/1024/1024)/100).toString()+"M";
      }else {
        $=(Math.round($*100/1024/1024/1024)/100).toString()+"G";
      }
    }
  }
  return $;
};
function encodeXML2($){
  return $.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");
}
function varToXML($){
  return namedVarToXML(null,$,"\n").substr(1);
}
function namedVarToXML(A,C,_){
  if(C==null){
    return _+tagXML("null",A);
  }
  var D=Utils.getDataType(C);
  if(D=="String"){
    var B=textXML(C);
    if(RequestBuilder.needEncoding){
      B=encodeXML2(B);
    }
    return _+tagXML("string",A,B);
  }else {
    if(D=="Object"){
      if(C.nodeType){
        top.FloatingFrame.alert(UtilsMessage["UtilsInvalidError"].format(Object.inspect(C)));
        return "";
      }
      var $="";
      for(var E in C){
        $+=namedVarToXML(E,C[E],_+"  ");
      }
      return _+tagXML("object",A,$+_);
    }else {
      if(D=="Array"){
        $="";
        for(E=0;E<C.length;E++){
          $+=namedVarToXML(null,C[E],_+"  ");
        }
        return _+tagXML("array",A,$+_);
      }else {
        if(D=="Boolean"||D=="Number"){
          $=C.toString();
          return _+tagXML(getVarType(C,$),A,$);
        }else {
          if(D=="Date"){
            $=""+C.getFullYear()+"-"+(C.getMonth()+1)+"-"+C.getDate();
            if(C.getHours()>0||C.getMinutes()>0||C.getSeconds()>0){
              $+=" "+C.getHours()+":"+C.getMinutes()+":"+C.getSeconds();
            }
            return _+tagXML(getVarType(C,$),A,$);
          }else {
            top.FloatingFrame.alert(UtilsMessage["UtilsInvalidError"].format(Object.inspect(C)));
            return "";
          }
        }
      }
    }
  }
}
function getVarType(A,_){
  if(A==null){
    return "null";
  }
  var B=A.constructor;
  if(B==String){
    return "string";
  }else {
    if(B==Object){
      return "object";
    }else {
      if(B==Array){
        return "array";
      }else {
        if(B==Date){
          return "date";
        }else {
          if(B==Boolean){
            return "boolean";
          }else {
            if(B==Number){
              var $=_?_:A.toString();
              if($.indexOf(".")==-1){
                if(A>=-2*1024*1024*1024&A<2*1024*1024*1024){
                  return "int";
                }else {
                  if(!isNaN(A)){
                    return "long";
                  }
                }
              }
              return "number";
            }
          }
        }
      }
    }
  }
}
function tagXML(_,B,$){
  if(typeof (_)=="undefined"||_=="undefined"){
    return "";
  }
  var A="<"+_;
  if(B){
    A+=" name=\""+textXML(B)+"\"";
  }
  if($){
    A+=">"+$;
    if($.charAt($.length-1)==">"){
      A+="\n";
    }
    return A+"</"+_+">";
  }else {
    return A+"></"+_+">";
  }
}
function textXML($){
  $=$.replace(/[\x00-\x08\x0b\x0e-\x1f]/g,"");
  return $;
}
function replaceDataType(_,A){
  var $=_.length;
  for(var B=0;B<$;B++){
    A=A.replace(_[B].type,_[B].replaceTxt);
  }
  return A;
}
var RequestBuilder={needEncoding:true,call:function(E,D,C,A){
    if(typeof (top.SessionTimeOut)!="undefined"&&top.SessionTimeOut){
      return ;
    }
    if(!top.wmsvrPath||top.wmsvrPath=="path_wmsvr"){
      top.wmsvrPath="/coremail/s";
    }
    if(typeof (rmkey)=="undefined"){
      rmkey=Utils.getCookie("RMKEY");
    }
    var F=top.wmsvrPath+"?func="+E+"&sid="+top.sid+"&RMKEY="+rmkey,_=_ajax;
    if(D&&typeof (D.targetServer)!="undefined"&&D.targetServer==1){
      delete D.targetServer;
      F="mail?func="+E+"&sid="+top.sid;
    }else {
      if(D&&typeof (D.targetServer)!="undefined"&&D.targetServer==2){
        delete D.targetServer;
        if(top.wmsvrPath2.indexOf(location.host)==-1){
          _=top.window["frmProxy"]._ajax;
        }
        F=top.wmsvrPath2+"/mail?func="+E+"&sid="+top.sid;
      }else {
        if(D&&typeof (D.targetServer)=="string"){
          _=D.ajax;
          F=D.targetServer;
          delete D.targetServer;
          delete D.ajax;
        }
      }
    }
    if(D!=null&&typeof (D.targetServer)!="undefined"){
      delete D.targetServer;
    }
    if(E.indexOf(".jsp")>=0){
      var B=E.indexOf("?")>=0?"&":"?";
      F=E+B+"sid="+top.sid;
    }
    var $=namedVarToXML(null,D,"\r\n");
    if(typeof (A)!="undefined"){
      $=replaceDataType(A,$);
    }
    _.post(F,$,function(A){
      var $=Utils.tryEval(A);
      if($==null||$==undefined){
        Utils.Logger.jsonError({url:F,response:A});
      }
      top.SessionTimeOut=false;
      try{
        if($.code.toLowerCase()=="fa_invalid_session"){
          $.errorCode=2012;
        }
      }
      catch(_){
      }
      if($&&$.code!="S_OK"){
        Utils.Logger.unsuccess({url:F,response:A});
      }
      if($&&$.code!="S_OK"&&$.errorCode){
        var D="",B=false;
        switch($.errorCode.toString().toUpperCase()){
        case "2012":
          D="\u64cd\u4f5c\u8d85\u65f6\u3002<br>\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u6ca1\u6709\u64cd\u4f5c\uff0c<a  style='text-decoration:underline' href=\"javascript:document.location.href='"+F+"'\">\u8bf7\u91cd\u65b0\u767b\u5f55</a>\u3002";
          B=true;
          break ;
        case "2011":
          D="\u64cd\u4f5c\u8d85\u65f6\u3002<br>\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u6ca1\u6709\u64cd\u4f5c\uff0c<a  style='text-decoration:underline' href=\"javascript:document.location.href='"+F+"'\">\u8bf7\u91cd\u65b0\u767b\u5f55</a>\u3002";
          B=true;
          break ;
        default:
          D=UtilsMessage["UtilsRequestError"]+$.errorCode;
        }
        if(B){
          top.SessionTimeOut=true;
          Utils.showTimeoutDialog();
        }else {
          if(top.SiteConfig.isDev){
            top.FloatingFrame.alert(D);
          }
        }
      }
      try{
        if(E==MS.getMailFoldersParam.func){
          top.FM.sortfolderByKey($["var"],"location");
        }
      }
      catch(_){
      }
      if(C){
        C($);
      }
    });
  },sequential:function(_,C,F){
    var $="user:signatures,mbox:readMessage,mbox:readSessionMessage,user:setFilter,user:setWhiteBlackList,";
    if(typeof (F)=="undefined"){
      F=0;
    }
    var D={items:[]};
    D.targetServer=F;
    for(var E=0;E<_.length;E+=2){
      D.items[E/2]={func:_[E],"var":_[E+1]};
    }
    var A=false;
    if($.indexOf(D.items[0].func+",")>-1){
      A=true;
    }
    function B(G){
      var E=false,A=G["var"];
      if(typeof (G.result)=="undefined"){
        E=true;
      }
      if(!E){
        var $=Utils.isRequestOK(G,_.length/2),A={code:$.result,"var":[]},F=parseInt(_.length/2);
        switch($.result.toUpperCase()){
        case "S_OK":
          for(var H=0;H<F;H+=1){
            var D=new Object();
            D["code"]="S_OK";
            if(H==F-1){
              D["var"]=G["var"];
            }else {
              D["var"]={};
            }
            A["var"].push(D);
          }
          break ;
        case "S_PARTIAL_OK":
          for(H=0;H<F;H+=1){
            D=new Object();
            if(typeof ($[H])=="undefined"){
              D["var"]={};
              D.code="S_OK";
              try{
                if(H==F-1){
                  D["var"]=G["var"];
                }else {
                  D["var"]={};
                }
              }
              catch(B){
                D["var"]={};
              }
            }else {
              D["var"]={};
              D.code="S_FAIL";
              D["var"].errorCode=$[H];
              D["var"].summary="";
            }
            A["var"].push(D);
          }
          break ;
        case "S_FAIL":
          for(H=0;H<F;H+=1){
            D=new Object();
            D["code"]="S_FAIL";
            D["var"]={};
            D["var"].errorCode=$[H];
            D["var"].summary="";
            A["var"].push(D);
          }
          break ;
        default:
        }
        A=A["var"];
      }
      if(C){
        C(A,G.code);
      }
    }
    if(!A){
      this.call("global:sequential",D,B);
    }else {
      if(D.items[0]["var"]!=null){
        if(typeof (D.items[0]["var"]["targetServer"])=="undefined"){
          D.items[0]["var"]["targetServer"]=F;
        }
      }else {
        D.items[0]["var"]={};
        D.items[0]["var"]["targetServer"]=F;
      }
      if(D.items[1]["var"]!=null){
        if(typeof (D.items[0]["var"]["targetServer"])=="undefined"){
          D.items[1]["var"]["targetServer"]=F;
        }
      }else {
        D.items[1]["var"]={};
        D.items[1]["var"]["targetServer"]=F;
      }
      this.call(D.items[0].func,D.items[0]["var"],function(_){
        var A=B,$;
        if(_["code"].toUpperCase()!="S_OK"){
          $={"code":_["code"],"var":[{"code":_["code"],"var":_["var"]}]};
        }else {
          $={code:"S_OK","var":[{code:"S_OK","var":_["var"]}]};
          RequestBuilder.call(D.items[1].func,D.items[1]["var"],function(_){
            if(_.code.toUpperCase()!="S_OK"&&typeof (_["var"])=="undefined"){
              $["var"].push({"code":_.errorCode,"var":{"errorCode":_.errorCode}});
            }else {
              $["var"].push({"code":_.code,"var":_["var"]});
            }
            A($);
          });
        }
      });
    }
  }},_ajax={_objPool:[],_getInstance:function(){
    for(var $=0;$<this._objPool.length;$++){
      if(this._objPool[$].readyState==0||this._objPool[$].readyState==4){
        return this._objPool[$];
      }
    }
    this._objPool[this._objPool.length]=this._createObj();
    return this._objPool[this._objPool.length-1];
  },_createObj:function(){
    if(window.XMLHttpRequest){
      var A=new XMLHttpRequest();
    }else {
      var $=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","Microsoft.XMLHTTP"];
      for(var B=0;B<$.length;B++){
        try{
          A=new ActiveXObject($[B]);
          break ;
        }
        catch(_){
        }
      }
    }
    if(A.readyState==null){
      A.readyState=0;
      A.addEventListener("load",function(){
        A.readyState=4;
        if(typeof A.onreadystatechange=="function"){
          A.onreadystatechange();
        }
      },false);
    }
    return A;
  },post:function(A,_,$,B){
    if(typeof _=="string"){
      _=_.trim();
    }
    this.SendRequest("post",A,_,$,B);
  },get:function(A,_,$,B){
    this.SendRequest("get",A,_,$,B);
  },SendRequest:function(method,url,data,callback,options){
    options=options||{};
    var objXMLHttp=this._getInstance();
    with(objXMLHttp){
      try{
        if(url.indexOf("?")>0){
          url+="&randnum="+Math.random();
        }else {
          url+="?randnum="+Math.random();
        }
        open(method,url,true);
        setRequestHeader("Content-Type","application/xml");
        setRequestHeader("Accept","text/javascript");
        send(data);
        var watchId=Utils.createWatch({url:url,requestData:data});
        onreadystatechange=function(){
          if(objXMLHttp.readyState==4){
            Utils.stopWatch(watchId);
            if(objXMLHttp.status>199&&objXMLHttp.status<300){
              callback(responseText);
            }else {
              if(objXMLHttp.status==304){
                callback(responseText);
              }else {
                Utils.Logger.httpError({url:url,httpStatus:objXMLHttp.status});
                if(options.error){
                  options.error({method:method,requestData:data,url:url,xhr:objXMLHttp});
                }
              }
            }
          }
        };
      }
      catch(e){
        top.FloatingFrame.alert(UtilsMessage["UtilsNoloadError"]);
      }
    }
  }};
if(typeof caixun=="undefined"){
  caixun=cx={};
}
cx.addOption=function(A,C,B,$){
  var _=document.createElement("option");
  A.options.add(_);
  _.text=C;
  _.value=B;
  if(typeof ($)!="undefined"&&$){
    _.selected=$;
  }
};
cx.bindOptionData=function(F,G,$,_,E,B){
  var D=G.length,A=false,C=true;
  for(var H=0;H<D;H++){
    A=false,C=true;
    if(G[H][_]==E){
      A=true;
    }
    if(typeof (B)=="function"){
      if(!B(G[H])){
        C=false;
      }
    }
    if(C){
      cx.addOption(F,G[H][$],G[H][_],A);
    }
  }
};
cx.setSelectCtlSelected=function($,_){
  var A=document.getElementById($);
  for(var B=0;B<A.options.length;B++){
    if(A.options[B].value==_){
      A.selectedIndex=B;
      break ;
    }
  }
};
Utils.getFileSizeText=function(_){
  var $="B";
  if(_>1024){
    $="K";
    _=_/1024;
    if(_>1024){
      $="M";
      _=_/1024;
      if(_>1024){
        $="G";
        _=_/1024;
      }
    }
    _=Math.ceil(_*100)/100;
  }
  return _+$;
};
Utils.parseSingleEmail=function(_){
  _=_.trim();
  var $={},A=/^([\s\S]*?)<([^>]+)>$/;
  if(_.indexOf("<")==-1){
    $.addr=_;
    $.name=_.split("@")[0];
    $.all=_;
  }else {
    var B=_.match(A);
    if(B){
      $.name=B[1].trim().replace(/^"|"$/g,"");
      $.addr=B[2];
      $.name=$.name.replace(/\\["']/g,"").replace(/^["']+|["']+$/g,"");
      $.all="\""+$.name.replace(/"/g,"")+"\"<"+$.addr+">";
    }else {
      $.addr=_;
      $.name=_;
      $.all=_;
    }
  }
  if($.addr){
    $.addr=$.addr.encode();
  }
  return $;
};
var _BaseTypes=["Array","Boolean","Date","Number","Object","RegExp","String","Function"];
for(var i=0;i<_BaseTypes.length;i++){
  Utils["is"+_BaseTypes[i]]=(function($){
    return (function(_){
      return Object.prototype.toString.call(_)=="[object "+$+"]";
    });
  })(_BaseTypes[i]);
}
Utils.getDataType=function($){
  return Object.prototype.toString.call($).replace(/^\[object (\w+)\]$/,"$1");
};
Utils.requestCSS=function(_){
  var $=document.createElement("link");
  $.rel="stylesheet";
  $.href=_;
  document.getElementsByTagName("head")[0].appendChild($);
};
Utils.isDeliverStausQueryRelease=function(){
  if(typeof (SiteConfig.deliverStatusCostList)=="undefined"){
    return false;
  }
  var $=SiteConfig.deliverStatusCostList.split(",");
  for(var _=0;_<$.length;_++){
    if($[_]==userCosId){
      SiteConfig.isDeliverStatusQueryRelease=true;
      return true;
    }
  }
  return false;
};
Utils.isDRecallMailRelease=function(){
  if(typeof (SiteConfig.recallMailCostList)=="undefined"){
    return false;
  }
  var $=SiteConfig.recallMailCostList.split(",");
  for(var _=0;_<$.length;_++){
    if($[_]==userCosId){
      SiteConfig.isRecallMailRelease=true;
      return true;
    }
  }
  return false;
};
Utils.isSubjectColorRelease=function(){
  if(typeof (SiteConfig.isShowSubjectColor)!="undefined"&&SiteConfig.isShowSubjectColor){
    return SiteConfig.isShowSubjectColor;
  }
  if(typeof (SiteConfig.subjectColorCosList)=="undefined"){
    SiteConfig.isShowSubjectColor=false;
    return SiteConfig.isShowSubjectColor;
  }
  var $=SiteConfig.subjectColorCosList.split(","),_=$.length;
  if(_.length==0){
    SiteConfig.isShowSubjectColor=false;
    return SiteConfig.isShowSubjectColor;
  }else {
    if(_==1){
      if($[0].toLowerCase()=="all"){
        SiteConfig.isShowSubjectColor=true;
        return SiteConfig.isShowSubjectColor;
      }else {
        if($[0].toLowerCase()==""){
          SiteConfig.isShowSubjectColor=false;
          return SiteConfig.isShowSubjectColor;
        }
      }
    }
  }
  for(var A=0;A<$.length;A++){
    if($[A]==userCosId){
      SiteConfig.isShowSubjectColor=true;
      return SiteConfig.isShowSubjectColor;
    }
  }
  SiteConfig.isShowSubjectColor=false;
  return SiteConfig.isShowSubjectColor;
};
Utils.PageisTimeOut=function(D){
  var _=false,$="",A=false;
  if(typeof (D)!="undefined"){
    A=D;
  }
  if(typeof (top.SessionTimeOut)!="undefined"){
    _=top.SessionTimeOut;
    if(_){
      if(D){
        Utils.showTimeoutDialog();
      }
      return true;
    }
  }
  var B="",C=Utils.getCookie("UserData");
  if(C&&C.indexOf("ssoSid")>=0){
    B=Utils.getCookie("UserData").match(/ssoSid:['"](.+?)['"]/)[1];
  }
  return false;
};
Utils.isRequestOK=function(_,A){
  if(typeof (A)=="undefined"){
    A=2;
  }
  if(A>5){
    A=5;
  }
  var $={result:"S_OK"},C=0;
  if(_.code.toUpperCase()!="S_OK"){
    var B=_.result;
    for(var D=0;D<A;D++){
      if(B[D]!=0){
        $[D]=B[D];
        C++;
      }
    }
  }
  if(C==A){
    $.result="S_FAIL";
  }else {
    $.result="S_PARTIAL_OK";
  }
  return $;
};
Utils.showTimeoutDialog=function(){
  var url="http://mail.10086.cn";
  if(top.location.host.indexOf("10086rd.cn")>-1){
    url="http://mail.10086rd.cn";
  }
  if(top.location.host.indexOf("10086ts.cn")>-1){
    url="http://mail.10086ts.cn";
  }
  var redirect=function(){
    top.document.location.href=url;
  },errorMsg=UtilsMessage["UtilsTimeoutError"],userData=eval("("+Utils.getCookie("UserData")+")"),userNumber=userData.userNumber.replace(/^86/,""),html=["<form method=\"post\" action=\"https://mail.10086.cn/Login/Login.ashx\">","<dl class=\"loginTime\">","<dt>\u79bb\u5f00\u592a\u4e45\u5566\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01</dt>","<dd>\u5e10\u53f7\uff1a<b>"+top.uid+"@139.com</b><input value=\""+userNumber+"\" name=\"UserName\" style=\"display:none\"></dd>","<dd>\u5bc6\u7801\uff1a<input name=\"Password\" type=\"password\" class=\"ipt-text\"  /></dd>","<dd><input type=\"submit\" class=\"btnNormal but\" value=\"\u767b\u5f55\"/></dd>","</dl>","<form/>"];
  top.FF.show(html.join(""),"139\u90ae\u7bb1 \u7cfb\u7edf\u63d0\u793a",340,215);
  try{
    top.WaitPannel.hide();
    WaitPannel.hide();
  }
  catch(e){
  }
};
Utils.openAddressWindow=function(_){
  Utils.openAddressWindow.param=_;
  var $=(_&&_.title)||"\u4ece\u8054\u7cfb\u4eba\u4e2d\u6dfb\u52a0",A=top.wmsvrPath2+"/add-from-address.html?rnd="+Math.random();
  FF.open($,A,430,430,true);
};
Utils.flashPlayerVersion=function(D){
  var C=Boolean(window.ActiveXObject);
  if(D){
    if(C){
      return B();
    }else {
      return $();
    }
  }else {
    if(C){
      return _();
    }else {
      return A();
    }
  }
  function B(){
    try{
      var _=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+D);
      if(_){
        return true;
      }
    }
    catch($){
      return false;
    }
  }
  function $(){
    return A()>=D;
  }
  function _(){
    var $=0;
    for(var B=11;B>=6;B--){
      try{
        var A=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+B);
        if(A){
          $=B;
          break ;
        }
      }
      catch(_){
      }
    }
    return $;
  }
  function A(){
    var $=0;
    if(navigator.plugins&&navigator.plugins.length>0&&navigator.plugins["Shockwave Flash"]){
      var _=navigator.plugins["Shockwave Flash"];
      for(var C=0;C<_.length;C++){
        var B=_[C];
        if(B.enabledPlugin&&(B.suffixes.indexOf("swf")!=-1)&&navigator.mimeTypes["application/x-shockwave-flash"]){
          var A=_.description.match(/ (\d+(?:\.\d+)?)/);
          if(A){
            $=parseInt(A[1]);
            break ;
          }
        }
      }
    }
    return $;
  }
};
Utils.hover=function(F,G,B,E,D){
  var C;
  $("#"+F).hover(function(){
    H=true;
    if(G!=""){
      $("#"+G).show();
    }
    if(typeof (E)=="function"){
      E();
    }
    if(!A){
      $("#"+G).hover(function(){
        H=true;
      },function(){
        H=false;
        _();
      });
      A=true;
    }
  },function(){
    H=false;
    _();
  });
  var H=false,A=false;
  function _(){
    clearTimeout(C);
    C=setTimeout(function(){
      if(!H){
        if(G!=""){
          $("#"+G).hide();
        }
        if(typeof (D)=="function"){
          D();
        }
      }
    },B);
  }
};
if(window.attachEvent){
  window.attachEvent("onunload",function(){
    __flash__removeCallback=function(A,_){
      try{
        if(A){
          A[_]=null;
        }
      }
      catch($){
      }
    };
  });
}
Utils.UI={};
Utils.UI.selectSender=function(G,K,J){
  var D=Utils.queryString("from");
  if(typeof (J)=="undefined"){
    J=document;
  }
  if(typeof (K)=="undefined"){
    K=false;
  }
  var L=J.getElementById(G);
  UserData=window.top.UserData;
  var H=top.UserData.DefaultSender;
  if(H&&!MailTool.checkEmail(H)){
    H="";
    top.ScriptErrorLog.addLog("UserData.DefaultSender\u6570\u636e\u975e\u6cd5:"+top.UserData.DefaultSender);
  }
  var B=window.top.UserData.userName||top.trueName,I=[top.uid],C=I.concat(UserData.uidList);
  if(H){
    E(H);
  }
  for(var F=0;F<C.length;F++){
    var A=C[F]+"@"+top.mailDomain;
    if(H!=A){
      E(A);
    }
  }
  if(K){
    $(popList).each(function(){
      for(var $=0;$<L.options.length;$++){
        if(this==L[$].value){
          return ;
        }
      }
      E(this.email);
    });
  }
  L.options.add(new Option("\u522b\u540d\u8bbe\u7f6e","0"));
  L.options.add(new Option("\u53d1\u4ef6\u4eba\u59d3\u540d\u8bbe\u7f6e","1"));
  var _=function($){
    var _=J.getElementById($);
    if(_.value=="0"){
      _[0].selected=true;
      window.top.Links.show("accountManage");
      top.addBehavior("\u5199\u4fe1\u9875_\u522b\u540d\u8bbe\u7f6e");
    }else {
      if(_.value=="1"){
        _[0].selected=true;
        window.top.Links.show("accountManage");
        top.addBehavior("\u5199\u4fe1\u9875_\u53d1\u4ef6\u4eba\u59d3\u540d\u8bbe\u7f6e");
      }
    }
    _=null;
  };
  L.onchange=function(){
    _(G);
  };
  function E(A){
    A=A.trim();
    var $=B?"\"{0}\"<{1}>".format(B.replace(/"|\\/g,""),A):A,_=new Option($,A);
    L.options.add(_);
    _.innerHTML=_.innerHTML.replace(/\&amp\;#/ig,"&#");
    if(_.value==D){
      _.selected=true;
    }
  }
};
Utils.getColor=function(A){
  var _="#FF0000,#FF9900,#C19A00,#00A301,#009898,#CCCC99,#FF6633,#CC6666,#AD33AD,#9900FF,#99CC66,#66CCCC,#3399FF,#2B8787,#855C85,#6699FF,#3385D6,#335CAD,#5F27B3,#262ED7,#D5D2C0,#B5BFCA,#999999,#666666,#333333,#729C3B,#58A8B4,#5883BF,#6D72BA,#E3A325,#DA8A22,#B34731,#BB4C91,#995AAE,#CC0000,#FCD468,#FF9966,#CC99CC,#CC9999,#AD855C",$=_.split(",");
  if(typeof (A)!="undefined"){
    A=A%$.length;
    if(A<0){
      A=0;
    }else {
      if(A>=$.length){
        A=$.length-1;
      }
    }
    return $[A];
  }
  return $;
};
Utils.isRelease=function(E){
  if(!top.ReleaseConfig){
    return false;
  }
  var D=top.ReleaseConfig[E];
  if(typeof (D)=="undefined"){
    return false;
  }
  if(!D.enable){
    return false;
  }
  if(D.enableProv&&D.enableProv.splice){
    var $=Number(top.UserData.provCode),C=false;
    for(var G=D.enableProv.length;G--;){
      if(D.enableProv[G]==$){
        C=true;
      }
    }
    return C;
  }
  if(D.enableServiceItem&&D.enableServiceItem.splice){
    var A=Number(top.UserData.serviceItem),_=false;
    for(G=D.enableServiceItem.length;G--;){
      if(D.enableServiceItem[G]==A){
        _=true;
      }
    }
    return _;
  }
  if(D.enablePartition&&D.enablePartition.splice){
    var B=getCookie("cookiepartid"),F=false;
    for(G=D.enablePartition.length;G--;){
      if(D.enablePartition[G]===B){
        F=true;
      }
    }
    return F;
  }
  return !!D.enable;
};
Utils.unique=function(C,$){
  var B=[];
  try{
    for(var H=0,D=C.length;H<D;H++){
      var A=C[H],F=false;
      for(var G=0,E=B.length;G<E;G++){
        if($(B[G],A)){
          F=true;
          break ;
        }
      }
      if(!F){
        B.push(C[H]);
      }
    }
  }
  catch(_){
    B=C;
  }
  return B;
};
if(!document.all){
  document.write("<style>input,textarea{outline:none;}</style>");
}
var GlobalDomEvent={events:{"mousemove":[],"click":[],"keyup":[],"keydown":[],"mouseup":[]},on:function(A,_){
    var $=GlobalDomEvent.events[A];
    if($){
      $.push(_);
    }
  },un:function(A,_){
    var $=GlobalDomEvent.events[A];
    if($){
      for(var B=0;B<$.length;B++){
        if(_==$[B]){
          $.splice(B,1);
          B--;
        }
      }
    }
  },fire:function(D,B,A){
    var _=GlobalDomEvent.events[D];
    if(_){
      for(var E=0;E<_.length;E++){
        var C=_[E];
        try{
          C(B,A);
        }
        catch($){
        }
      }
    }
  },init:function(A){
    var $=(A||window).document;
    for(var _ in GlobalDomEvent.events){
      (function(_){
        Utils.addEvent($,"on"+_,function($){
          try{
            if(top.GlobalDomEvent){
              top.GlobalDomEvent.fire(_,window,$);
            }
          }
          catch($){
          }
        });
      })(_);
    }
  },initFrame:function($){
    GlobalDomEvent.init($);
  }};
GlobalDomEvent.init();
Utils.makeSureIframeReady=function(D){
  var $=D.iframe,E=D.retryTimes||3,A=D.interval||3000,C=D.query,_=function(){
    try{
      if(C){
        if($.contentWindow[C]){
          return true;
        }
      }else {
        if($.contentWindow.document.domain==document.domain){
          return true;
        }
      }
    }
    catch(_){
      return false;
    }
  },B=setInterval(function(){
    E--;
    if(!_()){
      var A=$.src;
      if(A.indexOf("?")==-1){
        A+="?";
      }
      A+="&"+Math.random();
      $.src=A;
    }else {
      clearInterval(B);
    }
    if(E<=0){
      clearInterval(B);
      if(!_()){
        ScriptErrorLog.sendLog("retry iframe but not sure ready:"+$.src);
      }
    }
  },A);
};
Utils.watchDomScroll=function(A){
  if($.browser.msie&&$.browser.version<8){
    return ;
  }
  A.lastScrollTop=A.scrollTop;
  var C=false,B=setInterval(function(){
    if(_(A)){
      clearInterval(B);
      return ;
    }
    if(D(A)){
      if(C){
        A.scrollTop=A.lastScrollTop;
        C=false;
      }else {
        A.lastScrollTop=A.scrollTop;
      }
    }else {
      C=true;
    }
  },500);
  function D($){
    while($){
      if($.style&&$.style.display=="none"){
        return false;
      }
      $=$.parentNode;
    }
    return true;
  }
  function _(_){
    try{
      while(_){
        if(_.tagName=="BODY"){
          return false;
        }
        _=_.parentNode;
      }
    }
    catch($){
      return true;
    }
    return true;
  }
};
Utils.apiProxyReady=function(_,A,$){
  var B=frames[$];
  if(B===undefined){
    B=document.createElement("IFRAME");
    B.id=$;
    B.name=$;
    if(/\/proxy.htm$/.test(_)){
      B.src=_;
    }else {
      B.src=_+"proxy.htm";
    }
    B.style.display="none";
    if(B.attachEvent){
      B.attachEvent("onload",function(){
        if(frames[$]._ajax){
          A(frames[$]._ajax);
        }
      });
    }else {
      B.onload=function(){
        if(frames[$]._ajax){
          A(frames[$]._ajax);
        }
      };
    }
    document.body.appendChild(B);
    Utils.makeSureIframeReady({iframe:B,query:"_ajax"});
  }else {
    Utils.waitForReady("frames['"+$+"']._ajax",function(){
      A(frames[$]._ajax);
    });
  }
};
Utils.getRequestUrl=function(A,$){
  var _=top.SiteConfig["billMiddleware"]+"/",C=_+$+"?func=user:"+A+"&sid="+top.UserData.ssoSid,B=Utils.getCookie("cookiepartid");
  if(B=="0"||B=="11"){
    C+=("&userNumber="+top.UserData.userNumber);
  }
  return {middleWare:C,proxyPage:_};
};
Utils.parseJson=function(A,B){
  var _={};
  try{
    if(window.JSON&&JSON.parse){
      _=JSON.parse(A);
    }else {
      _=window.eval("("+A+")");
    }
    return _;
  }
  catch($){
    top.ScriptErrorLog.sendLog(B||$.stack);
  }
};
Utils.getUserName=function(){
  var $=top.UserData.userName;
  if(!$){
    if(top.UserData.uidList.length>0){
      $=top.UserData.uidList[0];
    }else {
      $=top.UserData.userNumber.replace(/^86/,"");
    }
  }
  return $.replace(/</g,"&lt;");
};
Utils.loadJS=function(D,A,_,B,C,F){
  var E=Utils.getCookie("cookiepartid"),$=top.rmResourcePath;
  if(E=="0"||E=="11"){
    $=top.resourcePath;
  }
  $+="/js/"+A;
  if(_){
    $+="?sid="+top.sid;
  }
  Utils.requestByScript(D,$,B,C,F);
};
Utils.getImageSrc=function($){
  if($){
    return top.SiteConfig["net"]+"/addr/apiserver/httpimgload.ashx?sid="+top.sid+"&path="+encodeURIComponent($)+"&rnd="+Math.random();
  }else {
    return top.rmResourcePath+"/images/face.png";
  }
};
Utils.getFlashHtml=function(B,C,_,D){
  var A="";
  if($.browser.msie){
    A="<object id='"+B+"' name='"+B+"' wmode='transparent' "+" classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'"+"codebase='http://download.macrCUedia.cCU/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0'"+"width='"+C+"' height='"+_+"' >"+"<param name='movie' value='"+D+"'>"+"<param name='wmode' value='transparent'>"+"<param name='AllowScriptAccess' value='always'/>"+"<param name='quality' value='high'>"+"</object>";
  }else {
    A="<embed name='"+B+"' id='"+B+"' wmode='transparent' src='"+D+"' quality='high' pluginspage='http://www.macrCUedia.cCU/go/getflashplayer' type='application/x-shockwave-flash' width='"+C+"px' height='"+_+"px'  allowscriptaccess='always'></embed>";
  }
  return A;
};
Utils.ajaxForm=function(D){
  var C=document,$=C.body,A=C.createElement("form"),_=E(D.inputName,D.data);
  A.name=D.formName;
  A.method="post";
  A.action=D.url;
  if(A.encoding){
    A.setAttribute("encoding","multipart/form-data");
  }
  A.setAttribute("enctype","multipart/form-data");
  if(!document.getElementById(D.iframeName)){
    $.appendChild(B(D.iframeName));
  }
  A.target=D.iframeName;
  A.appendChild(_);
  $.appendChild(A);
  A.submit();
  $.removeChild(A);
  function E(_,A){
    var $=document.createElement("input");
    $.value=A;
    $.name=_;
    $.type="hidden";
    return $;
  }
  function B(A){
    var _;
    try{
      _=document.createElement("<iframe name=\""+A+"\"></iframe>");
    }
    catch($){
      _=document.createElement("iframe");
      _.name=A;
    }
    _.id=A;
    _.style.display="none";
    return _;
  }
};
(function(Utils){
  Utils.strToJson=function(res,url){
    var obj=false;
    if(!res){
      Utils.Logger.jsonError({url:url,response:"\u670d\u52a1\u5668\u8fd4\u56de\u7a7a\u62a5\u6587"});
      return {"code":"evalJsonFail","summary":"\u670d\u52a1\u5668\u8fd4\u56de\u7a7a\u62a5\u6587"};
    }
    if(window.JSON&&JSON.parse){
      try{
        obj=JSON.parse(res);
      }
      catch(ex){
      }
    }
    if(!obj){
      try{
        obj=eval("("+res+")");
      }
      catch(ex){
        Utils.Logger.jsonError({url:url,response:res});
        obj={"code":"evalJsonFail","summary":"\u670d\u52a1\u5668\u8fd4\u56de\u62a5\u6587\u4e0d\u5408\u6cd5"};
      }
    }
    return obj;
  };
})(Utils);
(function($){
  $.middlewareHttpClient={request:function(D){
      var F="",A=D.params,_=function(_){
        var A=$.strToJson(_,F);
        D.callback(A,_);
      },C="",B="rebuildMiddlewareIframe",E=top.SiteConfig.rebuildMiddleware;
      if(D.isFullUrl){
        F=D.url;
        C=top.SiteConfig.middleware;
        B="middlewareIframe";
      }else {
        F=E+D.url;
        C=E;
      }
      $.apiProxyReady(C,function($){
        if(A){
          $.post(F,A,_);
        }else {
          $.get(F,"",_);
        }
      },B);
    }};
})(Utils);
(function(Utils){
  var LogLevel={Error:"ERROR",Info:"INFO"},LogType={Http:"HTTPClient",Script:"SCRIPTERROR"},sendLog=function($){
    Utils.Logger.sendClientLog($);
  },getDefaultOptions=function(){
    return {level:LogLevel.Error,name:LogType.Http};
  };
  Utils.Logger={timeout:function(_){
      var $=getDefaultOptions();
      $.errorMsg="TIMEOUT";
      $.url=_.url;
      $.times=_.time;
      sendLog($);
    },delay:function(_){
      var $=getDefaultOptions();
      $.errorMsg="DELAY";
      $.url=_.url;
      $.time=_.time;
      sendLog($);
    },httpError:function(_){
      var $=getDefaultOptions();
      $.errorMsg="HTTPERROR";
      $.url=_.url;
      $.status=_.httpStatus;
      sendLog($);
    },jsonError:function(_){
      var $=getDefaultOptions();
      $.errorMsg="JSONERROR";
      $.url=_.url;
      $.responseText=_.response;
      sendLog($);
    },unsuccess:function(_){
      var $=getDefaultOptions();
      $.subType="UNSUCCESS";
      $.url=_.url;
      $.responseText=_.response;
      sendLog($);
    },clientLogSendCount:0,clientLogSendMax:50,sendClientLog:function(F){
      if(!F){
        return ;
      }
      if(window!=window.top){
        return top.Utils.Logger.sendClientLog(F);
      }
      if(this.clientLogSendCount>this.clientLogSendMax){
        return ;
      }
      if(!F.name){
        F.name="NONE";
      }
      if(!F.level){
        F.level="ERROR";
      }
      F.clientTime=new Date().format("yy-MM-dd hh:mm:ss");
      var $={};
      for(var B in F){
        var C=String(F[B]);
        if(C.indexOf("\n")>-1){
          C=encodeURIComponent(C);
        }
        $[B.toUpperCase()]=C;
      }
      var D=top.SiteConfig.newScriptLog||"/weather/monitorLog";
      if(D.indexOf("?")==-1){
        D+="?";
      }
      var E=D+"&sid="+top.sid;
      this.clientLogSendCount++;
      var A={version:"m2012",messages:[$]};
      try{
        Utils.middlewareHttpClient.request({url:E,params:varToXML(A),callback:function(){
          }});
      }
      catch(_){
      }
    }};
  window.SendScriptLog=function(B){
    var $=/\[(\d+)\]LOGINSUCCESS/,A=B.match($),_={level:"INFO",name:"COMMONLOG"};
    if(A){
      _.time=A[1];
      _.name="LOGINSUCCESS";
    }else {
      _.commonlog=B;
    }
    Utils.Logger.sendClientLog(_);
  };
  Utils.tryEval=function(str){
    var result=null;
    if(typeof str=="string"&&/^\s*\{/.test(str)){
      str="("+str+")";
    }
    try{
      result=eval(str);
    }
    catch(e){
    }
    return result;
  };
})(Utils);
(function(){
  var _={};
  Utils.createWatch=function(A){
    var $="Watch_"+Math.random();
    _[$]={startTime:new Date,times:A.times||[10000,20000],url:A.url,requestData:A.requestData};
    return $;
  };
  Utils.stopWatch=function($){
    delete _[$];
  };
  setInterval(function(){
    var B=new Date();
    for(var C in _){
      var A=_[C];
      for(var D=0;D<A.times.length;D++){
        if(B-A.startTime>A.times[D]){
          $(A,A.times.shift());
          D--;
        }
      }
      if(A.times.length==0){
        Utils.stopWatch(C);
      }
    }
  },1000);
  function $(_,$){
    Utils.Logger.delay({url:_.url,requestData:_.requestData,time:$});
  }
})();
var Balloon={show:function(A,C,_,D,F){
    var E=document.createElement("div");
    E.className="FTUTip";
    var $="<BLOCKQUOTE style='WIDTH: {width}px'>{text}</BLOCKQUOTE><BUTTON class='wsSmallCoolCloseButton' onclick='Balloon.close(this)'></BUTTON><DIV class='balloonArrow {direction}'></DIV></DIV>",B=String.format($,{text:A,direction:C,width:D});
    E.innerHTML=B;
    var G=Utils.findPosition(_);
    document.body.appendChild(E);
    if(!F){
      F={x:0,y:0};
    }
    switch(C){
    case "left":
      E.style.left=(G[0]+Number(_.offsetWidth)+F["x"])+"px";
      E.style.top=(G[1]+F["y"]-15)+"px";
      break ;
    case "right":
      E.style.left=(G[0]-E.offsetWidth+F["x"])+"px";
      E.style.top=(G[1]+F["y"]-15)+"px";
      break ;
    case "top":
      E.style.left=G[0]+"px";
      E.style.top=(G[1]+_.offsetHeight+10+F["y"])+"px";
      break ;
    case "bottom":
      E.style.left=G[0]+"px";
      E.style.top=(G[1]-E.offsetHeight-10+F["y"])+"px";
      break ;
    }
  },close:function($){
    document.body.removeChild($.parentNode);
  }},Tooltip={tip:null,register:function(C,E){
    if(!E){
      E=window;
    }
    var A=C.title;
    C.title="";
    var B=E.$("<div style='display:none' class='tooltip'></div>");
    B.html(A);
    $(C).hover(_,D);
    $(C).click(D);
    function _(){
      Tooltip.show(B,C,E);
    }
    function D(){
      Tooltip.hide(B);
    }
  },show:function(_,$,B){
    if(!B){
      B=window;
    }
    _.appendTo(B.document.body);
    var C=B.$($).offset();
    _.show();
    var A=C.left,D=C.top-_.height()-B.$($).height();
    if(C.top<300){
      D=C.top+B.$($).height();
    }
    if(C.left>400){
      A=C.left-_.width();
    }
    _.css({left:A,top:D});
  },hide:function($){
    $.hide();
  },guide:function(A,$,B){
    if(!B){
      B=window;
    }
    var _=B.$("<div style='display:none' class='tooltip'></div>");
    _.html($);
    Tooltip.show(_,A,B);
  }};
function DragManager(D,G){
  this.onDragStart=null;
  this.onDragMove=null;
  this.onDragEnd=null;
  this.orignX=0;
  this.orignY=0;
  var B=0,J=0,E=$(document.body).width()-$(D).width(),C=$(document.body).height()-$(D).height(),_=this,H=[];
  if(G){
    G.onmousedown=I;
  }else {
    D.onmousedown=I;
  }
  this.startDrag=function($){
    var E,C;
    $=Utils.getEvent();
    if(window.event){
      E=event.clientX+document.body.scrollLeft;
      C=event.clientY+document.body.scrollTop;
    }else {
      E=$.pageX;
      C=$.pageY;
    }
    if(D.setCapture){
      D.setCapture();
    }else {
      if(window.captureEvents){
        window.captureEvents(Event.MOUSEDOWN|Event.MOUSEMOVE|Event.MOUSEUP);
      }
    }
    var B=Utils.findPosition(D);
    if(B[0]==0){
      H=[0,0];
    }else {
      H=[E-B[0],C-B[1]];
    }
    if(_.onDragStart){
      _.onDragStart({x:E,y:C});
    }
    Utils.addEvent(document,"onmousemove",A);
    Utils.addEvent(document,"onmouseup",F);
    Utils.stopEvent($);
  };
  this.stopDrag=function(){
    if(D.releaseCapture){
      D.releaseCapture();
    }else {
      if(window.captureEvents){
        window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);
      }
    }
    if(_.onDragEnd){
      _.onDragEnd();
    }
    Utils.removeEvent(document,"onmousemove",A);
    Utils.removeEvent(document,"onmouseup",F);
  };
  function A(B){
    var F,G;
    if(window.event){
      F=event.clientX+document.body.scrollLeft;
      G=event.clientY+document.body.scrollTop;
    }else {
      F=B.pageX;
      G=B.pageY;
    }
    var $=F-H[0],A=G-H[1];
    if($<0){
      $=0;
    }else {
      if($>E){
        $=E;
      }
    }
    if(A<0){
      A=0;
    }else {
      if(A>C){
        A=C;
      }
    }
    D.style.left=$+"px";
    D.style.top=A+"px";
    if(_.onDragMove){
      _.onDragMove({x:F,y:G});
    }
  }
  function I($){
    _.startDrag($);
  }
  function F($){
    _.stopDrag($);
  }
  this.getOffset=function(B,_){
    var $=_?1:B.offsetWidth,C=_?1:B.offsetHeight;
    for(var A={l:B.offsetLeft,t:B.offsetTop,r:$,b:C};B=B.offsetParent;A.l+=B.offsetLeft,A.t+=B.offsetTop){
    }
    return A.r+=A.l,A.b+=A.t,A;
  };
  this.hitTest=function(C,D){
    for(var _,$,A=[],B=this.getOffset(C),E=isNaN(D.length),F=(E?D=[D]:D).length;F;_=this.getOffset(D[--F],true),(B.l==_.l||(B.l>_.l?B.l<=_.r:_.l<=B.r))&&(B.t==_.t||(B.t>_.t?B.t<=_.b:_.t<=B.b))&&(A[A.length]=D[F])){
    }
    return E?!!A.length:A;
  };
}
function FloatingFrame(){
  var H=this,F="";
  F+="<div class=\"winTip\" style=\"z-index:1024;position:absolute;left:0px;top:0px;display:none;\">";
  F+="<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">";
  F+="<tr style=\"cursor:move\">";
  F+="<td class=\"wtTL\">&nbsp;&nbsp;<span class=\"do\" style=\"display:none;\"></span><b style=\"left:12px;\" class=\"doN\">#title#</b> <a hideFocus=\"1\" href=\"javascript:;\" class=\"clR CloseButton\"></a></td>";
  F+="<td class=\"wtTC\">&nbsp;</td>";
  F+="<td class=\"wtTR\">&nbsp;</td>";
  F+="</tr>";
  F+="<tr>";
  F+="<td colspan=\"3\" style=\"padding-right:2px;\">";
  F+="<div class=\"winTipC\">";
  F+="<div class=\"wTipCont\">";
  F+="</div>";
  F+="</div>";
  F+="</td>";
  F+="</tr>";
  F+="</table>";
  F+="</div>";
  if(window.navigator.userAgent.indexOf("WebKit")>-1){
    F=F.replace("<span class=\"do\">","<span style=\"left:5px;\" class=\"do\">");
  }
  var A=$(F).appendTo(document.body),E=A.find("tr:eq(0)"),C=A.find(".wTipCont"),_;
  this.jContainer=A;
  this.jTitle=E;
  this.jContent=C;
  this.closeButton=A.find(".CloseButton");
  this.setTitle=function($){
    A.find(".doN").text($);
  };
  this.setContent=function($){
    this.jContent.html("");
    if(typeof ($)=="string"){
      this.jContent.html($);
    }else {
      if(typeof ($)=="object"){
        this.jContent.append($);
      }
    }
  };
  this.show=function(B){
    if(!document.all){
      A.css("visibility","hidden");
    }
    A.show();
    var E=(parseInt($(document.body).height())-parseInt(A.height()))/2,C=(parseInt($(document.body).width())-parseInt(A.width()))/2;
    if(window!=window.top){
      try{
        var D=$(frameElement).offset();
        E-=D.top/2;
        E-=D.left/2;
      }
      catch(_){
      }
    }
    if(E<0){
      E=0;
    }
    if(C<0){
      C=0;
    }
    if($(document.body).css("overflow")!="hidden"&&(document.body.scrollTop||document.documentElement.scrollTop)){
      E=(document.body.scrollTop||document.documentElement.scrollTop)+180;
    }
    A.css({top:E,left:C});
    if(!document.all){
      A.css("visibility","visible");
    }
    Glass.show();
    FloatingFrame.lastCurrent=FloatingFrame.current;
    FloatingFrame.current=this;
    if(this.onshow&&!B){
      this.onshow();
    }
  };
  this.hide=function(){
    Glass.hide();
    A.hide();
  };
  this.close=function(A){
    this.hide();
    B();
    this.isDisposed=true;
    if(FloatingFrame.lastCurrent&&FloatingFrame.current!=FloatingFrame.lastCurrent&&!FloatingFrame.lastCurrent.isDisposed){
      FloatingFrame.current=FloatingFrame.lastCurrent;
      FloatingFrame.lastCurrent=null;
    }
    try{
      if(!A){
        $("#keyword").focus().blur();
      }
    }
    catch(_){
    }
  };
  D();
  var G=false;
  function D(){
    DM=new DragManager(A[0],E[0]);
  }
  function B(){
    if($.browser.msie){
      var B=A.find("iframe")[0];
      try{
        if(B){
          B.contentWindow.document.body.innerHTML="";
        }
      }
      catch(_){
      }
    }
    A.remove();
  }
}
FloatingFrame.alert=function(_,C){
  if(window!=window.top){
    return window.top.FloatingFrame.alert(_,C);
  }
  if(FloatingFrame.current&&FloatingFrame.current.isAlert&&!FloatingFrame.current.isDisposed){
    try{
      FloatingFrame.current.close();
    }
    catch(A){
    }
  }
  var B=new FloatingFrame();
  B.isAlert=true;
  _=_.toString().replace(/(?:\\r)?\\n/g,"<br>");
  var D="";
  D+="<ul>";
  D+="<li class=\"wTc\"><b class=\"wcDot\"></b><span class=\"wcDot1\">"+_+"</span></li>";
  D+="<li class=\"wTcBut\"><a href=\"javascript:;\" class=\"but YesButton\">\u786e&nbsp;\u5b9a</a></li>";
  D+="</ul>";
  B.setTitle("\u7cfb\u7edf\u63d0\u793a");
  B.setContent(D);
  $(".CloseButton,.YesButton",B.jContainer).click(function(){
    B.close();
    try{
      if(C){
        C();
      }
    }
    catch($){
    }
    return false;
  });
  B.show();
  $(".YesButton",B.jContainer).focus();
};
FloatingFrame.confirm=function(A,C,F,E){
  if(window!=window.top){
    return window.top.FloatingFrame.confirm(A,C,F,E);
  }
  var B=new FloatingFrame(),D="";
  D+="<ul>";
  D+="<li class=\"wTc\"><b class=\"wcDot\"></b><span class=\"wcDot1\">"+A+"</span></li>";
  var _={yesText:"\u786e&nbsp;\u5b9a",noText:"\u53d6&nbsp;\u6d88"};
  if(typeof E=="object"){
    _={yesText:E.yesText,noText:E.noText};
  }else {
    if(E){
      _={yesText:"\u662f",noText:"\u5426"};
    }
  }
  D+="<li class=\"wTcBut\"><a href=\"javascript:;\" class=\"but YesButton\">"+_.yesText+"</a> <a href=\"javascript:;\" class=\"but CancelButton\">"+_.noText+"</a></li>";
  D+="</ul>";
  B.setTitle("\u7cfb\u7edf\u63d0\u793a");
  B.setContent(D);
  setTimeout(function(){
    $(".YesButton",B.jContainer).focus();
  },0);
  $(".CloseButton,.YesButton,.CancelButton",B.jContainer).click(function(){
    B.close();
    try{
      if($(this).hasClass("YesButton")){
        if(C){
          C();
        }
      }else {
        if($(this).hasClass("CancelButton")){
          if(F){
            F(!$(this).hasClass("CancelButton"));
          }
        }
      }
    }
    catch(_){
    }
    return false;
  });
  B.show();
};
FloatingFrame.confirmCloseNoCallBack=function(A,C,F,E){
  if(window!=window.top){
    return window.top.FloatingFrame.confirm(A,C,F,E);
  }
  var B=new FloatingFrame(),D="";
  D+="<ul>";
  D+="<li class=\"wTc\"><b class=\"wcDot\"></b><span class=\"wcDot1\">"+A+"</span></li>";
  var _={yesText:"\u786e&nbsp;\u5b9a",noText:"\u53d6&nbsp;\u6d88"};
  if(typeof E=="object"){
    _={yesText:E.yesText,noText:E.noText};
  }else {
    if(E){
      _={yesText:"\u662f",noText:"\u5426"};
    }
  }
  D+="<li class=\"wTcBut\"><a href=\"javascript:;\" class=\"but YesButton\">"+_.yesText+"</a> <a href=\"javascript:;\" class=\"but CancelButton\">"+_.noText+"</a></li>";
  D+="</ul>";
  B.setTitle("\u7cfb\u7edf\u63d0\u793a");
  B.setContent(D);
  setTimeout(function(){
    $(".YesButton",B.jContainer).focus();
  },0);
  $(".CloseButton,.YesButton,.CancelButton",B.jContainer).click(function(){
    B.close();
    try{
      if($(this).hasClass("YesButton")){
        if(C){
          C();
        }
      }else {
        if($(this).hasClass("CancelButton")){
          if(F){
            F(!$(this).hasClass("CancelButton"));
          }
        }
      }
    }
    catch(_){
    }
    return false;
  });
  B.show();
};
FloatingFrame.prompt=function(A,_,G,E,C){
  if(window!=window.top){
    return window.top.FloatingFrame.prompt(A,_,G,E,C);
  }
  try{
    if(E&&E.constructor==Number){
      C=E;
    }
    if(G.constructor==Function){
      E=G;
      G="";
    }
  }
  catch(B){
  }
  var D=new FloatingFrame(),F="";
  F+="<ul>";
  F+="<li class=\"wTc\">"+_+"</li>";
  F+="<li class=\"wTcN\"><input type=\"text\" style=\"width:220px\" class=\"inp\" maxLength=\"{0}\" /></li>";
  F+="<li class=\"wTcBut\"><a href=\"javascript:;\" class=\"but YesButton\">\u786e&nbsp;\u5b9a</a> <a href=\"javascript:;\" class=\"but CancelButton\">\u53d6&nbsp;\u6d88</a></li>";
  F+="</ul>";
  F=F.format(C?C:"");
  D.setTitle(A);
  D.setContent(F);
  setTimeout(function(){
    try{
      $(".inp",D.jContainer).focus();
    }
    catch(_){
    }
  },0);
  var H=$("input",D.jContainer);
  H.val(G);
  H.keypress(function($){
    $=$||event;
    if($.keyCode==13){
      D.jContainer.find(".YesButton").click();
    }
  });
  $(".CloseButton,.YesButton,.CancelButton",D.jContainer).click(function(){
    try{
      var _=D.jContainer.find("input").val();
      D.close();
      if($(this).hasClass("YesButton")&&E){
        E(_);
      }
    }
    catch(A){
    }
    return false;
  });
  D.show();
  H[0].select();
};
var Glass={_glass:null,isShow:false,show:function(){
    if(!this._glass){
      this._glass=$("<div style='background:#ffffff;opacity:0.5;filter:alpha(opacity=50);' class='glass'><iframe></iframe><div class='glass' style='z-index:1000;opacity:0'></div></div>").appendTo(document.body);
    }
    this._glass.show();
    if($(document.body).css("overflow")!="hidden"){
      this._glass.height(Math.max(document.body.scrollHeight,document.body.offsetHeight));
    }
    this.isShow=true;
  },hide:function(){
    if(this._glass){
      this._glass.hide();
    }
    this.isShow=false;
  }};
FloatingFrame.current=null;
FloatingFrame.show=function(E,_,D,A,F,G,C){
  if(window!=window.top){
    return window.top.FloatingFrame.show(E,_,D,A);
  }
  var B=new FloatingFrame();
  FloatingFrame.current=B;
  if(F){
    B.jContent=B.jContent.parent();
    B.jContent.css("padding","0px");
    B.jContent.html("");
  }
  B.setContent(E);
  $(".CloseButton",B.jContainer).focus();
  B.setTitle(_||"");
  B.jContainer.find(".CloseButton").click(function(){
    if($.isFunction(G)){
      G();
    }else {
      B.close();
    }
    return false;
  });
  if(C&&C.sort){
    $.each(C,function(){
      var $=this.handler;
      B.jContainer.find(this.selector).bind(this.event,function(_){
        $.call(B,_,B.jContent,this);
      });
    });
  }
  if(D){
    B.jContainer.width(D+"px");
  }
  B.show();
  return B;
};
FloatingFrame.open=function(A,H,E,B,G,I,_,D){
  if(window!=window.top){
    return window.top.FloatingFrame.open(A,H,E,B,G,I,_,D);
  }
  var C=new FloatingFrame();
  if(_){
    if(_){
      C.jContainer.find("span.do:eq(0)").hide();
      C.jContainer.find("b.doN:eq(0)").css("left","12px");
    }
  }
  FloatingFrame.current=C;
  if(G){
    C.jContent=C.jContent.parent();
    C.jContent.css("padding","0px");
    C.jContent.html("");
  }
  if(D){
    C.jContainer.find("tr:eq(0)").remove();
  }
  var F=String.format("<iframe src={0} frameBorder='0' scrolling=no style='width:100%;height:{2}px;'></iframe>",[H,E,B]);
  C.setContent(F);
  $(".CloseButton",C.jContainer).focus();
  C.setTitle(A||"");
  C.jContainer.find(".CloseButton").click(function(){
    if(C.onclose){
      var _=true;
      try{
        _=C.onclose();
      }
      catch($){
      }
      if(_!=false){
        C.close();
      }
    }else {
      var A=C.jContainer.find("iframe")[0];
      if(A){
        try{
          if(A.contentWindow.onFloatingFrameClose){
            _=true;
            _=A.contentWindow.onFloatingFrameClose();
            if(_!=false){
              C.close();
            }
          }else {
            C.close();
          }
        }
        catch($){
          C.close();
        }
      }else {
        C.close();
      }
    }
    return false;
  });
  if(I){
    C.jContainer.find(".CloseButton").before("<a style=\"display:none\" title=\"\u6700\u5c0f\u5316\u7a97\u53e3\" href=\"javascript:;\" class=\"clR1\"></a>");
    C.jContainer.find(".clR1").click(function(){
      FloatingFrame.minimize();
      return false;
    });
    C.jContainer.find("iframe").load(function(){
      C.jContainer.find(".clR1").show();
    });
  }
  if(E){
    C.jContainer.width(E);
  }
  C.show();
  return C;
};
FloatingFrame.setWidth=function(A,_){
  if(window!=window.top){
    return window.top.FloatingFrame.setWidth(A);
  }
  try{
    FloatingFrame.current.jContainer.width(A);
    if(!_){
      FloatingFrame.current.show();
    }
  }
  catch($){
  }
};
FloatingFrame.setHeight=function(_,A){
  if(window!=window.top){
    return window.top.FloatingFrame.setHeight(_);
  }
  try{
    FloatingFrame.current.jContent.find("iframe").css("height",_);
    if(!A){
      FloatingFrame.current.show();
    }
  }
  catch($){
  }
};
FloatingFrame.close=function(_){
  try{
    top.FloatingFrame.current.close(_);
  }
  catch($){
  }
};
FloatingFrame.clearContainer=function(){
  if(window!=window.top){
    return window.top.FloatingFrame.clearContainer();
  }
  FloatingFrame.current.jContainer.find("tr:eq(0)").remove();
  FloatingFrame.current.jContainer.find(".winTipC").css("border","0px").css("margin","0px").css("padding","0px");
  FloatingFrame.current.jContainer.find(".wTipCont").css("margin","0px").css("padding","0px");
};
FloatingFrame.minimize=function(){
  if(window!=window.top){
    return window.top.FloatingFrame.minimize();
  }
  var _=FloatingFrame.current;
  try{
    if(_.onminimize){
      _.onminimize();
    }
  }
  catch($){
  }
  Glass.hide();
  _.jContainer.css({left:-1000});
  return _;
};
if(!window.FF){
  FF=FloatingFrame;
}
if(window==window.top){
  document.write("<style>.glass, .glass iframe{width:100%;height:100%;position:absolute;z-index:999;left:0;top:0;background-color:black;opacity:0.1;-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=10)\";#filter:alpha(opacity=10)}</style>");
}
Menu={MENU:null,lastMenu:null,childMenuTmplate:"<a href='javascript:;' hideFocus='1'>{0}</a>",createMenu:function(D,E){
    MENU=this;
    if(D.onHideMenu instanceof Function){
      this.onHideMenu=D.onHideMenu;
    }
    if(D.onShowMenu instanceof Function){
      this.onShowMenu=D.onShowMenu;
    }
    if(!E){
      E={button:"tlBtn",menu:"dMenu",icon:"tlBtn3"};
    }
    var B=document.createElement("li");
    if(D["name"]){
      B.id=D["name"];
    }
    B.innerHTML="<a hideFocus='1' href='javascript:void(0)' class='"+E["button"]+"'><b class='"+E["icon"]+"'></b><b class='mFont139'>"+D["text"]+"</b><b class=\"mDot139\"/></b><span/></a>";
    var A=document.createElement("ul");
    A.style.display="none";
    A.style.position="absolute";
    if(D["width"]){
      A.style.width=D["width"];
    }
    A.className=E["menu"];
    for(var F=0;F<D["items"].length;F++){
      var C=D["items"][F],_=document.createElement("li");
      if(D["width"]){
        _.style.width=D["width"];
      }
      if(C.getTemplate){
        _.innerHTML=C.getTemplate;
      }else {
        _.innerHTML=this.childMenuTmplate.format(C.text);
      }
      if(C.title){
        _.title=C.title;
      }
      A.appendChild(_);
      if(C.click){
        Utils.addEvent(_,"onclick",C.click);
      }else {
        (function(A,$){
          Utils.addEvent(_,"onclick",function(){
            A["itemClick"]($["data"]);
          });
        })(D,C);
      }
      if(!C.clickNoHideMenu){
        Utils.addEvent(_,"onclick",this.hideMenu);
      }
      Utils.addEvent(_,"onmouseover",function($){
        var _=$.srcElement||$.target;
      });
      Utils.addEvent(_,"onmouseout",function($){
        var _=$.srcElement||$.target;
      });
    }
    if(D["items"].length>10){
      A.style.height="250px";
      A.style.overflowY="auto";
      A.style.overflowX="hidden";
      if("string"==typeof D.menuWidth&&D.menuWidth.toLowerCase().indexOf("px")>-1){
        A.style.width=D.menuWidth;
      }
      if(D.text.trim()=="\u6807\u7b7e"){
        A.style.height="";
        A.style.overflowY="";
        A.style.overflowX="";
      }
    }
    B.appendChild(A);
    if(D["click"]){
      $(B.firstChild.childNodes[1]).addClass("mLine139");
      Utils.addEvent(B.firstChild,"onclick",D["click"]);
      Utils.addEvent(B.firstChild.childNodes[2],"onclick",this.showMenu);
      Utils.addEvent(B.firstChild.childNodes[3],"onclick",this.showMenu);
    }else {
      Utils.addEvent(B.firstChild,"onclick",this.showMenu);
      Utils.addEvent(B.firstChild.childNodes[2],"onclick",this.showMenu);
    }
    return B;
  },showMenu:function(A){
    if(MENU.lastMenu){
      MENU.lastMenu.style.display="none";
    }
    var E=A.srcElement||A.target,D=Utils.findParent(E,"li"),_=D.childNodes[0],$=D.childNodes[1];
    $.style.position="absolute";
    $.style.display="block";
    var B=0,C=0;
    B=D.offsetLeft;
    if(B==0){
      B=D.parentNode.offsetLeft;
    }
    C=D.offsetTop;
    $.style.left=B+"px";
    $.style.top=(C+_.offsetHeight).toString()+"px";
    MENU.lastMenu=$;
    Utils.stopEvent();
    Utils.addEvent(document,"onclick",MENU.docClick);
    if(this.onShowMenu instanceof Function){
      this.onShowMenu();
    }
  },hideMenu:function(_){
    if(_){
      var A=_.srcElement||_.target,$=Utils.findParent(A,"ul");
      $.style.display="none";
    }else {
      if(MENU.lastMenu){
        MENU.lastMenu.style.display="none";
      }
    }
    MENU.lastMenu=null;
    Utils.stopEvent();
    Utils.removeEvent(document,"onclick",MENU.docClick);
    if(this.onHideMenu instanceof Function){
      this.onHideMenu();
    }
  },docClick:function(){
    MENU.hideMenu();
  }};
SimpleMenuButton={create:function(F){
    SimpleMenuButton.init();
    var _=document.createElement("li");
    if(F.rightSpace){
      _.className="mr_10";
    }
    if(F.css){
      _.style.marginLeft="10px";
    }
    if(F.title){
      _.title=F.title;
    }
    if(F.id){
      _.id=F.id;
    }
    var E=["<a class=\"pageStyle\" href=\"javascript:;\" hidefocus=\"1\" onclick=\"return false\"><i class=\"l_border\"></i><em>"+F.text+"</em><i class=\"r_border\"></i>"];
    if(F.menu){
      if(F.click){
        E=["<a hidefocus=\"1\" onclick=\"return false\"><i class=\"l_border\"></i><span class=\"mr_15\"><em class=\"sub\">"+F.text+"</em></span><i class=\"r_border\"></i>"];
        if($.browser.msie&&$.browser.version==8){
          E=["<a hidefocus=\"1\" onclick=\"return false\"><i class=\"l_border\"></i><span class=\"mr_15\"><em class=\"sub\" style=\"top:-2px;top:0px\">"+F.text+"</em></span><i class=\"r_border\"></i>"];
        }
        E.push("<span class=\"lr_ctrl_line\">|<i class=\"dot_ddl\" ></i></span>");
      }else {
        E=["<a class=\"pageStyle\" href=\"javascript:;\" hidefocus=\"1\" onclick=\"return false\"><i class=\"l_border\"></i><em class=\"sub\">"+F.text+"</em><i class=\"r_border\"></i>"];
        E.push("<i class=\"dot_ddl tool-jt\"></i>");
      }
    }
    E.push("</a>");
    var H={};
    if(F.menu){
      var C=0;
      $.each(F.menu,function(_,$){
        $.isLine&&C++;
      });
      if(F.menu.length-C>10){
        E.push("<ul class=\"toolBar_listMenu toolBar_listMenu_Hscroll\" style=\"display:none\">");
      }else {
        E.push("<ul class=\"toolBar_listMenu\" style=\"display:none\">");
      }
      for(var G=0;G<F.menu.length;G++){
        var D=F.menu[G];
        H[G]=D.click;
        if(D.isLine){
          E.push("<li class=\"line\"><span></span></li>");
        }else {
          var A=(D.text&&D.text.encode())||D.html;
          E.push("<li><a title=\""+(D.title||"")+"\" href=\"javascript:;\" onclick=\"return false\" hidefocus=\"1\"><span data=\""+(D.data||"")+"\" rel=\""+G+"\">"+A+"</span></a></li>");
        }
      }
      E.push("</ul>");
    }
    _.innerHTML=E.join("");
    $(_).click(function(_){
      var A=_.target;
      if(A.tagName=="SPAN"){
        var $=A.getAttribute("rel");
        if($&&H[$]){
          H[$]();
        }else {
          if(F.itemClick){
            F.itemClick(A.getAttribute("data"));
          }
        }
      }
    });
    var B=$(_).find("a:eq(0)");
    B.mousedown(function(){
      B.addClass("select");
    }).mouseup(function(){
      if(F.menu&&SimpleMenuButton.currentMenu&&SimpleMenuButton.currentMenu.css("display")!="none"){
        return ;
      }
      B.removeClass("select");
    }).click(F.click);
    if(F.menu){
      if(F.click){
        $(_).find("span.lr_ctrl_line").click(function(A){
          SimpleMenuButton.hideMenu();
          SimpleMenuButton.currentMenu=$(_).find("ul");
          SimpleMenuButton.showMenu();
          Utils.stopEvent(A);
        });
      }else {
        $(_).find("a:eq(0)").click(function(A){
          SimpleMenuButton.hideMenu();
          SimpleMenuButton.currentMenu=$(_).find("ul");
          SimpleMenuButton.showMenu();
          Utils.stopEvent(A);
        });
      }
    }
    return _;
  },init:function(){
    GlobalDomEvent.on("click",SimpleMenuButton.hideMenu);
    SimpleMenuButton.init=new Function();
  },showMenu:function(){
    try{
      SimpleMenuButton.currentMenu.show();
      SimpleMenuButton.currentMenu.css("visibility","");
      SimpleMenuButton.currentMenu.parent().find("a:eq(0)").addClass("select");
    }
    catch($){
    }
  },hideMenu:function(){
    if(SimpleMenuButton.currentMenu){
      try{
        SimpleMenuButton.currentMenu.parent().find("a:eq(0)").removeClass("select");
        SimpleMenuButton.currentMenu.css("visibility","hidden");
        SimpleMenuButton.currentMenu.hide();
      }
      catch($){
      }
    }
  },changeButtonText:function($,_){
    $.firstChild.childNodes[1].innerHTML=_;
  },currentMenu:null};
function ContextMenu(){
  this.init.apply(this,arguments);
  this.winClick();
}
ContextMenu.prototype.createMenuContainer=function(){
  var _=this,A=$("<ul style=\"display:none; z-index:10000;\"></ul>");
  if(_.id){
    A.attr("id",_.id);
  }
  return A;
};
ContextMenu.prototype.createMenuItem=function(A){
  var _=this,B=$("<li style=\"position:relative;\"></li>"),C="";
  if(A.isLine){
    B.addClass("line");
    C="<span></span>";
  }else {
    if(A.text){
      C="<a href=\"javascript:;\" hidefocus=\"1\"><span>"+A.text+"</span></a>";
    }else {
      if(A.html){
        C=A.html;
      }
    }
  }
  B.html(C);
  if(A.fun){
    A.li=B;
    A.fun();
  }
  if(A.title){
    B.attr("title",A.title);
  }
  if(A.click){
    B.bind("click",function(){
      A.click();
      _.highestMenu.remove();
      return false;
    });
  }else {
    if(A.menu){
      var D=B.find("a").eq(0);
      D.append("<i class=\"dot_ddl triangle_r\"></i>");
      B.bind("mouseenter",function(){
        var B=$(this);
        B.addClass("select");
        if(A.CM&&A.CM.menuContainer){
          clearTimeout(A.CM.hideTimer);
          A.CM.show();
        }else {
          var C={left:120,top:-3,highestMenu:_.highestMenu,menu:A.menu};
          if(A.menucls){
            C.cls=A.menucls;
          }
          A.timeOut=setTimeout(function(){
            A.CM=new ContextMenu(B,C);
          },250);
        }
      });
      B.bind("mouseleave",function(){
        var _=$(this);
        _.removeClass("select");
        if(A.timeOut){
          clearTimeout(A.timeOut);
        }
        if(A.CM&&A.CM.menuContainer&&A.CM.mouseoutFlag){
          A.CM.hide();
        }
      });
    }
  }
  return B;
};
ContextMenu.prototype.init=function(C,E){
  if(!E.menu){
    return ;
  }
  var $=this;
  $.options={id:"",top:0,left:0,cls:"popUp_menu",clsScroll:"toolBar_listMenu_Hscroll",highestMenu:"",iscontextmenu:false};
  for(var D in E){
    $.options[D]=E[D];
  }
  $.id=$.options.id;
  $.left=$.options.left;
  $.top=$.options.top;
  $.cls=$.options.cls;
  $.clsScroll=$.options.clsScroll;
  $.pContainer=C;
  $.iscontextmenu=$.options.iscontextmenu;
  $.callback=$.options.callback;
  $.menu=$.options.menu;
  $.mouseoutFlag=true;
  var A=C.find("."+$.cls);
  if(A.length>0){
    A.remove();
  }
  if(!$.menuContainer){
    $.menuContainer=$.createMenuContainer();
    $.menuContainer.appendTo($.pContainer);
    $.menuContainer.addClass($.cls);
    var _=$.menu.length;
    if(_>12){
      $.menuContainer.addClass($.clsScroll);
    }
    for(D=0;D<_;D++){
      var B=$.menu[D];
      if(B){
        $.menuContainer.append($.createMenuItem(B));
      }
    }
    $.menuContainer.bind("contextmenu",function(){
      return false;
    });
    $.menuContainer.bind("mouseenter",function(){
      $.mouseover();
    });
    $.menuContainer.bind("mouseleave",function(){
      $.mouseout();
    });
  }
  $.highestMenu=$.options.highestMenu||$.menuContainer;
  $.show();
};
ContextMenu.prototype.winClick=function(){
  var $=this;
  GlobalDomEvent.on("click",function(){
    $.hide(false,true);
  });
  this.winClick=new Function();
};
ContextMenu.prototype.setOffset=function(){
  var E=this,F=$(window),A=F.width(),B=F.height(),G=F.scrollLeft(),H=F.scrollTop(),I=E.menuContainer.outerWidth(),J=E.menuContainer.outerHeight(),C=E.pContainer.offset(),D=C.left,K=C.top,L=E.pContainer.width(),_=E.pContainer.height();
  L=L<A?L:0;
  _=_<B?_:0;
  E.left=(E.left+I+D)<(A+G)?E.left:Math.abs(E.left)-I-L;
  E.top=(E.top+J+K)<(B+H)?E.top:Math.abs(E.top)-J+_;
  E.menuContainer.css({"left":E.left,"top":E.top});
};
ContextMenu.prototype.show=function(){
  var $=this;
  $.setOffset();
  $.menuContainer.show();
};
ContextMenu.prototype.hide=function(_,A){
  var $=this;
  if($.menuContainer){
    if(_){
      $.hideTimer=setTimeout(function(){
        if($.menuContainer){
          $.menuContainer.hide();
          if(A){
            $.remove();
            if($.callback){
              $.callback();
            }
          }
        }
      },500);
    }else {
      $.menuContainer.hide();
      if(A){
        $.remove();
        if($.callback){
          $.callback();
        }
      }
    }
  }
};
ContextMenu.prototype.remove=function(){
  this.menuContainer.remove();
  delete this.menuContainer;
};
ContextMenu.prototype.mouseover=function(){
  var $=this;
  clearTimeout($.hideTimer);
  $.mouseoutFlag=false;
};
ContextMenu.prototype.mouseout=function(){
  var $=this;
  $.hide(true,true);
  $.mouseoutFlag=true;
};
function PageTurnner($,A){
  var _=this;
  this.pageIndex=A;
  this.fristPage=function(){
    this.turnPage(1);
  };
  this.lastPage=function(){
    this.turnPage($);
  };
  this.nextPage=function(){
    this.turnPage(_.pageIndex+1);
  };
  this.previousPage=function(){
    this.turnPage(_.pageIndex-1);
  };
  this.turnPage=function(_){
    if(_<1||_>$||_==this.pageIndex){
      return ;
    }
    this.pageIndex=_;
    this.callPageChangeHandler(_);
  };
  this.pageChangeHandlers=[];
  this.addPageChangeListener=function($){
    this.pageChangeHandlers.push($);
  };
  this.callPageChangeHandler=function(_){
    for(var $=0;$<this.pageChangeHandlers.length;$++){
      this.pageChangeHandlers[$](_);
    }
  };
}
PageTurnner.createStyleNew=function(_,C,J,F){
  var E=Utils.isString(J)?document.getElementById("containerId"):J,G=$("#ulPageTurner").css("marginTop","-5px");
  if(G&&G.length==0){
    if(E&&E.parentNode&&E.parentNode.parentNode){
      G=$("<ul class='toolBar139_main' id='ulPageTurner' style='float:right;margin-right:10px; margin-top:-5px;'></ul>").appendTo(E.parentNode.parentNode);
    }else {
      return ;
    }
  }
  G.html("");
  btnPrevious=SimpleMenuButton.create({text:"\u4e0a\u4e00\u9875",click:function(){
      K.previousPage();
      return false;
    }});
  btnNext=SimpleMenuButton.create({text:"\u4e0b\u4e00\u9875",click:function(){
      K.nextPage();
      return false;
    }});
  var H=[],I=Math.min(_,300);
  for(var D=1;D<=I;D++){
    H.push({text:D+"/"+_+"\u9875",data:D});
  }
  btnTurnPage=SimpleMenuButton.create({text:"$page$",menu:H,css:true,itemClick:function($){
      K.turnPage(parseInt($));
    }});
  $(btnTurnPage).find("ul").css("left","-50px");
  G.append(btnPrevious);
  G.append(btnNext);
  G.append(btnTurnPage);
  var K=new PageTurnner(_,C);
  SimpleMenuButton.changeButtonText(btnTurnPage,C+"/"+_+"\u9875");
  K.addPageChangeListener(function($){
    SimpleMenuButton.changeButtonText(btnTurnPage,$+"/"+_+"\u9875");
  });
  K.addPageChangeListener(B);
  K.addPageChangeListener(F);
  B(C);
  function B($){
    A(btnPrevious,false);
    A(btnNext,false);
    if($==1){
      A(btnPrevious,true);
    }
    if($==_){
      A(btnNext,true);
    }
  }
  function A($,_){
    if(_){
      $.style.display="none";
    }else {
      $.style.display="";
    }
  }
};
PageTurnner.createStyle=function($,G,M,L,J){
  if(J){
    return PageTurnner.createStyleNew($,G,M,L);
  }
  var N=new PageTurnner($,G),O=F("\u4e0b\u4e00\u9875"),E=F("\u4e0a\u4e00\u9875"),D=F("\u9996\u9875"),_=F("\u672b\u9875");
  function F($){
    var _=document.createElement("a");
    _.innerHTML=$;
    _.href="javascript:void(0)";
    return _;
  }
  D.onclick=function(){
    N.fristPage();
    this.blur();
    return false;
  };
  E.onclick=function(){
    N.previousPage();
    this.blur();
    return false;
  };
  O.onclick=function(){
    N.nextPage();
    this.blur();
    return false;
  };
  _.onclick=function(){
    N.lastPage();
    this.blur();
    return false;
  };
  var A=document.createElement("select");
  for(var H=1;H<=$;H++){
    var K=new Option(H.toString()+"/"+$+"\u9875",H);
    A.options.add(K);
    if(H==G){
      K.selected=true;
    }
  }
  A.onchange=function(){
    N.turnPage(this.selectedIndex+1);
  };
  N.addPageChangeListener(function($){
    A.options[$-1].selected=true;
  });
  B(D,true);
  B(E,true);
  N.addPageChangeListener(C);
  N.addPageChangeListener(L);
  var I;
  if(typeof (M)=="string"){
    I=document.getElementById(M);
  }else {
    I=M;
  }
  I.appendChild(E);
  I.appendChild(document.createTextNode(" "));
  I.appendChild(O);
  I.appendChild(document.createTextNode(" "));
  I.appendChild(A);
  C(G);
  function C(A){
    B(D,false);
    B(E,false);
    B(O,false);
    B(_,false);
    if(A==1){
      B(D,true);
      B(E,true);
    }
    if(A==$){
      B(O,true);
      B(_,true);
    }
  }
  function B($,_){
    if(_){
      $.style.display="none";
    }else {
      $.style.display="";
    }
  }
};
var PopTip={element:null,show:function(_,$,F){
    F=F||20000;
    PopTip.isClosed=false;
    if(!PopTip.element){
      PopTip.element=document.createElement("div");
      PopTip.element.id="popTip";
      PopTip.element.className="popTip";
      PopTip.element.style.position="absolute";
      PopTip.element.style.right="1px";
      PopTip.element.style.bottom="0px";
      PopTip.element.style.display="none";
      PopTip.element.style.zIndex=9999;
      document.body.appendChild(PopTip.element);
      PopTip.element.onmouseout=PopTip.mouseOut;
    }
    PopTip.element.innerHTML=PopTip.getHtml(_,$);
    var E=PopTip,D=0,A=0,B=window.setInterval(C,100);
    function C(){
      if(PopTip.isClosed){
        E.element.style.display="none";
        PopTip.isClosed=false;
        window.clearInterval(B);
      }else {
        E.element.style.display="block";
        D=E.element.offsetHeight;
        if(A<=D+1){
          E.element.style.bottom=(-D+A).toString()+"px";
        }else {
          window.clearInterval(B);
          A=0;
          if(!E.isOver){
            E.timerClose=setTimeout(E.close,F);
          }
        }
        var $=30*(D-A)/D;
        A+=$<2?2:$;
      }
    }
  },timerClose:0,isClosed:true,isOver:false,close:function(){
    PopTip.element.style.bottom=(-PopTip.element.offsetHeight).toString()+"px";
    PopTip.element.style.display="none";
    PopTip.isClosed=true;
  },mouseMove:function(){
    if(PopTip.timerClose!=0){
      PopTip.isOver=true;
      clearTimeout(PopTip.timerClose);
    }
  },mouseOut:function(B){
    if(!$.browser.msie){
      event=B;
    }
    var A=$(event.srcElement).attr("class"),D=event.fromeElement?event.fromeElement.tagName:"undefined",E=event.toElement?event.toElement.tagName:"undefined",C=event.relatedTarget?event.relatedTarget.tagName:"IFRAME",_=$(event.currentTarget).attr("class");
    if($.browser.msie){
      if(E=="undefined"||(E=="IFRAME"&&(A=="pop-rbBar"||"pop-rb_mes mail-rb_mes"==A||D=="undefined"))){
        PopTip.isOver=false;
        PopTip.timerClose=setTimeout(PopTip.close,5000);
      }
    }else {
      if(((A=="pop-rbBar"||"pop-rb_mes mail-rb_mes"==A||_=="popTip")||event.target.tagName=="H2")&&("IFRAME"==C)){
        PopTip.isOver=false;
        PopTip.timerClose=setTimeout(PopTip.close,5000);
      }
    }
  },getHtml:function(_,$){
    var A="<div class=\"pop-rbBar\"   onmousemove=\"PopTip.mouseMove()\" ><!--style\u4e34\u65f6\u6d4b\u5f0f\u52a0-->\t\t\t<h2><a href=\"javascript:;\" id='closeLink' class=\"pop-rb_close\" title=\"\u70b9\u51fb\u5173\u95ed\" hidefocus=\"1\" onclick=\"PopTip.close();return false;\"></a><font>{title}</font></h2>\t\t\t<div class=\"pop-rb_mes mail-rb_mes\">{text}</div>\t\t</div>";
    return String.format(A,{title:_,text:$});
  },rollTitleCfg:{"orgTitle":document.title,"mailTitle":"","printSpeed":420,"rollSpeed":200,"strIndex":0,"timeHandler":null,"run":1,"isBindEvent":0},allDocOnClick:function(){
    PopTip.reSetRollCfg();
    PopTip.cancelDocClickEvent();
  },reSetRollCfg:function(){
    PopTip.rollTitleCfg.run=PopTip.rollTitleCfg.strIndex=0;
    PopTip.rollTitleCfg.timeHandler=null;
    document.title=this.rollTitleCfg.orgTitle;
  },runRollTitle:function(){
    if(this.rollTitleCfg.timeHandler){
      clearTimeout(this.rollTitleCfg.timeHandler);
    }
    if(!this.rollTitleCfg.run){
      this.rollTitleCfg.run=1;
      return ;
    }
    var $=this.rollTitleCfg.mailTitle;
    document.title=$.substring(this.rollTitleCfg.strIndex,$.length)+" "+$;
    this.rollTitleCfg.strIndex++;
    if(this.rollTitleCfg.strIndex>$.length){
      this.rollTitleCfg.strIndex=0;
    }
    this.rollTitleCfg.timeHandler=setTimeout("PopTip.runRollTitle()",this.rollTitleCfg.printSpeed);
  },playTipSound:function(){
    $(document.body).append("<embed id=\"tipSound\" src=\""+top.rmResourcePath+"/images/receiveMail.wav\" pluginspage=\"http://www.microsoft.com/isapi/redir.dll?prd=windows&amp;sbp=mediaplayer&amp;ar=media&amp;sba=plugin&amp;\" type=\"audio/x-wav\" border=\"0\" width=\"0px\" height=\"0px\" hidden=\"true\" showcontrols=\"false\" showaudiocontrols=\"false\" showstatusbar=\"false\" autostart=\"true\" loop=\"false\" enablecontextmenu=\"false\"></embed>");
    setTimeout(function(){
      $("#tipSound").remove();
    },1200);
  }};
function Repeater($){
  this.HtmlTemplate=null;
  this.HeaderTemplate=null;
  this.FooterTemplate=null;
  this.ItemTemplate;
  this.ItemTemplateOrign;
  this.SeparateTemplate;
  this.Functions=null;
  this.DataSource=null;
  this.ItemContainer;
  this.ItemDataBound=null;
  this.RenderMode=0;
  this.RenderCallback=null;
  this.Element;
  RP=this;
  this.Instance=null;
  this.DataRow=null;
  if(typeof ($)!=undefined){
    if(typeof ($)=="string"){
      this.Element=document.getElementById($);
    }else {
      this.Element=$;
    }
  }
  this.DataBind=function(){
    if(this.DataSource.length==0){
      return ;
    }
    if(this.HtmlTemplate==null){
      this.HtmlTemplate=this.Element.innerHTML;
    }
    var D=/(<!--item\s+start-->)([\r\n\w\W]+)(<!--item\s+end-->)/i,C=this.HtmlTemplate.match(D);
    this.ItemTemplateOrign=C[0];
    this.ItemTemplate=C[2];
    reg1=/\$\w+\s?/ig;
    reg2=/\@(\w+)\s?\((.*?)\)/ig;
    var $=new Array();
    for(var F=0;F<this.DataSource.length;F++){
      var _=this.DataSource[F];
      _["index"]=F;
      this.DataRow=_;
      var E=this.ItemTemplate;
      E=E.replace(reg2,function(E,D,G){
        var A=D.trim(),C=G.split(","),$=new Array();
        for(var F=0;F<C.length;F++){
          $.push(_[C[F]]);
        }
        if(RP.Functions[A]){
          var B=RP;
          if(RP.Instance){
            RP.Instance.DataRow=_;
            B=RP.Instance;
          }
          return RP.Functions[A].apply(B,$);
        }
      });
      E=E.replace(reg1,function($){
        m=$.substr(1).trim();
        if(_[m]!=undefined){
          return _[m];
        }else {
          return "$"+m;
        }
      });
      var A={index:F,data:_,html:E};
      if(this.ItemDataBound){
        var B=this.ItemDataBound(A);
        if(B){
          E=B;
        }
      }
      $.push(E);
    }
    this.Render($);
  };
  this.Render=function($){
    if(!this.RenderCallback){
      var A=$.join("");
      if("0".replace("0","$&")==="0"){
        A=A.replace(/\$/ig,"$$$$");
      }
      var E="";
      if(this.HtmlTemplate){
        E=this.HtmlTemplate.replace(this.ItemTemplateOrign,A);
      }else {
        E=this.ItemTemplate.replace(this.ItemTemplateOrign,A);
      }
      if(this.HeaderTemplate){
        E=this.HeaderTemplate+E;
      }
      if(this.FooterTemplate){
        E=E+this.FooterTemplate;
      }
      if(this.onRender){
        this.onRender(this.Element,E);
      }else {
        this.Element.innerHTML=E;
      }
    }else {
      var D=0,_=this.Element,G=null,C={index:0,element:_,html:"",rowCount:$.length};
      function F(){
        C.index=D;
        C.element=_;
        C.html=$[D];
        RP.RenderCallback(C);
      }
      if(RP.Instance.RenderMode){
        var B=setInterval(function(){
          if(D<$.length){
            F();
            D++;
          }else {
            clearInterval(B);
          }
        },50);
      }else {
        while(D<$.length){
          F();
          D++;
        }
      }
    }
  };
}
Object.extend=function($,_){
  for(var A in _){
    $[A]=_[A];
  }
  return $;
};
function DataList(E){
  this.Layout=1;
  this.RepeatColumns=5;
  this.ItemTemplate=null;
  this.id="table_list";
  this.Style_Cell=null;
  this.ulClassName="";
  this.RenderMode=0;
  var _=new Repeater(E),$=this,F=document.createElement("table"),C=null,A=null;
  this.DataSource=null;
  this.Functions=null;
  this.DataRow=null;
  function D(A){
    var E=document.createElement("td");
    E.innerHTML=A.html;
    if($.Style_Cell){
      E.className=$.Style_Cell;
    }
    if(A.index==0){
      var D=document.createElement("table"),B=document.createElement("tbody");
      C=document.createElement("tr");
      D.appendChild(B);
      B.appendChild(C);
      _.Element.appendChild(D);
      D.id=$.id;
      C.appendChild(E);
    }else {
      if(A.index==A.rowCount-1){
        C.appendChild(E);
      }else {
        if(A.index%$.RepeatColumns==0){
          B=C.parentNode;
          C=document.createElement("tr");
          B.appendChild(C);
          C.appendChild(E);
        }else {
          C.appendChild(E);
        }
      }
    }
  }
  function B(B){
    if(B.index==0){
      A=document.createElement("ul");
      A.className=$.ulClassName||"dataUl";
      _.Element.appendChild(A);
      A.innerHTML=B.html;
    }else {
      var C=A.innerHTML;
      A.innerHTML=C+B.html;
    }
  }
  _.RenderCallback=function(_){
    if($.Layout){
      D(_);
    }else {
      B(_);
    }
  };
  this.DataBind=function(){
    var A=new Array();
    A.push("<!--item start-->");
    A.push(this.ItemTemplate);
    A.push("<!--item end-->");
    _.HtmlTemplate=A.join("");
    _.DataSource=this.DataSource;
    _.Functions=$.Functions;
    _.Instance=$;
    _.DataBind();
  };
}
function AutoCompleteMenu(host,I,A){
  var C=this,H={up:38,down:40,enter:13,space:32,tab:9,left:37,right:39},L=top.$.browser.msie&&top.$.browser.version>8,U=false,Q=host.ownerDocument,J="#3399FE",K="position:absolute;z-index:101;display:none;border:1px solid #99ba9f;height:200px;overflow:auto;overflow-x:hidden;background:white",O="width:100%;line-height:20px;text-indent:3px;cursor:pointer;display:block;",T=Q.createElement("iframe");
  with(T.style){
    position="absolute";
    zIndex=100;
    display="none";
  }
  var items=[],container=Q.createElement("div");
  container.onclick=function($){
    Utils.stopEvent($);
  };
  container.onmousedown=function($){
    Utils.stopEvent($);
  };
  if(document.all){
    $(document).click(F);
  }
  function E(){
    items.length=0;
    container.innerHTML="";
  }
  this.addItem=function(B,$){
    if(typeof B=="object"){
      var C=B;
    }else {
      C=Q.createElement("span");
      C.value=B;
      C.innerHTML=$;
    }
    if(document.all){
      C.style.cssText=O;
    }else {
      C.setAttribute("style",O);
    }
    C.onmousedown=function(){
      A(this);
      F();
      var $=host.getAttribute("setvaluehandler");
      if($&&window[$]){
        window[$]();
      }
    };
    C.onmouseover=function(){
      _(this);
    };
    C.menu=this;
    C.selected=false;
    items.push(C);
    container.appendChild(C);
  };
  function P(){
    var $=S();
    if($>=0){
      return items[$];
    }
    return null;
  }
  function S(){
    for(var $=0;$<items.length;$++){
      if(items[$].selected){
        return $;
      }
    }
    return -1;
  }
  function _(_){
    var $=P();
    if($!=null){
      R($);
    }
    _.selected=true;
    _.style.backgroundColor=J;
    _.style.color="white";
    A(_,container);
    function A(_,A){
      var B={top:S()*_.offsetHeight,bottom:_.offsetTop+_.offsetHeight},$={top:A.scrollTop,bottom:A.scrollTop+A.offsetHeight};
      if($.top>B.top){
        A.scrollTop-=$.top-B.top;
      }else {
        if($.bottom<B.bottom){
          A.scrollTop+=B.bottom-$.bottom;
        }
      }
    }
  }
  function R($){
    $.selected=false;
    $.style.backgroundColor="";
    $.style.color="";
  }
  function B(){
    if(U){
      return ;
    }
    if(container.parentNode!=Q.body){
      Q.body.appendChild(container);
      Q.body.appendChild(T);
    }
    with(container.style){
      display="block";
      width=Math.max(host.offsetWidth,400)+"px";
      Utils.offsetHost(host,container);
      if(items.length<7){
        height=items[0].offsetHeight*items.length+10+"px";
      }else {
        height=items[0].offsetHeight*7+"px";
      }
    }
    var showBGIframe=false;
    if(document.all&&!L){
      showBGIframe=true;
    }
    if(navigator.userAgent.indexOf("Chrome")>0){
      showBGIframe=true;
    }
    with(T.style){
      left=container.style.left;
      top=container.style.top;
      width=Math.max(0,container.offsetWidth-3)+"px";
      height=Math.max(0,container.offsetHeight-3)+"px";
      if(showBGIframe){
        display="";
      }
    }
    _(items[0]);
    U=true;
  }
  function F(){
    if(!U){
      return ;
    }
    container.style.display="none";
    T.style.display="none";
    E();
    U=false;
  }
  if(document.all){
    container.style.cssText=K;
    host.attachEvent("onkeyup",N);
    host.attachEvent("onblur",D);
    host.attachEvent("onkeydown",M);
  }else {
    container.setAttribute("style",K);
    host.addEventListener("keyup",N,true);
    host.addEventListener("blur",D,true);
    host.addEventListener("keydown",M,true);
  }
  var G=setInterval(function(){
    try{
      if(host.value&&host.getAttribute("last_handler_value")!=host.value){
        N({});
      }
    }
    catch($){
      clearInterval(G);
    }
  },1000);
  function N($){
    switch(($||event).keyCode){
    case H.enter:
    case H.up:
    case H.down:
    case H.left:
    case H.right:
      return ;
    }
    F();
    host.setAttribute("last_handler_value",host.value);
    I(C,$||event);
    if(items.length>0){
      B();
    }
  }
  function D(){
    if(!document.all){
      F();
    }
  }
  function M(A){
    A=A||event;
    switch(A.keyCode){
    case H.space:
    case H.tab:
    case H.enter:
      B();
      break ;
    case H.up:
      $();
      break ;
    case H.down:
      C();
      break ;
    case H.right:
    case H.left:
      F();
      break ;
    default:
      return ;
    }
    function B(){
      var $=P();
      if($!=null){
        $.onmousedown();
      }
      if(A.keyCode==H.enter){
        Utils.stopEvent(A);
      }
    }
    function $(){
      var $=S();
      if($>=0){
        $--;
        $=$<0?$+items.length:$;
        _(items[$]);
      }
    }
    function C(){
      var $=S();
      if($>=0){
        $=($+1)%items.length;
        _(items[$]);
      }
    }
  }
}
function preLinkManListData(C,_,A){
  if(window.allLinkMan){
    return window.allLinkMan;
  }
  B(C);
  if(_){
    B(_);
  }
  if(A){
    B(A);
  }
  allLinkMan=[];
  if(_){
    allLinkMan=allLinkMan.concat(_);
  }
  if(A){
    allLinkMan=allLinkMan.concat(allLinkMan);
  }
  allLinkMan=allLinkMan.concat(C);
  $(allLinkMan);
  function B($){
    for(var A=0;A<$.length;A++){
      var _=$[A];
      _.lowerAddr=_.addr.toLowerCase();
      _.lowerName=_.name.toLowerCase();
      _.jianpin=_.jianpin||"";
      _.quanpin=_.quanpin||"";
    }
  }
  function $(A){
    var _={};
    for(var B=0;B<A.length;B++){
      var $=A[B];
      if(!$.lowerAddr){
        continue ;
      }
      if(!_[$.lowerAddr+"_"+$.name]){
        _[$.lowerAddr+"_"+$.name]=B+1;
      }else {
        A[_[$.lowerAddr+"_"+$.name]-1]=$;
        A.splice(B,1);
        B--;
      }
    }
  }
  return allLinkMan;
}
function __getAuto__(B,F,S,N,Q){
  var D=preLinkManListData(B,F,S),T=D.length,E=[],J={},M={"addr":"01","name":"02","quanpin":"03","jianpin":"04"},C={"01":"addr","02":"name","03":"quanpin","04":"jianpin"},A="0._.0";
  function L(C,$,D){
    var _=$+A+C;
    if($<10){
      _="0"+_;
    }
    var B=J[_];
    if(!B){
      J[_]=B=[];
    }
    B.push(D);
  }
  for(var W=0;W<T;W++){
    var X=D[W];
    if(Q.value.indexOf("<"+X.addr+">")>0){
      continue ;
    }
    var K=10000,$=null,O=X.lowerAddr.indexOf(N);
    if(O!=-1&&O<K){
      K=O;
      $=M.addr;
    }
    if(O==0){
      L($,K,W);
      continue ;
    }
    O=X.lowerName.indexOf(N);
    if(O!=-1&&O<K){
      K=O;
      $=M.name;
    }
    if(K==0){
      L($,K,W);
      continue ;
    }
    if(!/[^a-zA-Z]/.test(N)){
      O=X.quanpin.indexOf(N);
      if(O!=-1&&O<K){
        K=O;
        $=M.quanpin;
      }
      if(K==0){
        L($,K,W);
        continue ;
      }
      O=X.jianpin.indexOf(N);
      if(O!=-1&&O<K){
        K=O;
        $=M.jianpin;
      }
    }
    if($){
      L($,K,W);
      continue ;
    }
  }
  var G=[];
  for(var Y in J){
    G.push(Y);
  }
  G.sort(function(_,$){
    return _.localeCompare($);
  });
  var _=30;
  for(W=0;W<G.length;W++){
    if(E.length>=_){
      break ;
    }
    var V=G[W],R=J[V],I=H(V),Z=P(V);
    for(var U=0;U<R.length;U++){
      var a=R[U];
      E.push({info:D[a],matchAttr:I,matchIndex:Z});
    }
  }
  function H($){
    return C[$.split(A)[1]];
  }
  function P($){
    return parseInt($.split(A)[0],10);
  }
  return E;
}
AutoCompleteMenu.createAddrMenu_compose=function(_,$){
};
AutoCompleteMenu.createAddrMenu=function(D,A,B,L){
  if(typeof A=="undefined"){
    A=true;
  }
  L=L||";";
  var M=/^([^@]+)@(.+)$/,N=/(?:[;,；，]|^)\s*([^;,；，\s]+)$/,H=[];
  if(!top.LinkManList){
    return ;
  }
  if(!B){
    var K=top.GroupList,G=top.LinkManList,I=top.LastLinkList,E=top.CloseLinkList;
  }else {
    K=B.GroupList,G=B.LinkManList,I=B.LastLinkList,E=B.CloseLinkList;
  }
  function J(C){
    var K=D.value.match(N);
    if(!K){
      return false;
    }
    var M=K[1].trim().toLowerCase();
    if(M==""){
      return false;
    }
    try{
      if(Utils.isChinaMobileNumber(M)&&M.length==11){
        D.value=D.value.replace(/([;,；，]|^)\s*([^;,；，\s]+)$/,"$1"+M+"@139.com;");
        return ;
      }
    }
    catch($){
    }
    var B=__getAuto__(G,I,E,M,D),_=M.length;
    for(var O=0;O<B.length;O++){
      var H=B[O],J=H.info,F=A?"\""+J.name.replace(/\"/g,"")+"\"<"+J.addr+">":J.addr,L="";
      if(H.matchAttr=="addr"){
        matchText=J.addr.substring(H.matchIndex,H.matchIndex+_);
        L=J.addr.replace(matchText,"[b]"+matchText+"[/b]");
        L="\""+J.name.replace(/\"/g,"")+"\"<"+L+">";
        L=L.encode().replace("[b]","<span style='font-weight:bold'>").replace("[/b]","</span>");
      }else {
        if(H.matchAttr=="name"){
          matchText=J.name.substring(H.matchIndex,H.matchIndex+_);
          L=J.name.replace(matchText,"[b]"+matchText+"[/b]");
          L="\""+L.replace(/\"/g,"")+"\"<"+J.addr+">";
          L=L.encode().replace("[b]","<span style='font-weight:bold'>").replace("[/b]","</span>");
        }else {
          L="\""+J.name.replace(/\"/g,"")+"\"<"+J.addr+">";
          L=L.encode();
        }
      }
      C.addItem(F,L);
    }
  }
  if(!D.getAttribute("backspacedeleteoff")){
    $(D).keydown(function(A){
      if(A.keyCode==8&&!A.ctrlKey&&!A.shiftKey){
        var C=getTextBoxPos(this);
        if(!C||C.start!=C.end||C.start==0||C.start<this.value.length){
          return ;
        }
        var E=this.value,D=E.charAt(C.start-1);
        if(/[;,；，>]/.test(D)){
          var $=E.substring(0,C.start),_=E.substring(C.start,E.length),B=$.replace(/(^|[;,；，])[^;,；，]+[;,；，>]$/,"$1$1");
          this.value=B+_;
        }
      }
    });
  }
  function C($,_){
    for(var A=$.length-1;A>=0;A--){
      if(_.id&&_.id==$[A].id){
        return true;
      }
    }
    return false;
  }
  function _($){
    D.value=D.value.replace(/；/g,";").replace(/，/g,",");
    D.value=D.value.replace(/([;,]|^)\s*([^;,\s]+)$/,"$1"+$.value+L);
  }
  F();
  function F(){
    if(G){
      new AutoCompleteMenu(D,J,_);
    }
  }
};
function getTextBoxPos(B){
  var $=0,D=0;
  if(typeof (B.selectionStart)=="number"){
    $=B.selectionStart;
    D=B.selectionEnd;
  }else {
    if(document.selection){
      B.focus();
      var E=document.selection.createRange(),_=E.text.length;
      if(_>0){
        return null;
      }
      B.select();
      var C=document.selection.createRange();
      E.setEndPoint("StartToStart",C);
      var A=E.text.length;
      E.collapse(false);
      E.select();
      $=A;
      D=$+_;
    }
  }
  return {start:$,end:D};
}
AutoCompleteMenu.createPostfix=function(_){
  new AutoCompleteMenu(_,function(B){
    var A=["@sina.com","@sohu.com","@21cn.com","@tom.com","@yahoo.com.cn","@yahoo.cn"],E=_.value;
    if($.trim(E)==""){
      return ;
    }
    var D=E.match(/\w+(@[\w.]*)/);
    for(var F=0;F<A.length;F++){
      if(D){
        if(A[F].indexOf(D[1])==0&&A[F]!=D[1]){
          var C=E.match(/^([^@]*)@/)[1];
          B.addItem(C+A[F],C+A[F]);
        }
      }else {
        B.addItem(E+A[F],E+A[F]);
      }
    }
  },function($){
    _.value=$.value;
  });
};
AutoCompleteMenu.createPhoneNumberMenuFromLinkManList=function($,C,_){
  var E=/(?:^|[;,])\s*([^;,]+)$/,D="randomName"+Math.random();
  function A(F){
    var S=$.value.match(E),T="";
    if(S){
      T=S[1].toLowerCase();
    }else {
      return false;
    }
    var R=0,G=window.LinkManList||[],N=window.LastLinkList||[],B=window.CloseLinkList||[];
    if(_){
      G=_.LinkManList||_;
      N=_.LastLinkList||[];
      B=_.CloseLinkList||[];
    }
    var I=window[D]||(G.concat(N).concat(B));
    window[D]=I;
    var A={};
    for(var K=0,J=I.length;K<J;K++){
      var U=I[K];
      if(!U.addr){
        continue ;
      }
      var M=U.addr.replace(/\D/g,""),Q=U.name.replace(/[<>"']/g,""),P;
      if($.value.indexOf(M)>=0){
        continue ;
      }
      if(M.indexOf(T)>=0){
        var O=M.replace(T,"<span style='color:Red'>"+T+"</span>");
        if(Q){
          O="\""+Q+"\"<"+O+">";
        }
        if(C){
          H("\""+Q+"\"<"+M+">",O,M);
        }else {
          H(M,O,M);
        }
      }else {
        if((P=Q.toLowerCase().indexOf(T))>=0){
          var L=Q.substring(P,P+T.length),O=Q.replace(L,"<span style='color:Red'>"+L+"</span>");
          if(Q){
            O="\""+O+"\"<"+M+">";
          }
          if(C){
            H("\""+Q+"\"<"+M+">",O,M);
          }else {
            H(M,O,M);
          }
        }else {
          if((U.quanpin&&U.quanpin.indexOf(T)>=0)||(U.jianpin&&U.jianpin.indexOf(T)>=0)){
            O="\""+Q+"\"<"+M+">";
            if(C){
              H(O,O,M);
            }else {
              H(M,O,M);
            }
          }
        }
      }
      if(R>=50){
        break ;
      }
    }
    function H(_,$,B){
      if(!A[B]){
        F.addItem(_,$);
        R++;
        A[B]=true;
      }
    }
    return !(R==0);
  }
  function B(_){
    $.value=$.value.replace(/([;,]|^)\s*([^;,\s]+)$/,"$1"+_.value+",");
  }
  window.top.Contacts.ready(function(){
    if(!window.LinkManList){
      top.Contacts.init("mobile",window);
    }
    new AutoCompleteMenu($,A,B,C);
  });
};
AutoCompleteMenu.createPhoneNumberMenuForSearchByMobile=function($){
  var B=/(?:^|[;,])\s*(\d+)$/;
  function _(C){
    var F=$.value.match(B),H="";
    if(F){
      H=F[1];
    }else {
      return false;
    }
    var E=0;
    for(var I=0,G=LinkManList.length;I<G;I++){
      if(!LinkManList[I].addr){
        continue ;
      }
      var _=LinkManList[I].addr.toString(),D=LinkManList[I].name;
      if($.value.indexOf(_)>=0){
        continue ;
      }
      if(_.indexOf(H)==0){
        var A=_.replace(H,"<span style='color:Red'>"+H+"</span>");
        if(D){
          A="("+D+")"+A;
        }
        C.addItem(_,A);
        E++;
      }
      if(E>=50){
        break ;
      }
    }
    return !(E==0);
  }
  function A(_){
    $.value=$.value.replace(/([;,]|^)\s*([^;,\s]+)$/,"$1"+_.value);
  }
  new AutoCompleteMenu($,_,A);
};
AutoCompleteMenu.createPhoneNumberMenu=function($,_){
  var C=/(?:^|[;,])\s*(\d+)$/;
  function A(D){
    var F=$.value.match(C),H="";
    if(F){
      H=F[1];
    }else {
      return false;
    }
    var E=0;
    for(var I=0,G=_.length;I<G;I++){
      if(!_[I].number){
        continue ;
      }
      var A=_[I].number.toString();
      if($.value.indexOf(A)>=0){
        continue ;
      }
      if(A.indexOf(H)==0){
        var B=A.replace(H,"<span style='color:Red'>"+H+"</span>");
        if(_[I].name){
          B="("+_[I].name+")"+B;
        }
        D.addItem(A,B);
        E++;
      }
      if(E>=50){
        break ;
      }
    }
    return !(E==0);
  }
  function B(_){
    $.value=$.value.replace(/([;,]|^)\s*([^;,\s]+)$/,"$1"+_.value+",");
  }
  new AutoCompleteMenu($,A,B);
};
var WaitPannel=new Object();
WaitPannel.show=function(_,$){
  div=document.getElementById("contextWaitPannel");
  if(!div){
    div=document.createElement("div");
    div.id="contextWaitPannel";
    div.className="loadingInfo";
    div.style.position="absolute";
    div.style.zIndex="99999999";
    if(!_){
      _="\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019........";
    }
    div.innerHTML=_.encode();
    div.style.left=document.body.clientWidth/2-20;
    div.style.top=document.body.clientHeight/2-30;
    document.body.appendChild(div);
  }
  div.style.left=document.body.clientWidth/2-20;
  div.style.top=document.body.clientHeight/2-30;
  if($){
    setTimeout(WaitPannel.hide,$);
  }
};
WaitPannel.hide=function(){
  div=document.getElementById("contextWaitPannel");
  if(div){
    document.body.removeChild(div);
  }
};
function PopMenu(C){
  Utils.stopEvent();
  var _=this,A=document.createElement("div");
  this.container=A;
  A.id="popMenu";
  A.className=C||"popMenu";
  with(A.style){
    display="none";
    zIndex=999;
    lineHeight="20px";
    border="1px solid #F7E5B5";
    backgroundColor="#FFFDF6";
    padding="5px 15px";
  }
  var B=null;
  this.show=function(C){
    if(PopMenu.current){
      PopMenu.current.hide();
    }
    PopMenu.current=_;
    document.body.appendChild(A);
    var D=$(C).offset();
    A.style.left=D.left+"px";
    A.style.top=D.top+$(C).height()+"px";
    A.style.display="block";
    A.style.position="absolute";
    B=function(){
      $(this).unbind("click",arguments.callee);
      if(PopMenu.current){
        PopMenu.current.hide();
      }
    };
    $(document).click(B);
    Utils.stopEvent();
  };
  A.onclick=function($){
    Utils.stopEvent();
  };
  this.hide=function(){
    if(!PopMenu.current){
      return ;
    }
    if(A.parentNode){
      A.parentNode.removeChild(A);
    }
    if(_.onHide){
      _.onHide();
    }
    $(document).unbind("click",B);
    PopMenu.current=null;
  };
  this.addItem=function(B,$){
    var C;
    if(typeof (B)=="string"){
      C=document.createElement("a");
      C.innerHTML=B;
    }else {
      C=B;
    }
    C.href="javascript:void(0)";
    C.onclick=function(A){
      if($){
        $(this);
      }
      _.hide();
    };
    A.appendChild(C);
  };
  this.setContent=function($){
    if(typeof $=="string"){
      A.innerHTML=$;
    }else {
      A.innerHTML="";
      A.appendChild($);
    }
  };
}
function TabPage(A,C,B){
  var $=arguments.length==4?arguments[3]:null,_=new Object();
  _.TabList=C;
  _.Container=A;
  _.SelectedIndex=0;
  _.OnTabChange=B;
  _.tabControl=null;
  _.tabContent=null;
  _.contentList=new Object();
  if(_.tabControl==null){
    _.tabControl=document.createElement("div");
    _.tabControl.className="tipBox";
    _.Container.appendChild(_.tabControl);
    _.tabContent=document.createElement("div");
    _.Container.appendChild(_.tabContent);
    _.tabContent.className="tab_content";
  }
  _.SetPageContent=function($){
    var B=_.SelectedIndex;
    if(_.tabContent.childNodes.length>0){
      _.tabContent.removeChild(_.tabContent.childNodes[0]);
    }
    if(_.contentList[B]){
      _.tabContent.appendChild(_.contentList[B]);
    }else {
      var A=document.createElement("div");
      _.tabContent.appendChild(A);
      if(typeof ($)=="string"){
        A.innerHTML=$;
      }else {
        A.appendChild($);
      }
      _.contentList[B]=A;
    }
  };
  _.RenderTab=function(B){
    var $=0;
    for(elem in _.TabList){
      obj=_.TabList[elem];
      var A;
      if(B){
        A=document.createElement("div");
        A.style.display="inline";
        A.innerHTML=obj;
        _.tabControl.appendChild(A);
      }else {
        A=_.tabControl.childNodes[$];
      }
      if(_.SelectedIndex==$){
        A.className="tab_on";
      }else {
        A.className="tab";
      }
      (function(){
        var B=$;
        A.onclick=function(){
          _.ChangeTab(B);
        };
      })();
      $++;
    }
  };
  _.ChangeTab=function(A){
    _.SelectedIndex=A;
    _.RenderTab(false);
    _.OnTabChange(A,$);
  };
  _.RenderTab(true);
  _.ChangeTab(0);
}
MailTool={checkEmail:function(A){
    if(typeof A!="string"){
      return false;
    }
    A=$.trim(A);
    var B=new RegExp("^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$","i"),_=B.test(A);
    return _;
  },checkEmailText:function(_){
    if(typeof _!="string"){
      return false;
    }
    _=$.trim(_);
    if(this.checkEmail(_)){
      return true;
    }
    var B=new RegExp("^(?:\"[^\"]*\"\\s?|[^<>;,\uff0c\uff1b\"]*)<([^<>\\s]+)>$"),A=_.match(B);
    if(A){
      if(this.checkEmail(A[1])){
        return true;
      }else {
        return false;
      }
    }
    return false;
  },getDomain:function(_){
    if(typeof _!="string"){
      return "";
    }
    _=$.trim(_);
    if(this.checkEmail(_)){
      return _.split("@")[1].toLowerCase();
    }else {
      if(this.checkEmailText(_)){
        return _.match(/@([^@]+)>$/)[1].toLowerCase();
      }else {
        return "";
      }
    }
  },getAccount:function(_){
    if(typeof _!="string"){
      return "";
    }
    _=$.trim(_);
    if(this.checkEmail(_)){
      return _.split("@")[0];
    }else {
      if(this.checkEmailText(_)){
        return _.match(/<([^@<>]+)@[^@<>]+>$/)[1];
      }else {
        return "";
      }
    }
  },getName:function(_){
    if(typeof _!="string"){
      return "";
    }
    _=$.trim(_);
    if(this.checkEmail(_)){
      return _.split("@")[0];
    }else {
      if(this.checkEmailText(_)){
        var A=_.replace(/<[^@<>]+@[^@<>]+>$/,"");
        A=$.trim(A.replace(/"/g,""));
        if(A==""){
          return MailTool.getAccount(_);
        }
        return A;
      }else {
        return "";
      }
    }
  },getAddr:function($){
    if(MailTool.checkEmailText($)){
      return MailTool.getAccount($)+"@"+MailTool.getDomain($);
    }
    return "";
  },compareEmail:function(_,A){
    var $=MailTool.getAddr(_).toLowerCase();
    if($&&$==MailTool.getAddr(A).toLowerCase()){
      return true;
    }
    return false;
  },parse:function(B){
    var _={};
    _.error="";
    if(typeof B!="string"){
      _.error="\u53c2\u6570\u4e0d\u5408\u6cd5";
      return _;
    }
    var D=B.split(/[;,，；]/),C=_.emails=[];
    for(var E=0;E<D.length;E++){
      var A=$.trim(D[E]);
      if(A==""){
        continue ;
      }
      if(this.checkEmail(A)){
        C.push(A);
      }else {
        if(this.checkEmailText(A)){
          C.push(A);
        }else {
          _.error="\u90ae\u4ef6\u5730\u5740\u4e0d\u5408\u6cd5:\u201c"+A+"\u201d";
        }
      }
    }
    if(!_.error){
      _.success=true;
    }else {
      _.success=false;
    }
    return _;
  },is139Email:function($){
    var _=this.getDomain($);
    if(_===(top.mailDomain||"139.com")){
      return true;
    }
    return false;
  },is139NumberEmail:function(_){
    var $=this.is139Email(_);
    if($){
      return /^\d{11}$/.test(this.getAccount(_));
    }
    return false;
  },getSendText:function($,_){
    if(!Utils.isString($)||!Utils.isString(_)){
      return "";
    }
    return "\""+$.replace(/[\s;,；，<>"]/g," ")+"\"<"+_.replace(/[\s;,；，<>"]/g,"")+">";
  },splitAddr:function($){
    var A=$.split(/[,;；，]/);
    for(var C=0;C<A.length;C++){
      var _=A[C];
      if(_.indexOf("\"")>-1&&_.indexOf("\"")==_.lastIndexOf("\"")){
        var B=A[C+1];
        if(B&&B.indexOf("\"")==B.lastIndexOf("\"")){
          A[C]=_+" "+B;
          A.splice(C+1,1);
          C--;
        }
      }
    }
    return A;
  }};
NumberTool={add86:function($){
    if(typeof $!="string"){
      $=$.toString();
    }
    return $.trim().replace(/^(?:86)?(?=\d{11}$)/,"86");
  },remove86:function($){
    if(typeof $!="string"){
      $=$.toString();
    }
    return $.trim().replace(/^86(?=\d{11}$)/,"");
  },isChinaMobileNumber:function($){
    $=$.toString();
    if($.length!=13&&$.length!=11){
      return false;
    }
    if($.length==11){
      $="86"+$;
    }
    var _=new RegExp(top.UserData.regex);
    return _.test($);
  },isChinaMobileNumberText:function($){
    if(/^\d+$/.test($)){
      return this.isChinaMobileNumber($);
    }
    var _=/^(?:"[^"]*"|[^"<>;,；，]*)\s*<(\d+)>$/,B=$.match(_);
    if(B){
      var A=B[1];
      return this.isChinaMobileNumber(A);
    }else {
      return false;
    }
  },getName:function($){
    if(this.isChinaMobileNumberText($)){
      if($.indexOf("<")==-1){
        return "";
      }else {
        return $.replace(/<\d+>$/,"").replace(/^["']|["']$/g,"");
      }
    }
    return "";
  },getNumber:function(A){
    if(this.isChinaMobileNumberText(A)){
      if(A.indexOf("<")==-1){
        return A;
      }else {
        var $=/<(\d+)>$/,_=A.match($);
        if(_){
          return _[1];
        }else {
          return "";
        }
      }
    }
    return "";
  },compareNumber:function($,_){
    if(typeof ($)==="undefined"||typeof (_)==="undefined"){
      return false;
    }
    $=$.toString();
    _=_.toString();
    $=this.remove86(this.getNumber($));
    _=this.remove86(this.getNumber(_));
    if($&&$==_){
      return true;
    }
    return false;
  },parse:function(B){
    var _={};
    _.error="";
    if(typeof B!="string"){
      _.error="\u53c2\u6570\u4e0d\u5408\u6cd5";
      return _;
    }
    var D=B.split(/[;,，；]/),C=_.numbers=[];
    for(var E=0;E<D.length;E++){
      var A=$.trim(D[E]);
      if(A==""){
        continue ;
      }
      if(this.isChinaMobileNumberText(A)){
        C.push(A);
      }else {
        _.error="\u8be5\u53f7\u7801\u4e0d\u662f\u6b63\u786e\u7684\u79fb\u52a8\u624b\u673a\u53f7\u7801\uff1a\u201c"+A+"\u201d";
      }
    }
    if(!_.error){
      _.success=true;
    }else {
      _.success=false;
    }
    return _;
  },getSendText:function($,_){
    if(!Utils.isString($)||!Utils.isString(_)){
      return "";
    }
    return "\""+$.replace(/[\s;,；，<>"]/g," ")+"\"<"+_.replace(/\D/g,"")+">";
  }};
var __DateTool={daysOfMonth:function(_){
    if(!_){
      _=new Date();
    }
    var $=this.isLeapYear(_.getFullYear());
    return [31,($?29:28),31,30,31,30,31,31,30,31,30,31][_.getMonth()];
  },isLeapYear:function($){
    if(!$){
      $=new Date();
    }
    if($.getFullYear){
      $=$.getFullYear();
    }
    return ($%400==0||($%4==0&&$%100!=0));
  },WEEKDAYS:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],getWeekDayText:function($){
    if(!$){
      $=new Date();
    }
    return this.WEEKDAYS[$.getDay()];
  }};
if(!window.DateTool){
  DateTool=__DateTool;
}
function GroupCheckbox(A,G){
  if(!A){
    return ;
  }
  G=G||document;
  A.style.visibility="hidden";
  A.innerHTML="<ul class=\"group\"></ul><a href=\"javascript:;\"><i class=\"plus\"></i>\u65b0\u5efa\u5206\u7ec4</a>";
  var F=A.firstChild,E=G.createElement("LABEL"),J=G.createElement("INPUT");
  J.type="checkbox";
  E.appendChild(J);
  E.appendChild(G.createTextNode(" "));
  J=G.createElement("LI");
  J.appendChild(E);
  E=null;
  var B=G.createElement("LI");
  B.innerHTML="<span>\u9ed8\u8ba4\u4fdd\u5b58\u5230 &quot;\u672a\u5206\u7ec4&quot;</span>";
  F.appendChild(B);
  var I=top.Contacts.data.groups;
  for(var D=I.length-1,C=I[D];D>=0;C=I[--D]){
    var H="Chk_"+C.GroupId;
    B=J.cloneNode(true);
    E=B.firstChild;
    E["for"]=H;
    E.replaceChild(G.createTextNode(C.GroupName),E.lastChild);
    E=E.firstChild;
    E.id=H;
    E.value=C.GroupId;
    F.appendChild(B);
  }
  J=null;
  B=null;
  E=null;
  A.style.visibility="visible";
  var $=A.lastChild;
  $.onclick=function(){
    var D=top.Contacts,I=top.frameworkMessage,F=top.FF,C=G.createElement("INPUT"),E=G.createElement("A"),B=G.createElement("A"),H=I.addGroupTitle;
    $.style.display="none";
    C.value=H;
    C.maxLength=16;
    C.className="text gp def";
    E.href="javascript:void(0)";
    B.href="javascript:void(0)";
    B.style.marginLeft=".5em";
    E.innerHTML="\u6dfb\u52a0";
    B.innerHTML="\u53d6\u6d88";
    C.onfocus=function(){
      if(this.value==H){
        this.value="";
        this.className="text gp";
      }else {
        this.select();
      }
    };
    C.onblur=function(){
      if(this.value.length==0){
        this.value=H;
        this.className="text def gp";
      }
    };
    E.onclick=function(){
      var A=C.value;
      if(A.length>0&&A!=H){
        var $=this;
        D.addGroup(A,function(D){
          if(D.success){
            var E=$.parentNode,H=E.getElementsByTagName("UL")[0],C=G.createElement("LI");
            C.innerHTML="<label for='Chk_"+D.groupId+"'><input id='Chk_"+D.groupId+"' value='"+D.groupId+"' type='checkbox' checked='checked' />"+_(A)+"</label>";
            H.appendChild(C);
            H.scrollTop=H.scrollHeight;
            B.onclick();
          }else {
            F.alert(D.msg);
          }
        });
      }
    };
    B.onclick=function(){
      A.removeChild(C);
      A.removeChild(E);
      A.removeChild(B);
      $.style.display="inline";
    };
    A.appendChild(C);
    A.appendChild(E);
    A.appendChild(B);
  };
  this.container=F;
  this.check=function(C){
    var B=this.container.getElementsByTagName("INPUT");
    if(C){
      A(B,function(_){
        _.checked=$(_.value);
      });
    }else {
      var _=[];
      A(B,function($){
        $.checked&&_.push($.value);
      });
      return _;
    }
    function A($,_){
      for(var B=0,A=$.length;B<A;B++){
        _($[B]);
      }
    }
    function $($){
      for(var A=0,_=B.length;A<_;A++){
        if(B[A]==$){
          return true;
        }
      }
      return false;
    }
  };
  function _($){
    return $.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/ /g,"&nbsp;");
  }
}
if(typeof caixun=="undefined"){
  caixun=cx={};
}
cx.$=function($){
  if(typeof $=="undefined"){
    return null;
  }
  try{
    var A=document.getElementById($);
    if(A==null){
      A=window.top.document.getElementById("welcome").contentWindow.document.getElementById($);
    }
    return A;
  }
  catch(_){
    return null;
  }
};
cx.show=function($,B){
  var A=document.getElementById($);
  if(typeof (A)!="object"){
    return ;
  }
  try{
    if(B){
      A.style.display="";
    }else {
      A.style.display="none";
    }
  }
  catch(_){
  }
};
var Class={create:function(){
    return function(){
      this.initialize.apply(this,arguments);
    };
  },extend:function(_,$){
    for(property in $){
      _[property]=$[property];
    }
    return _;
  }},Extend=function(A,$){
  for(var _ in $){
    A[_]=$[_];
  }
},Extend=function(A,$){
  for(var _ in $){
    A[_]=$[_];
  }
},ARROW_HEIGHT=20,ARROW_WIDTH=20,dialogBoxGuide=Class.create();
dialogBoxGuide.prototype={initialize:function(C,B,A){
    var $=this.getDefaultOption();
    this.arrOptions=new Array();
    if(typeof (B)=="undefined"){
      B=0;
    }
    if(typeof (A)=="undefined"){
      A=0;
    }
    this.iframeLeft=B;
    this.iframeTop=A;
    this.index=0;
    for(var _=0;_<C.length;_++){
      this.arrOptions[_]=this.getDefaultOption();
      this.setOptions(C[_],_);
      this.arrOptions[_].isShowBackDiv=!!this.arrOptions[_].isShowBackDiv;
      this.arrOptions[_].isUserHTML=!!this.arrOptions[_].isUserHTML;
      this.repair(this.arrOptions[_]);
    }
  },setOptions:function(_,$){
    Extend(this.arrOptions[$],_||{});
  },getDefaultOption:function(){
    return {isShowBackDiv:false,isUserHTML:false,title:"",titleCss:"",description:"",descriptionCss:"",OKBttonHTML:"",onOKEvent:"",onCloseEvnet:"",target:{id:"",direction:"center"},HTML:"",dialogCss:"",isFrameDom:true,dialogOffset:{left:0,top:0},arrowOffset:{left:0,top:0}};
  },repair:function(B){
    var _=B.target;
    if(typeof (_.id)!="object"){
    }
    var $=_.direction.toLowerCase()+",",A="top,bottom,left,right,center,last,";
    if(A.indexOf($)==-1){
      _.direction="center";
    }
  },show:function(){
    if(this.index>=this.arrOptions.length){
      return ;
    }
    var H=document,$=H.createElement("div");
    $.id="dialogBox";
    $.className="intoTips";
    var G=this.arrOptions[this.index].dialogCss;
    if(G!=""){
      $.className=$.className+" "+G;
    }
    if(this.arrOptions[this.index].isUserHTML){
      $.innerHTML=this.arrOptions[this.index].HTML;
    }else {
      var I=new Array(),D=this.arrOptions[this.index].target.direction.toLowerCase(),_="",C="";
      switch(D){
      case "center":
        C="h1";
        break ;
      case "top":
        C="h5";
        _="forTop";
        break ;
      case "right":
        C="h5";
        _="forRight";
        break ;
      case "bottom":
        C="h5";
        _="forBottom";
        break ;
      case "left":
        C="h5";
        _="forLeft";
        break ;
      case "last":
        C="h2";
        break ;
      default:
        break ;
      }
      I.push("<"+C);
      if(this.arrOptions[this.index].titleCss!=""){
        I.push(" class=\""+this.arrOptions[this.index].titleCss+"\"");
      }
      I.push(">");
      I.push(this.arrOptions[this.index].title);
      I.push("</"+C+">");
      if(D!="center"){
        I.push("<p id=\"desc\"");
        if(this.arrOptions[this.index].descriptionCss!=""){
          I.push(" class=\""+this.arrOptions[this.index].descriptionCss+"\"");
        }
        I.push(">");
        I.push(this.arrOptions[this.index].description);
        I.push("</p>");
      }
      if(this.arrOptions[this.index].OKBttonHTML!=""){
        I.push(this.arrOptions[this.index].OKBttonHTML);
      }else {
        I.push("<a href=\"#\"   id=\"btnIknow\">\u770b\u4e0b\u4e00\u4e2a\u529f\u80fd >></a>");
      }
      I.push("<div class=\"closeWindow\" id=\"btnCloseDialogBox\" title=\"\u5173\u95ed\">\u5173\u95ed</div>");
      if(_!=""){
        I.push("<div class=\""+_+"\" id=\"arrow\" >forThis</div>");
      }
      $.innerHTML=I.join("");
    }
    (this.arrOptions[this.index].container||H.body).appendChild($);
    $.style.position="absolute";
    $.style.display="none";
    $.style.zIndex="99999";
    var F=this.arrOptions[this.index].target,E=this.arrOptions[this.index].dialogOffset,B=this.arrOptions[this.index].arrowOffset;
    if(F.id==null){
      F.direction="center";
    }
    try{
      (function(_){
        var $=_;
        cx.$("btnCloseDialogBox").onclick=function(){
          $.closeDialog();
          top.Utils.stopEvent();
        };
      })(this);
      (function(_){
        var $=_;
        cx.$("btnIknow").onclick=function(){
          $.nextDialog();
        };
      })(this);
    }
    catch(A){
    }
    if(F.direction=="last"){
      F.direction="center";
    }
    this.setPosition(F.direction,$,F.id,E,B);
    if(this.arrOptions[this.index].isShowBackDiv){
      Glass.show();
    }else {
      Glass.hide();
    }
    $.style.display="block";
  },setPosition:function(C,N,K,J,H){
    K=cx.$(K);
    var L=0,O=0;
    if(K!=null){
      if(this.arrOptions[this.index].isFrameDom){
        L=$(K).offset().left+this.iframeLeft;
        O=$(K).offset().top+this.iframeTop;
      }else {
        L=$(K).offset().left;
        O=$(K).offset().top;
      }
    }
    var _=document.body,A=cx.$("arrow");
    switch(C.toLowerCase()){
    case "left":
      var D=L+$(K).outerWidth(),B=$(K).outerHeight()/2,F=O-parseInt($(N).outerHeight()/2)+$(K).outerHeight()/2;
      if(F<0){
        F=0;
      }
      if(F>I){
        F=I;
      }
      N.style.left=(D+ARROW_WIDTH)+"px";
      N.style.top=F+"px";
      if(A!=null){
        A.style.top=(O-F-ARROW_HEIGHT/2)+H.top+"px";
      }
      break ;
    case "right":
      D=L-$(N).outerWidth(),B=$(K).outerHeight()/2,F=O-parseInt($(N).outerHeight()/2)+$(K).outerHeight()/2;
      if(F<0){
        F=0;
      }
      var I=$(_).scrollTop()+$(_).outerHeight()-$(N).outerHeight();
      if(F>I){
        F=I;
      }
      N.style.left=(D-ARROW_WIDTH)+"px";
      N.style.top=F+"px";
      if(A!=null){
        A.style.top=(O-F)+H.top+"px";
      }
      break ;
    case "center":
      N.style.left=($(_).outerWidth()/2-parseInt($(N).outerWidth())/2)+"px";
      N.style.top=($(_).outerHeight()/2-parseInt($(N).outerHeight())/2)+"px";
      break ;
    case "top":
      var M=$(K).outerWidth()/2,D=L-$(N).outerWidth()/2+M;
      if(D<0){
        D=10;
      }
      var E=$(_).scrollLeft()+$(_).outerWidth()-($(N).outerWidth());
      if(D>E){
        D=E-80;
      }
      N.style.left=D+"px";
      var G=0;
      N.style.top=(O+$(K).outerHeight())+ARROW_HEIGHT+"px";
      if(A!=null){
        A.style.left=((L-D)+M/2)+H.left+"px";
      }
      break ;
    case "bottom":
      M=$(K).outerWidth()/2,D=L-$(N).outerWidth()/2+M;
      if(D<0){
        D=10;
      }
      E=$(_).scrollLeft()+$(_).outerWidth()-($(N).outerWidth());
      if(D>E){
        D=E-80;
      }
      N.style.left=D+"px";
      N.style.top=(O-ARROW_HEIGHT-$(N).outerHeight()-$(K).outerHeight()/2)+"px";
      if(A!=null){
        A.style.left=(L-D)+M/2+H.left+"px";
      }
      break ;
    default:
    }
  },closeDialog:function(_){
    var $=cx.$("dialogBox");
    if($!=null){
      $.style.display="none";
      Glass.hide();
    }
    if(!_){
      if("undefined"!=typeof this.arrOptions[this.index]&&typeof (this.arrOptions[this.index].onCloseEvnet)=="function"){
        this.arrOptions[this.index].onCloseEvnet();
      }
    }
    $&&$.parentNode.removeChild($);
  },nextDialog:function(){
    if(typeof (this.arrOptions[this.index].onOKEvent)=="function"){
      this.arrOptions[this.index].onOKEvent();
    }
    var $=cx.$("dialogBox");
    $.parentNode.removeChild($);
    this.index++;
    this.show();
  }};
if(window.$){
  $.loadXML=function(_,B,A){
    $.ajax({type:"get",url:_,data:B,async:true,dataType:"html",success:function($){
        var _=parseXML($);
        A(_);
      }});
  };
  $.postForm=function(B,A,C){
    var _=getForm(A);
    $.post(B,_,C,null);
  };
}
function parseXML(B){
  var _,A;
  B=B.replace(/[^\]]\]><!--a-->/ig,"]]><!--a-->");
  if(jQuery.browser.msie){
    _=new ActiveXObject("MSXML.DOMDocument");
    _.loadXML(B);
  }else {
    var $=new DOMParser(),_=$.parseFromString(B,"text/xml");
  }
  A=_.documentElement;
  if(A!=null){
    var C;
    if(A.nodeName=="parsererror"||A.nodeName=="html"){
      C=new Object;
      C.error=B;
      if(checkLogout(B)){
        return null;
      }
    }else {
      C=xml2array(A);
    }
    return C;
  }else {
    C=new Object;
    C.error=B;
    if(checkLogout(B)){
      return null;
    }
    return C;
  }
}
function checkLogout($){
  if($.indexOf("\u767b\u5f55\u8d85\u65f6")>0||$.indexOf("\u91cd\u65b0\u767b\u5f55")>0){
    window.top.document.write($);
    window.top.document.close();
    return true;
  }else {
    if($.indexOf("\u975e\u6cd5\u8bf7\u6c42")>0){
    }
  }
}
function xml2array(B){
  var D=new Array();
  for(var G=0;G<B.childNodes.length;G++){
    var _=B.childNodes[G];
    if(_.nodeName.charAt(0)!="#"){
      var $=new Array();
      D[_.nodeName]=$;
      for(var A=0;A<_.childNodes.length;A++){
        var H=_.childNodes[A];
        if(H.nodeName.charAt(0)!="#"){
          var I=new Array();
          $.push(I);
          for(var C=0;C<H.childNodes.length;C++){
            var E=H.childNodes[C];
            if(E.nodeName.charAt(0)!="#"){
              if(E.childNodes.length>0){
                var J=E.childNodes[0].nodeName,F;
                if(J=="#text"||J=="#cdata-section"){
                  F=E.childNodes[0].nodeValue;
                  I[E.nodeName]=F;
                }else {
                  if(J="#comment"){
                    F=E.childNodes[0].nodeValue.replace(/\[CDATA\[/ig,"").replace(/\]\]/ig,"");
                    I[E.nodeName]=F;
                  }
                }
              }else {
                I[E.nodeName]=null;
              }
            }
          }
        }
      }
    }
  }
  return D;
}
function postByFrame(H,F,E){
  var D=$("<form method='post' action='{0}' target='iframe_post'></form>".format(H)).appendTo(document.body),C=$("#iframe_post");
  if(C.length==0){
    C=$("<iframe style='display:none' name='iframe_post' id='iframe_post'></iframe>").appendTo(document.body);
  }
  for(var A in F){
    var G=document.createElement("input");
    G.name=A;
    G.type="hidden";
    G.value=F[A];
    D.append(G);
  }
  C.load(_);
  try{
    D[0].submit();
  }
  catch(B){
    C.unbind("load",_);
    C.load(function(){
      C.unbind("load",arguments.callee);
      C.load(_);
      D[0].submit();
    });
    C.attr("src",top.stylePath+"/empty.htm");
  }
  function _(){
    C.unbind("load",arguments.callee);
    var $="";
    try{
      $=C[0].contentWindow.document.documentElement.innerHTML;
    }
    catch(_){
    }
    if(E){
      E($);
    }
    D.remove();
  }
}
function getForm(_){
  var A=_.getElementsByTagName("input"),B=_.getElementsByTagName("textarea"),$=new Object;
  $=getTagValue($,A);
  $=getTagValue($,B);
  return $;
}
function getTagValue($,_){
  for(elem in _){
    var A=_[elem];
    if(A.tagName==undefined){
      continue ;
    }
    if(A.tagName.toLowerCase()=="input"){
      var B=A.name;
      if(A.type=="text"||A.type=="hidden"){
        $[B]=A.value;
      }else {
        if(A.type=="checkbox"){
          if(A.checked){
            $[B]=A.value;
          }
        }
      }
    }else {
      if(A.tagName.toLowerCase()=="textarea"){
        $[B]=A.value;
      }
    }
  }
  return $;
}
ContactsAttrCard={};
var ContactsAttrCardHtmlCode="<div style=\"z-index: 20; position: absolute; top: 160px; left: 354px; display: none; \" class=\"menuWrap w\" id=\"divContactsAttrCard\">  <div class=\"mPop\" style=\"width:342px; border:1px solid #b0b0b0;\">    <table width=\"100%\" class=\"attrCard\" id=\"attrCardPanel\">      <tbody>        <tr>          <td>            <span class=\"cotect_dir\"><i class=\"b2\">\u25c6</i><i class=\"o2\">\u25c6</i></span>            <span class=\"cotect_dir2\"><i class=\"b\">\u25c6</i><i class=\"o\">\u25c6</i></span>            <div class=\"short\" id=\"usrInfoArea\">             <h2>             <b rel=\"name\"></b>             <i rel=\"vip\" command=\"opSingleVipc\" behavior=\"\" title=\"\" style=\"top:1px;cursor:pointer;display:none;\"></i>             </h2>             <div class=\"mb5\"><a class=\"fe c_666\" command=\"gotoCompose\" href=\"javascript:;\" rel=\"email\" title=\"\u53d1\u90ae\u4ef6\"></a></div>             <div class=\"mb5\"><a style=\"display:none\" command=\"gotoSMS\" href=\"javascript:;\" class=\"fe c_666\" rel=\"mobile\" title=\"\u53d1\u77ed\u4fe1\"></a></div>            </div>            <div class=\"getMail\">              <table>                <tbody>                  <tr style=\"cursor:pointer\">                    <td style=\"border-left:none;\">{0}</td>                    <td><em command=\"gotoCompose\" class=\"fcI\" behavior=\"\u5c5e\u6027\u5361-\u53d1\u90ae\u4ef6\">\u53d1\u90ae\u4ef6</em></td>                    <td><em command=\"gotoSMS\" class=\"fcI\" behavior=\"\u5c5e\u6027\u5361-\u53d1\u77ed\u4fe1\">\u53d1\u77ed\u4fe1</em></td>                    <td style=\"border-right:none;\" rel=\"moreTd\" command=\"gotomore\" behavior = \"\u8054\u7cfb\u4eba\u9875\u5361-\u66f4\u591a\" ><em  class=\"fcI\" command=\"gotomore\" behavior = \"\u8054\u7cfb\u4eba\u9875\u5361-\u66f4\u591a\" >  \u66f4\u591a   </em><i class=\"contact_more\" command=\"gotomore\" behavior = \"\u8054\u7cfb\u4eba\u9875\u5361-\u66f4\u591a\" ></i></td>                  </tr>                </tbody>              </table>              <ul  id= \"moreLinksInGetMail\" rel = \"moreLinksInGetMail\" class=\"toolBar_listMenu contact_listMeau\" style=\"display:none; position:absolute;left:343px;top:49px; top:58px\\0;border:1px solid #b0b0b0;\">                <li ><a href=\"javascript:void(0);\" command=\"gotoMailFilter\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u8bbe\u7f6e\u90ae\u4ef6\u5206\u62e3\"><em command=\"gotoMailFilter\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u8bbe\u7f6e\u90ae\u4ef6\u5206\u62e3\">\u8bbe\u7f6e\u90ae\u4ef6\u5206\u62e3</em></a></li>                <li><a href=\"javascript:void(0);\" command=\"addTag\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u8bbe\u7f6e\u81ea\u52a8\u6807\u7b7e\"><em command=\"addTag\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u8bbe\u7f6e\u81ea\u52a8\u6807\u7b7e\">\u8bbe\u7f6e\u81ea\u52a8\u6807\u7b7e</em></a></li>                <li><a href=\"javascript:void(0);\" command=\"gotoMailNotify\" class=\"fcI\"><em  command=\"gotoMailNotify\" class=\"fcI\">\u8bbe\u7f6e\u90ae\u4ef6\u5230\u8fbe\u901a\u77e5</em></a></li>                <li><a href=\"javascript:void(0);\" command=\"spamMail\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u62d2\u6536\"><em command=\"spamMail\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u62d2\u6536\">\u62d2\u6536</em></a></li>                <li style=\"display:none;\" rel=\"inviteFriend\" ><a href=\"javascript:void(0);\" command=\"inviteFriend\" class=\"fcI\" ><em command=\"inviteFriend\" class=\"fcI\" >\u9080\u8bf7</em></a></li>                <li><a href=\"javascript:void(0);\" command=\"searchLetters\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u5f80\u6765\u90ae\u4ef6\"><em command=\"searchLetters\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u5f80\u6765\u90ae\u4ef6\">\u5f80\u6765\u90ae\u4ef6</em></a></li>                <li style=\"display:none;\" rel=\"gotoG3\"><a href=\"javascript:void(0);\" command=\"gotoG3\" class=\"fcI\" behavior=\"\u9875\u5361-G3\u901a\u8bdd\"><em command=\"gotoG3\" class=\"fcI\" behavior=\"\u9875\u5361-G3\u901a\u8bdd\">G3\u901a\u8bdd</em></a></li>              </ul>            </div></td>        </tr>      </tbody>    </table>  </div></div>";
ContactsAttrCard.show=function(A){
  clearTimeout(ContactsAttrCard.hidTimer);
  ContactsAttrCard.hide();
  if(!top.Contacts.data.contacts||!ContactsAttrCard.isSettingDataReady()){
    return ;
  }
  var I;
  if(I=document.getElementById("divContactsAttrCard")){
    I.parentNode.removeChild(I);
    ContactsAttrCard.element=null;
  }
  var C=top.Utils.parseSingleEmail(A.email).addr,J=top.Contacts.getContactsByEmail(C),H="";
  if(J[0]){
    H="<em command=\"editContacts\" class=\"fcI\" >\u7f16\u8f91</em>";
  }else {
    H="<em command=\"addContacts\" class=\"fcI\" behavior=\"\u8054\u7cfb\u4eba\u9875\u5361-\u52a0\u5230\u901a\u8baf\u5f55\">\u52a0\u5230\u901a\u8baf\u5f55</em>";
  }
  if(!ContactsAttrCard.element||!document.getElementById("divContactsAttrCard")){
    ContactsAttrCard.element=$(ContactsAttrCardHtmlCode.format(H)).appendTo(document.body);
    ContactsAttrCard.element.mouseout(function($){
      ContactsAttrCard.hide(true);
    }).mouseover(function($){
      clearTimeout(ContactsAttrCard.hidTimer);
    }).click(ContactsAttrCard.click);
    ContactsAttrCard.element.find("*[titleTip]").hover(ContactsAttrCard.hover.over,ContactsAttrCard.hover.out);
  }
  if(A.type=="email"){
    var F=A.email,G="",B=0,K,E=Utils.parseSingleEmail(F);
    F=E.addr;
    G=E.name;
    if(MailTool.is139NumberEmail(F)){
      K=F.split("@")[0];
    }
    var D=top.Contacts.getContactsByEmail(F);
    if(D){
      D=D[0];
    }
    if(!D){
      ContactsAttrCard.currentContacts={email:F,name:G,SerialId:B,mobile:K};
    }else {
      ContactsAttrCard.currentContacts={email:F,name:D.name,SerialId:D.SerialId,mobile:D.mobiles[0]||K};
    }
    ContactsAttrCard.currentContacts.thingid=A.host.getAttribute("thingid");
    try{
      ContactsAttrCard.showHTML(A.host,A.e);
    }
    catch(_){
    }
  }
};
ContactsAttrCard.canShow=function(){
  return Boolean(top.Contacts.isReady&&top.mailNotifySetting);
};
ContactsAttrCard.showHTML=function(A,B){
  this.OptSource=A.getAttribute("OptSource")/1;
  var O=ContactsAttrCard.element,Q=ContactsAttrCard.currentContacts,N=O.find("*[rel]");
  if(!ContactsAttrCard.isMailNotifyOn()){
    top.UserData.MailNotify.notifyType=4;
    N.filter("*[rel='mailNotify_setting']").attr("command","addWhiteList").attr("behavior","\u5c5e\u6027\u5361-\u6dfb\u52a0\u5230\u624b\u673a\u90ae\u4ef6\u767d\u540d\u5355");
  }else {
    if(!ContactsAttrCard.isMailNotifyFilterListOn()){
      if(this.OptSource==2){
        N.filter("*[rel='mailNotify_setting']").attr("behavior","\u90ae\u4ef6\u5217\u8868\u9875-\u8054\u7cfb\u4eba\u9875\u5361-\u70b9\u51fb\u90ae\u4ef6\u5230\u8fbe\u901a\u77e5");
      }else {
        if(this.OptSource==3){
          N.filter("*[rel='mailNotify_setting']").attr("behavior","\u8bfb\u4fe1\u9875-\u8054\u7cfb\u4eba\u9875\u5361-\u70b9\u51fb\u90ae\u4ef6\u5230\u8fbe\u901a\u77e5");
        }
      }
    }else {
      if(ContactsAttrCard.isMailNotifyWhiteListOn()){
        N.filter("*[rel='mailNotify_setting']").attr("command","addWhiteList").attr("behavior","\u5c5e\u6027\u5361-\u6dfb\u52a0\u5230\u624b\u673a\u90ae\u4ef6\u767d\u540d\u5355");
      }else {
        if(ContactsAttrCard.isMailNotifyBlackListOn()){
          N.filter("*[rel='mailNotify_setting']").attr("command","addBlackList").attr("behavior","\u5c5e\u6027\u5361-\u6dfb\u52a0\u5230\u624b\u673a\u90ae\u4ef6\u9ed1\u540d\u5355");
        }
      }
    }
  }
  if(!Q||!Q.email||!Q.name){
    return false;
  }
  this.isVip=0;
  this.groupId="";
  if(Q.SerialId){
    this.isVip=2;
    var L=top.Contacts.getVipInfo();
    if(L&&L.isExist){
      this.groupId=L.vipGroupId;
      var J=$.inArray(Q.SerialId,L.vipSerialIds.split(","));
      if(J>-1){
        this.isVip=1;
      }
    }
  }
  N.filter("*[rel='name']").text(Q.name).show();
  N.filter("*[rel='email']").text(Q.email).show();
  var H=N.filter("*[rel='vip']");
  if(this.isVip==1){
    H.addClass("user_vip").attr("behavior","\u8054\u7cfb\u4eba\u9875\u5361-\u70b9\u51fb\u53d6\u6d88VIP\u8054\u7cfb\u4eba").attr("title","\u53d6\u6d88\"VIP\u8054\u7cfb\u4eba\"").show();
  }else {
    if(this.isVip==2){
      H.addClass("user_gray_vip").attr("behavior","\u8054\u7cfb\u4eba\u9875\u5361-\u70b9\u51fb\u52a0\u4e3aVIP\u8054\u7cfb\u4eba").attr("title","\u6dfb\u52a0\"VIP\u8054\u7cfb\u4eba\",\u5176\u90ae\u4ef6\u5c06\u540c\u65f6\u6807\u8bb0\u4e3a\"VIP\u90ae\u4ef6\"").show();
    }
  }
  if(Q.email.indexOf("@139.com")==-1){
    N.filter("*[rel='inviteFriend']").show();
  }
  if(top.showG3Phone){
    N.filter("*[rel='gotoG3']").show();
  }
  if(Q.SerialId){
    if(Q.mobile){
      N.filter("*[rel='mobile']").show().text(Q.mobile);
    }else {
      N.filter("*[rel='addMobile']").show();
    }
  }else {
    N.filter("*[rel='addContacts']").show();
  }
  if(A.title){
    A.setAttribute("addr",A.title);
    A.title="";
  }
  A=$(A);
  this.mid=A.attr("mid");
  var S=A.offset(),E=S.top;
  if(S.top+O.height()>$(document.body).height()){
    E=E-O.height()-6;
    O.find("span.cotect_dir").hide();
    O.find("span.cotect_dir2").show();
  }else {
    E=E+A.height()+4;
    O.find("span.cotect_dir").show();
    O.find("span.cotect_dir2").hide();
  }
  if(this.OptSource==3){
    var D=$("#divContactsAttrCard").width(),R=$("#moreLinksInGetMail").width(),M="#mailHeaderWrapper_"+$(A).attr("mid"),G=$(M).width(),P=B.pageX-20,C=P+D-170,I=B.pageX-S.left,K=$(A).width();
    if(G<C){
      var F=G-D;
      P=F+170;
    }
    var _=D+P+R;
    if(_>G+170){
      $("#moreLinksInGetMail").css("left","-122px");
    }
    if(K-I<20){
      if(K>30){
        P=P-28;
      }else {
        P=P-K/3;
      }
    }
    var T=B.pageX-P-13;
    $("#attrCardPanel td:first-child span").css({"left":T});
    O.css({top:E,left:P,display:"block"});
  }else {
    O.css({top:E,left:S.left+A.width()/2-21-6,display:"block"});
  }
};
ContactsAttrCard.click=function($){
  var _=$.target.getAttribute("command");
  if(_&&ContactsAttrCard[_]){
    if($.target.getAttribute("rel")!="clickDonotHide"&&_!="gotomore"){
      ContactsAttrCard.hide();
    }
    if(_=="gotomore"){
      ContactsAttrCard[_]($);
    }else {
      ContactsAttrCard[_]();
    }
  }
  top.behaviorClick($.target,window);
  return false;
};
ContactsAttrCard.hover={over:function(A){
    var _=A.target.getAttribute("titleTip"),E=$(this).offset(),F=E.top,B=E.left;
    if(_){
      var D="<div class=\"comTip\" style=\"z-index:9999;padding-top:6px;padding-top:7px\x00\">                            <span class=\"comTip_dir2\" style=\"top:0;\">                                <i class=\"b2\" style=\"bottom:1px;\">\u25c6</i>                                <i class=\"o2\" style=\"bottom:0;\">\u25c6</i>                            </span>                            <span class=\"comMes\">"+_+"</span>                          </div>",C=$(D);
      ContactsAttrCard.element.after(C[0]);
      C.css({"top":F+$(this).height(),"left":B-$(this).width()});
    }
  },out:function($){
    ContactsAttrCard.element.next(".comTip").remove();
  }};
ContactsAttrCard.addMobile=function(){
  var _=ContactsAttrCard.currentContacts,$=ContactsAttrCard.element.find("div[rel='mobileEdit']");
  $.show();
  ContactsAttrCard.element.find("div[rel='addMobile'],div[rel='mobile']").hide();
  var A=$.find("input:text");
  if(_.mobile){
    A.val(_.mobile);
  }
  Utils.focusTextBox(A[0]);
};
ContactsAttrCard.isSettingDataReady=function(){
  return Boolean(top.mailNotifySetting);
};
ContactsAttrCard.loadMailNotifySetting=function(callback){
  var url=top.ucDomain+"/ServiceAPI/GetMailNotifyInfo.ashx?sid="+top.UserData.ssoSid+"&rnd="+Math.random(),jquery=top.getProxyJQuery();
  if(!jquery){
    Utils.waitForReady("top.getProxyJQuery()",function(){
      ContactsAttrCard.loadMailNotifySetting(callback);
    });
    return ;
  }
  jquery.get(url,function(json){
    try{
      var mailNotifySetting=eval(json);
      mailNotifySetting.whiteList=mailNotifySetting.whiteList==""?[]:mailNotifySetting.whiteList.split(",");
      mailNotifySetting.blackList=mailNotifySetting.blackList==""?[]:mailNotifySetting.blackList.split(",");
      top.mailNotifySetting=mailNotifySetting;
      if(callback){
        callback();
      }
    }
    catch(e){
    }
  });
};
ContactsAttrCard.hide=function($){
  if(ContactsAttrCard.element){
    if($){
      ContactsAttrCard.hidTimer=setTimeout(function(){
        ContactsAttrCard.element.hide();
      },300);
    }else {
      ContactsAttrCard.element.hide();
    }
  }
};
ContactsAttrCard.gotomore=function(C){
  $("#moreLinksInGetMail").bind("mouseleave",function(){
    $(this).hide();
  });
  var F=document.getElementById("usrInfoArea").offsetHeight,H={},G=navigator.userAgent.toLowerCase();
  if(window.ActiveXObject){
    H.ie=G.match(/msie ([\d.]+)/)[1];
  }
  if(H.ie<8){
    F+=1;
  }else {
    F+=6;
  }
  F+="px";
  var A=document.getElementById("attrCardPanel").offsetHeight,E=$(C.target).offset().top,_=$(document.body).height(),B=$("#moreLinksInGetMail").height();
  if(B+E>_){
    var D=A-B;
    D+="px";
    $("#moreLinksInGetMail").css("top",D);
  }else {
    $("#moreLinksInGetMail").css("top",F);
  }
  $("#moreLinksInGetMail").show();
};
ContactsAttrCard.gotoCompose=function(){
  var B=ContactsAttrCard.currentContacts,_=top.UserData.ssoSid,E="compose",A="\""+B.name+"\"<"+B.email+">";
  A=escape(A);
  var D=Math.random(),F=top.wmsvrPath2+"/float_compose.htm?sid={0}&type={1}&receiver={2}&rnd={3}";
  F=F.format(_,E,A,D);
  var C="<iframe id='float_compose' src={0} frameBorder='0' scrolling=no style='width:100%;height:{2}px;'></iframe>".format(F,null,267);
  FF.show(C,"\u53d1\u90ae\u4ef6",516,267,true,function(){
    var _=$("#float_compose");
    if(_&&_.length>0&&_[0].contentWindow.ifrClosed){
      _[0].contentWindow.ifrClosed();
    }else {
      FF.close();
    }
  });
};
ContactsAttrCard.gotoSMS=function(){
  var $=ContactsAttrCard.currentContacts,_="\""+$.name+"\"<"+$.mobile+">";
  top.Links.show("sms","&mobile="+($.mobile?escape(_):""));
};
ContactsAttrCard.gotoMMS=function(){
  var $=ContactsAttrCard.currentContacts;
  top.Main.setReplyMMSData({receivers:/\d/.test($.mobile)&&[$.mobile]||[]});
  top.Links.show("mms","&mmstype=diy&initData=replyMMSData");
  $=null;
};
ContactsAttrCard.addContacts=function(){
  var $=ContactsAttrCard.currentContacts,_="/addcontactsingle.htm";
  _+="?name={0}&email={1}&thingid={2}".format(escape($.name),$.email,$.thingid);
  FF.open("\u6dfb\u52a0\u8054\u7cfb\u4eba",_,"400","310");
};
ContactsAttrCard.addWhiteList=function(){
  var _=this,$=ContactsAttrCard.currentContacts;
  if(ContactsAttrCard.existWhiteList($.email,true)){
    FF.alert(top.ControlsMessage["ContactWhiteError"]);
    return ;
  }
  FF.confirm(top.ControlsMessage["ContactWhiteConfirm"],function(){
    ContactsAttrCard.addEmailFilterList("white",$.email,function($){
      if($.success){
        FF.alert($.msg);
        if(_.OptSource==2){
          top.addBehavior("\u90ae\u4ef6\u5217\u8868\u9875-\u8054\u7cfb\u4eba\u9875\u5361-\u6210\u529f\u8bbe\u7f6e\u624b\u673a\u90ae\u4ef6\u8fc7\u6ee4");
        }
      }else {
        FF.alert($.msg||top.ControlsMessage["ContactTryError"]);
      }
    });
  });
};
ContactsAttrCard.addEmailFilterList=function(type,addr,callback){
  var result={},url=top.ucDomain+"/ServiceAPI/GetMailNotifyInfo.ashx?sid="+top.UserData.ssoSid+"&open=true&maillist="+encodeURIComponent(addr)+"&rnd="+Math.random()+"&notifytype="+top.UserData.MailNotify.notifyType+"&filter="+(type=="white"?1:2);
  top.WaitPannel.show(top.ControlsMessage["ContactLoading"]);
  top.frames["ucProxy"].$.ajax({type:"GET",url:url,success:function(json){
      if(json.indexOf("whiteList")>0){
        top.WaitPannel.hide();
        result.success=true;
        result.msg="\u8bbe\u7f6e\u6210\u529f";
        var mailNotifySetting=eval(json);
        mailNotifySetting.whiteList=mailNotifySetting.whiteList==""?[]:mailNotifySetting.whiteList.split(",");
        mailNotifySetting.blackList=mailNotifySetting.blackList==""?[]:mailNotifySetting.blackList.split(",");
        top.mailNotifySetting=mailNotifySetting;
        if(callback){
          callback(result);
        }
      }else {
        fail();
      }
    },error:fail,timeout:10000});
  function fail(){
    top.WaitPannel.hide();
    result.success=false;
    result.msg="\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5";
    if(callback){
      callback(result);
    }
  }
};
ContactsAttrCard.addBlackList=function(){
  var _=this,$=ContactsAttrCard.currentContacts;
  if(ContactsAttrCard.existBlackList($.email,true)){
    FF.alert(top.ControlsMessage["ContactBlackError"]);
    return ;
  }
  FF.confirm(top.ControlsMessage["ContactBlackConfirm"],function(){
    ContactsAttrCard.addEmailFilterList("black",$.email,function($){
      if($.success){
        FF.alert($.msg);
        if(_.OptSource==2){
          top.addBehavior("\u90ae\u4ef6\u5217\u8868\u9875-\u8054\u7cfb\u4eba\u9875\u5361-\u6210\u529f\u8bbe\u7f6e\u624b\u673a\u90ae\u4ef6\u8fc7\u6ee4");
        }
      }else {
        FF.alert($.msg||top.ControlsMessage["ContactTryError"]);
      }
    });
  });
};
ContactsAttrCard.searchLetters=function(){
  top.MB.facileSearch(ContactsAttrCard.currentContacts.email);
};
ContactsAttrCard.gotoG3=function(){
  var $=this.currentContacts.mobile||"";
  Links.show("G3Phone","&outnum="+$);
};
ContactsAttrCard.searchSMS=function(){
};
ContactsAttrCard.saveMobileNumber=function(){
  var _=ContactsAttrCard.currentContacts,$=ContactsAttrCard.element.find("input:text").val().trim();
  if($==""){
    FF.alert(top.ControlsMessage["ContactMobileEmpty"]);
    return ;
  }
  if(!top.Validate.test("mobile",$)){
    FF.alert(top.ControlsMessage["ContactMobileError"]);
    return ;
  }
  top.Contacts.addContactsMobile(_.SerialId,$,function($){
    if($.success){
      FF.alert(top.ControlsMessage["ContactSaveSuccess"]);
    }else {
      FF.alert($.msg);
    }
  });
};
ContactsAttrCard.editContacts=function(){
  top.Links.show("addrContacts","&type=edit&id="+ContactsAttrCard.currentContacts.SerialId);
};
ContactsAttrCard.gotoMailNotify=function(){
  top.Links.show("mailnotify","&type=setFilter");
};
ContactsAttrCard.isMailNotifyOn=function(){
  return top.mailNotifySetting.open;
};
ContactsAttrCard.isMailNotifyFilterListOn=function(){
  return top.mailNotifySetting.filterType!=0;
};
ContactsAttrCard.isMailNotifyWhiteListOn=function(){
  return top.mailNotifySetting.filterType==1;
};
ContactsAttrCard.isMailNotifyBlackListOn=function(){
  return top.mailNotifySetting.filterType==2;
};
ContactsAttrCard.existWhiteList=function(A,$){
  var C=top.mailNotifySetting.whiteList;
  A=A.toLowerCase();
  for(var B=0;B<C.length;B++){
    var _=C[B].toLowerCase();
    if(!$&&_.indexOf("@")==0&&A.indexOf(_)>=0){
      return true;
    }else {
      if(_==A){
        return true;
      }
    }
  }
  return false;
};
ContactsAttrCard.existBlackList=function(B,$){
  var _=top.mailNotifySetting.blackList;
  B=B.toLowerCase();
  for(var C=0;C<_.length;C++){
    var A=_[C].toLowerCase();
    if(!$&&A.indexOf("@")==0&&B.indexOf(A)>=0){
      return true;
    }else {
      if(A==B){
        return true;
      }
    }
  }
  return false;
};
ContactsAttrCard.inviteFriend=function(){
  var _=ContactsAttrCard.currentContacts,$=_.email.toLowerCase();
  top.Links.show("invitebymail","&email="+$);
};
ContactsAttrCard.gotoMailFilter=function(){
  var E=ContactsAttrCard.currentContacts,C;
  if(typeof Array.prototype.filter=="function"){
    C=top.FM.folderList.filter(function($){
      return $.type!=5;
    });
  }else {
    C=$.grep(top.FM.folderList,function($){
      return $.type!=5;
    });
  }
  var B="setFilterFrame",D="",_="<div id=\"forWinSetFilter\" for =\"forWinSetFilter\"><iframe src=\"/setfilter.htm?name={0}&email={1}\" id=\"setFilterFrame\" name=\"setFilterFrame\" frameborder=\"0\" scrolling=\"no\" style=\"width:100%;height:165px;\"></iframe>"+"<iframe src=\"/setfiltersuc.htm\" id=\"setfiltersuc\" name=\"setfiltersuc\" frameborder=\"0\" scrolling=\"no\" style=\"width:100%;height:120px; display:none;\"></iframe>"+"<iframe src=\"/addfolderforcreatefilter.htm\" id=\"newFilterFrame\" name=\"newFilterFrame\" frameborder=\"0\" scrolling=\"no\" style=\"width:100%;height:151px; display:none;\"></iframe>"+"<ul id=\"filterToFloders\" class=\"toolBar_listMenu listMenu_bar\" style=\" position: absolute; z-index: 1109;display:none; width:205px; width:206px\\0;  *width:206px;top: 103px;left: 61px;border: 1px solid #b1b1b1;padding: 2px 0;\">";
  D+=_.format(escape(E.name),E.email);
  for(var F=0;F<C.length;F++){
    var A="<li id=\"{0}\" f_name = \"{1}\" ><a href=\"javascript:void(0);\"  style=\"width:205px;\" ><span>{1}</span></a></li>".format(C[F].fid,C[F].name);
    if(F==C.length-1){
      A="<li  id=\"{0}\" f_name = \"{1}\" ><a href=\"javascript:void(0);\" class=\"clasy_bd\"  style=\"width:205px;\" ><span>{1}</span></a></li>".format(C[F].fid,C[F].name);
    }
    D+=A;
  }
  D+="<li id=\"addFloder\"><a href=\"javascript:void(0);\" style=\"width:205px;\"><span>\u65b0\u5efa\u6587\u4ef6\u5939</span></a></li></ul></div>";
  FF.show(D,"\u521b\u5efa\u90ae\u4ef6\u5206\u62e3\u89c4\u5219");
};
ContactsAttrCard.addTag=function(){
  top.tagsUI.showAddTagPage(this.OptSource,true);
};
ContactsAttrCard.spamMail=function(){
  var A=this.mid,_=ContactsAttrCard.currentContacts.email.toLowerCase().decode();
  if(this.OptSource==3){
    ReadMailInfoTable[A].spamMail(true,_);
  }else {
    if(this.OptSource==2){
      var B="\u7cfb\u7edf\u4f1a\u5c06\u6b64\u90ae\u4ef6\u5730\u5740\u6dfb\u52a0\u5230\u9ed1\u540d\u5355\uff0c\u5e76\u5c06\u6b64\u90ae\u4ef6\u79fb\u5230\u5783\u573e\u90ae\u4ef6\u6587\u4ef6\u5939\u3002\u60a8\u5c06\u4e0d\u4f1a\u518d\u6536\u5230\u6765\u81ea\u6b64\u5730\u5740\u7684\u90ae\u4ef6\u3002<br />            \u60a8\u786e\u5b9a\u8981<span style='color:blue'>\u62d2\u6536\u6b64\u53d1\u4ef6\u4eba\u7684\u90ae\u4ef6</span>\u5417\uff1f",$={mid:A,email:_,msg:B};
      MB.spamMail(3,$);
    }
  }
};
ContactsAttrCard.opSingleVipc=function(){
  var _=this,D=_.currentContacts,B=D.SerialId,F=top.frameworkMessage;
  if(!B){
    return false;
  }
  var A={groupId:_.groupId,groupType:1,serialId:B};
  if(_.isVip==2){
    if(top.Contacts.IsPersonalEmail(B)){
      top.FF.alert(F.addNotAllowed);
      return false;
    }
    var $=10,G=top.Contacts.getVipInfo().vipn;
    if(G>=$){
      var C="<a hidefocus=\"\" href=\"javascript:top.Links.show('addrvipgroup'); top.FF.close();\" >\u7ba1\u7406VIP\u8054\u7cfb\u4eba</span></a>",E=F.vipContactsMax.format($,C);
      top.FF.alert(E);
      return false;
    }
    _.addSingleVipc(A);
  }else {
    if(_.isVip==1){
      top.FF.confirm(F.delConfirmMsg,function(){
        _.delSingleVipc(A);
      });
    }
  }
};
ContactsAttrCard.addSingleVipc=function($){
  var A=top.frameworkMessage;
  top.Contacts.AddGroupList($,_);
  function _(_){
    if(_.ResultCode!=0){
      if(_.resultCode==23){
        top.FF.alert(A.groupLimit);
        return false;
      }
      vipRetryFun(ContactsAttrCard.addSingleVipc,$);
      return false;
    }
    top.addBehavior("\u6210\u529f\u6dfb\u52a0VIP\u8054\u7cfb\u4eba");
    top.Contacts.updateCache("addVipContacts",$.serialId);
    top.GlobalEvent.broadcast("vipContactsOnChange");
    var B="\u201c"+Utils.htmlEncode(ContactsAttrCard.currentContacts.name)+"\u201d",C=A.editGroupListSuc.format(B);
    FF.alert(C,function(){
      MB.refresh();
    });
  }
};
ContactsAttrCard.delSingleVipc=function(A){
  var B=top.frameworkMessage;
  top.Contacts.DelGroupList(A,_);
  function _(_){
    if(_.ResultCode!=0){
      vipRetryFun(ContactsAttrCard.delSingleVipc,A);
      return false;
    }
    top.Contacts.updateCache("delVipContacts",A.serialId);
    FF.alert(B.opSuc,function(){
      if($("#divTab .on").attr("title")=="VIP\u90ae\u4ef6"){
        MB.search({vip:true,title:"VIP\u90ae\u4ef6"});
      }else {
        top.GlobalEvent.broadcast("vipContactsOnChange");
        MB.refresh();
      }
    });
  }
};
function vipRetryFun(B,A){
  var C=top.frameworkMessage;
  if(!top.VipRetryObj){
    top.VipRetryObj={retryFun:B,retryParam:A,retryCount:0};
  }
  var $=top.VipRetryObj;
  if($.retryCount>=3){
    top.VipRetryObj={retryFun:null,retryParam:null,retryCount:0};
    top.FF.alert(C.sysError);
  }else {
    $.retryFun=B;
    $.retryParam=A;
    var _=C.sysBusy+"<a hidefocus=\"\" href=\"javascript:retryClick();\">\u91cd\u8bd5</a>";
    top.FF.alert(_,function(){
      top.VipRetryObj={retryFun:null,retryParam:null,retryCount:0};
    });
  }
}
function retryClick(){
  var $=top.VipRetryObj;
  $.retryCount++;
  $.retryFun($.retryParam);
  top.FF.close();
}
if(window.$){
  $(document).mouseout(ContactsAttrCard_mouseout).mouseover(ContactsAttrCard_mouseover).click(ContactsAttrCard_click);
}
function ContactsAttrCard_click($){
  var _=($&&$.target)||window.event.srcElement;
  if(_.getAttribute("rel")!="clickDonotHide"){
    ContactsAttrCard.hide();
  }
}
function ContactsAttrCard_mouseout(_){
  var B=_.target;
  if(!B||!B.getAttribute){
    return ;
  }
  if(B.getAttribute("rel")=="showAddrCard"){
    var A=$(B).attr("nodeName").toLowerCase();
    if(A=="span"){
      $(B).parent().css("background-color","#FFF");
    }
    clearTimeout(ContactsAttrCard.showTimer);
    ContactsAttrCard.hide(true);
  }
}
function ContactsAttrCard_mouseover(_){
  var C=_.target;
  if(!C||!C.getAttribute){
    return ;
  }
  if(C.getAttribute("rel")=="showAddrCard"){
    var B=$(C).attr("nodeName").toLowerCase();
    if(B=="span"){
      $(C).parent().css("background-color","#DAE3EC");
    }
    var A=C.title||C.getAttribute("addr");
    if(!A){
      A=C.innerText||C.textContent;
    }
    if(!A||Utils.parseEmail(A).length==0){
      return ;
    }
    clearTimeout(ContactsAttrCard.showTimer);
    ContactsAttrCard.hide(true);
    ContactsAttrCard.showTimer=setTimeout(function(){
      ContactsAttrCard.show({type:"email",email:A,host:C,e:_});
    },800);
  }
}
function sendSuccess($){
  setTimeout(function(){
    FF.alert($);
  },100);
}
EditorManager={};
EditorManager.create=function(_){
  if(!_.container){
    return ;
  }
  var $=top.wmsvrPath2;
  if(_.version==2){
    $+="/editor2.0.htm?";
  }else {
    $+="/editor.htm?";
  }
  if(_.hidToolBar){
    $+="&hidToolBar=true";
  }
  if(_.onload){
    this.onload=_.onload;
  }
  if(_.imageButtonOnClick){
    window["_imageButtonOnClick"]=_.imageButtonOnClick;
    $+="&imageButtonOnClick=_imageButtonOnClick";
  }
  if(_.screenShotButtonOnClick){
    window["_screenShotButtonOnClick"]=_.screenShotButtonOnClick;
    $+="&screenShotButtonOnClick=_screenShotButtonOnClick";
  }
  if(_.showFace){
    $+="&showFace=true";
  }
  if(_.onload){
    this.onload=_.onload;
  }
  var A="<iframe name='theEditorFrame' id='theEditorFrame' style='width:100%;height:100%' frameBorder='0' scrolling='no' src='"+$+"'></iframe>";
  if(_.width){
    A=A.replace("width:100%","width:"+_.width.toString().replace(/(\d+)$/,"$1px"));
  }
  if(_.height){
    A=A.replace("height:100%","height:"+_.height.toString().replace(/(\d+)$/,"$1px"));
  }
  _.container.innerHTML=A;
  EditorManager.param=_;
};
EditorManager.getHtmlContent=function(){
  return window.frames["theEditorFrame"].theEditorBox.getHtmlContent();
};
EditorManager.setHtmlContent=function($){
  if(window.frames["theEditorFrame"].theEditorBox&&window.frames["theEditorFrame"].theEditorBox.setHtmlContent){
    return window.frames["theEditorFrame"].theEditorBox.setHtmlContent($);
  }
};
EditorManager.insertImage=function($){
  window.frames["theEditorFrame"].theEditorBox.insertImage($);
};
EditorManager.toggleToolBar=function(){
  var $=window.frames["theEditorFrame"];
  if($.toggleToolBar){
    $.toggleToolBar();
  }else {
    $.$("#toolbar").toggle();
  }
  $.resizeAll();
};
EditorManager.getHtmlToTextContent=function(){
  return window.frames["theEditorFrame"].theEditorBox.getHtmlToTextContent();
};
EditorManager.setHeight=function(A){
  A=A.toString().replace(/(?:px)?$/,"px");
  var B=EditorManager.param.container,_=B.getElementsByTagName("iframe")[0];
  B.style.heigth=A;
  _.style.height=A;
  try{
    _.contentWindow.resizeAll();
  }
  catch($){
  }
};
EditorManager.onload=function(){
};
var FormatTextarea=window.FormatTextarea=function($){
  return $?new FormatTextarea.fn.mainInit($):null;
};
FormatTextarea.fn=FormatTextarea.prototype={mainInit:function(_){
    if(!_||!_.input||!(_.input instanceof Object)){
      return this;
    }
    var A=_.input[0].scrollHeight;
    A=$.browser.msie?A:A-1;
    this.inputHeight=A;
    this.formatHanlder=null;
    this.whichCode=_.whichCode?parseInt(_.whichCode,10):(_.input.attr("which").trim()==""?188:parseInt(_.input.attr("which").trim(),10));
    this.whichCode=isNaN(this.whichCode)?188:this.whichCode;
    this.maxHeight=_.maxHeight?parseInt(_.maxHeight,10):(_.input.attr("maxHeight").trim()==""?188:parseInt(_.input.attr("maxHeight").trim(),10));
    this.maxHeight=isNaN(this.maxHeight)?188:this.maxHeight;
    this.splitStr=_.splitStr?_.splitStr:_.input.attr("whichChr").trim()==""?",":_.input.attr("whichChr").trim();
    this.regEvent(_);
    return this;
  },regEvent:function(_){
    if(!_||!_.input||!(_.input instanceof Object)){
      return this;
    }
    var B=this,A=false;
    _.input.keyup(function(C){
      if(C.which==13){
        if(_.input.val().replace(/\n/g,"")==""){
          _.input.val("");
          return false;
        }
        _.onlyEnter=true;
        B.calcTheHeigth(_);
        return false;
      }
      if(C.which!=16){
        if(C.which==B.whichCode&&!A){
          B.foramtContents({"input":$(this),"errList":[],"eventCode":C.which});
        }
        A=false;
      }else {
        A=true;
      }
    });
    _.input[0].onpaste=function(){
      B.foramtContents({"input":$(this),"errList":[]});
    };
    return this;
  },foramtContents:function formatLine(_){
    if(!_||!_.input||!(_.input instanceof Object)){
      return this;
    }
    var A=this;
    if(this.formatHanlder){
      clearTimeout(formatHanlder);
    }
    formatHanlder=setTimeout(function(){
      var E=_.input.val().trim();
      if(_.errList&&_.errList.length>0){
        E=_.errList.join(A.splitStr);
      }
      if(E!=""){
        var D=E.replace(/\n/gi,"").split(A.splitStr),C=D.length,B=[];
        $.each(D,function(D,_){
          if(D==(C-1)){
            B.push($.trim(_));
          }else {
            B.push($.trim(_)+A.splitStr+"\n");
          }
        });
        _.input.val(B.join(""));
        _.count=C;
        _.onlyEnter=false;
        A.calcTheHeigth(_);
        D=B=null;
      }
      if(_.callback){
        callback.call(A);
      }
    },800);
    return this;
  },calcTheHeigth:function(B){
    if(!B||!B.input||!(B.input instanceof Object)){
      return this;
    }
    var _=this.maxHeight;
    try{
      if(B.onlyEnter){
        _=B.input[0].scrollHeight;
        var C=B.input.val().replace(/\n\n/g,"\n");
        B.input.val(C);
      }else {
        if(B.count){
          _=parseInt(B.count>1?$.browser.msie?this.inputHeight*B.count-(B.count*3):this.inputHeight*B.count:this.inputHeight,10);
        }
      }
      if(_>=this.maxHeight){
        B.input.css({"overflow":"scroll","overflow-y":"scroll","overflow-x":"hidden"}).height(this.maxHeight);
      }else {
        B.input.height(_);
      }
    }
    catch(A){
      return this;
    }
    return this;
  }};
FormatTextarea.fn.mainInit.prototype=FormatTextarea.fn;
var colorPicker=Class.create();
colorPicker.itemClick=function(){
};
colorPicker.prototype={initialize:function($){
    this.options=this.getDefaultOption();
    this.setOptions($);
    colorPicker.itemClick=this.options.itemClick;
    this.options.template="<li onclick='colorPicker.getColor(\"$color\",this,$index)'><a  href='$url' target='_blank'>"+this.options.template+"</a></li>";
    this.repair();
  },setOptions:function($){
    Extend(this.options,$||{});
  },getDefaultOption:function(){
    return {width:250,containerID:"colorContainer01",targetID:"",itemClick:function(){
      },template:"<b class='tg' style='background:$color;'></b>",headerTitle:"",dataSource:[],cssFileName:"colorPicker.css"};
  },repair:function(){
    var $=this.options;
    if($.dataSource==null||$.dataSource.length==0){
    }
  },createContainer:function(){
    var $=this.options.containerID;
    elem=document.createElement("div");
    elem.id=$;
    elem.style.position="absolute";
    elem.style.zIndex="9999";
    elem.style.display="none";
    elem.style.width=this.options.width+"px";
    document.body.appendChild(elem);
    return elem;
  },show:function(A){
    if(typeof (A)=="undefined"){
      A=false;
    }
    var B=this.options.containerID,_=document.getElementById(B);
    if(_==null||_==undefined){
      _=this.createContainer();
    }else {
      if(_.innerHTML.length>0&&!A){
        $(_).fadeIn("normal");
        return ;
      }
    }
    if(A){
      _.innerHTML="";
    }
    this.reqeustCss();
    this.bindData(_);
    this.setPosition();
    $(_).fadeIn("normal");
    (function(_){
      _this=_;
      $(document).bind("click",function($){
        _this.hide();
      });
    })(this);
  },hide:function(){
    var A=this.options.containerID,_=document.getElementById(A);
    if(_!=null&&_.style.display!="none"){
      $("#"+A).fadeOut("normal");
    }
  },reqeustCss:function(){
    if(typeof (top.rmResourcePath)=="undefined"){
      top.rmResourcePath="http://image0.139cm.com/m/coremail";
    }
    var $=top.rmResourcePath+"/js/css/"+this.options["cssFileName"];
    Utils.requestCSS($);
  },setPosition:function(){
    var _;
    if(typeof (this.options.targetID)=="string"){
      _=document.getElementById(this.options.targetID);
    }else {
      _=this.options.targetID;
    }
    var B=Utils.findPosition(_),C=this.options.containerID,A=$("#"+C);
    A.css({left:(B[0]).toString()+"px",top:(B[1]+20).toString()+"px"});
  },bindData:function($){
    var _=new DataList($);
    _.Layout=0;
    _.ItemTemplate=this.options.template;
    _.DataSource=this.options.dataSource;
    _.DataBind();
  }};
colorPicker.getColor=function(_,A,$){
  colorPicker.itemClick(_,A,$);
  Utils.stopEvent();
};
subjectColorPicker=subjectCP=Class.create();
subjectCP.prototype=Class.extend(new colorPicker(),{createContainer:function(){
    var $=this.options.containerID;
    elem=document.createElement("div");
    elem.id=$;
    elem.style.position="absolute";
    elem.style.zIndex="9999";
    elem.style.display="none";
    elem.style.width=this.options.width+"px";
    document.body.appendChild(elem);
    return elem;
  }});
Utils.waitForReady("jQuery",function(){
  (function($){
    $.fn.blankText=function(){
      if(this.length<1){
        return this;
      }
      var _=arguments[0];
      if(_===""){
        $(this).unbind("focus").unbind("blur");
      }else {
        $(this).focus(function(){
          if(this.value==_){
            this.value="";
            this.style.color="";
          }
        }).blur(function(){
          if(this.value.length==0){
            this.value=_;
            this.style.color="#AAA";
          }
        });
        if(this.val()==""){
          this.val(_).css("color","#AAA");
        }
      }
    };
  })(jQuery);
  (function($){
    $.fn.dataset=function(){
      if(this.length<1){
        return "";
      }
      var C=arguments[0],_=arguments[1],A=!!window.DOMStringMap,B=null,$="data-";
      if(_!==undefined){
        if(A){
          for(var D=0;D<this.length;D++){
            this[D].dataset[C]=String(_);
          }
        }else {
          for(D=0;D<this.length;D++){
            this[D].setAttribute($+C,String(_));
          }
        }
        _=this;
      }else {
        _=[];
        for(D=0;D<this.length;D++){
          B=this[D];
          if(A){
            _.push(B.dataset[C]);
            continue ;
          }
          _.push(B.getAttribute($+C));
        }
        if(_.length==1){
          _=_[0];
        }
      }
      return _;
    };
  })(jQuery);
});
(function(_){
  var A=function(_){
    this.expandButton=_.expandButton;
    this.listContainer=_.listContainer;
    this.textField=_.textField;
    this.data=_.data;
    this.onItemCreate=_.onItemCreate;
    this.onItemClick=_.onItemClick;
    var B=this;
    $(B.expandButton).click(function(_){
      var C=$(B.listContainer).height(),D=$(this),A=C+D.offset().top+D.height(),E=A>$(document).height()?0-C-7:D.height();
      $(B.listContainer).css("top",E).show();
      _.stopPropagation();
    });
    $(document).click(function(_){
      $(B.listContainer).hide();
    });
    if(!$.isFunction(B.onItemCreate)){
      B.onItemCreate=function(){
      };
    }
    var A=[];
    for(var D=0,C=B.data.length;D<C;D++){
      A.push(B.onItemCreate(B.data[D],D,C));
    }
    B.listContainer.innerHTML=A.join("");
    $(B.listContainer).hide();
    A=null;
    A=[].concat(B.data);
    $(B.listContainer.childNodes).each(function(_){
      $(this).dataset("value",A.shift());
    });
    if(typeof (_.defaultValue)!="undefined"){
      B.textField.innerHTML=_.defaultValue;
    }
    $(B.listContainer.childNodes).click(function(_){
      B.textField.innerHTML=this.textContent||this.innerText;
      B.onItemClick(this,_);
      _.stopPropagation();
      $(B.listContainer).hide();
    });
    this.length=function(){
      return B.listContainer.childNodes.length;
    };
    this.value=function(A){
      if(typeof (A)=="undefined"){
        var _=B.textField.innerHTML;
        $(B.listContainer.childNodes).each(function(A){
          var $=this.textContent||this.innerText;
          if(_==$){
            return B.data[A];
          }
        });
      }else {
        $(B.listContainer.childNodes).each(function(_){
          if($(this).dataset("value")==A){
            B.textField.innerHTML=A;
          }
        });
      }
    };
  };
  _.selectlist=A;
})(Utils.UI);
function DualAddrList($){
  this.id=Math.floor(Math.random()*4026531839+268435456).toString(16);
  var A=DualAddrList.DEFAULT_CFG,_={};
  _.height=$.height||A.height;
  _.width=$.width||A.width;
  _.height=$.height||A.height;
  _.model=$.model||A.model;
  _.limit=$.limit||A.limit;
  this.param=_;
}
DualAddrList.MODELS_CONTACT=0;
DualAddrList.MODELS_EMAIL=1;
DualAddrList.MODELS_FAX=2;
DualAddrList.MODELS_MOBILE=3;
DualAddrList.DEFAULT_CFG={height:"100%",width:"100%",model:DualAddrList.MODELS_EMAIL,limit:Number.MAX_VALUE};
(function(A){
  var B=top.location,_=B.protocol+"//"+B.host+(B.port?":"+B.port:"");
  if(top.rmResourcePath){
    _=_+"/dualAddrList.htm";
  }else {
    _=_+top.stylePath+"/dualAddrList.htm";
  }
  A.create=function(B){
    var A=this.param,$=_+"?a=a"+"&model="+A.model;
    if(A.limit<Number.MAX_VALUE){
      $+="&limit="+A.limit;
    }
    var C=["<iframe name=\"dualAddrList_",this.id,"\" id=\"dualAddrList_",this.id,"\" style=\"border:none;width:",A.width,";height:",A.height,"\" frameBorder=\"0\" scrolling=\"no\" src=\"",$,"&sid=",top.UserData.ssoSid?top.UserData.ssoSid:"","\"></iframe>"].join("");
    B.innerHTML=C;
    A.container=B;
  };
  A.getCurrent=function(){
    var $=document.getElementById("dualAddrList_"+this.id);
    return $;
  };
  A.ready=function(A){
    var _=this.getCurrent(),$=setInterval(function(){
      try{
        A.call(_.contentWindow.AddressBook);
        clearInterval($);
      }
      catch(B){
      }
    },250);
  };
  A.getSelection=function(_){
    this.ready(function(){
      if($.isFunction(_)){
        _(this.GetSelection());
      }
    });
  };
  A.groupby=function($){
    this.ready(function(){
      this.GroupBy($);
    });
  };
  A.getSelectionString=function(_){
    this.getSelection(function(B){
      var A=[];
      for(var D=0,C=B.length;D<C;D++){
        A.push(B[D].SerialId);
      }
      if($.isFunction(_)){
        _(A.join(","));
      }
    });
  };
  A.empty=function(){
    this.ready(function(){
      this.Empty();
    });
  };
  A.selectAll=function(){
    this.ready(function(){
      this.SelectAll();
    });
  };
})(DualAddrList.prototype);
function tips(){
  this.init.apply(this,arguments);
}
tips.list={};
tips.prototype={options:{content:"\u65e0\u5185\u5bb9",width:220,maxHeight:60,direction:"deflaut",howShow:true},init:function(F,C){
    $.extend(this,this.options,F);
    this.win=C||window;
    this.elem=typeof this.id==="string"?$(C.document.getElementById(this.id)):this.id;
    var _=this.elem[0];
    if(!_){
      return ;
    }
    if(_&&(!("nodeName" in _))){
      return ;
    }
    var E=top.resourcePath;
    this.tipsContainer=$("<div style=\"height:auto;border:1px solid #e6d650;position:absolute;font-size:12px;margin-top:15px;zoom:1;\"></div>").hide().css({width:(this.width||this.options.width)+"px"});
    this.tipsContainer=$(C.document.createElement("div")).hide().css({"height":"auto","border":"1px solid #e6d650","position":"absolute","font-size":"12px","margin-top":"15px","zoom":1,"width":(this.width||this.options.width)+"px","z-index":1000});
    C.document.body.appendChild(this.tipsContainer[0]);
    this.tipsContainer.html("<div style=\"border:1px solid #fff;padding:10px;background:#fefddf\"><div style=\"position:absolute;left:12px;top:-6px;height:6px;width:9px;line-height:1px;font-size:1px;background:url("+E+"/images/arrow.gif) no-repeat;cursor:pointer;\"></div><div style=\"position:absolute;background:url("+E+"/images/cls.gif) no-repeat 0 0;top:6px;right:7px;height:8px;width:7px;line-height:12px;cursor:pointer\">&nbsp;</div><table height=\""+this.maxHeight+"\" border=\"0\"><tr><td width=\"30\" style=\"text-align:center;vertical-align:middle;\"></td><td valign=\"top\" style=\"padding-left:5px;line-height:16px;padding-top:10px;\"></td></tr></table></div>");
    var A=this.tipsContainer.find("div"),B=this;
    this.icoJ=A.eq(1);
    this.icoC=A.eq(2);
    this.imgSrc&&this.tipsContainer.find("td").eq(0).html("<img src=\""+top.resourcePath+this.imgSrc+"\" />");
    this.htmlContainer=this.tipsContainer.find("td").eq(1);
    this.htmlContainer.html(this.content);
    !this.howShow&&this.elem.bind("mouseover.tips",function(){
      B.show();
    });
    var D="tips_"+[0,"\u529f\u80fd\u63d0\u9192\u7c7b","\u529f\u80fd\u8bbe\u7f6e\u7c7b","\u529f\u80fd\u5f15\u5bfc\u7c7b"][B.data.type];
    this.icoC.bind("click",function(){
      B.tipsContainer[0].parentNode.removeChild(B.tipsContainer[0]);
      B.request();
      B.unbind();
      D=D+"2";
      top.addBehavior&&jQuery.isFunction(top.addBehavior)&&top.addBehavior(D,2);
    });
    this.htmlContainer.bind("click.tips",function(A){
      var $=A.target,C=A.target.nodeName.toLocaleLowerCase();
      if(C==="a"){
        B.unbind();
        B.request();
        D=D+"1";
        top.addBehavior&&jQuery.isFunction(top.addBehavior)&&top.addBehavior(D,1);
        var _=top.resourcePath;
        if("operate" in B.data){
          var E={"0":function(){
              return ;
            },"1":function(){
              LinksConfig.mailnotifyTips.url=webmailDomain+LinksConfig.mailnotifyTips.url+"?stype=tips";
              Links.show("mailnotifyTips");
            },"2":function(){
              LinksConfig.safeTips.url=webmailDomain+LinksConfig.safeTips.url+"?stype=tips";
              Links.show("safeTips");
            },"3":function(){
              Links.show("smtpsave");
              var _=document.getElementById("smtpsave").contentWindow,$=setInterval(function(){
                if(_.isReady===true){
                  _.document.getElementById("r1").checked=true;
                  clearTimeout($);
                }
              },200);
            },"4":function(){
              Links.show("autoSaveContact");
              var _=document.getElementById("autoSaveContact").contentWindow,$=setInterval(function(){
                if(_.isReady===true){
                  _.document.getElementById("autoSave").checked=true;
                  clearTimeout($);
                }
              },200);
            },"5":function(){
              LinksConfig.billdeliverTips.url=webmailDomain+LinksConfig.billdeliverTips.url+"?stype=tips";
              Links.show("billdeliverTips");
            }};
          E[B.data.operate]();
        }
      }
    });
    this.howShow&&this.show();
  },request:function(){
  },show:function(){
    if(this.showFlag!=1){
      top.addBehavior("\u529f\u80fd\u5f15\u5bfctips\u89e6\u53d1\u91cf");
      this.showFlag=1;
    }
    var F=this.elem.offset(),B=F.left,A=this.elem[0].offsetWidth,$=this.elem[0].offsetHeight,D=this.win,_=this.direction;
    if(F.top>0){
      this.top=F.top;
    }
    if(F.left>0){
      this.left=F.left;
      B=this.left;
    }
    if($>0){
      this.offsetHeight=$;
    }
    if(_==="deflaut"||(_==="left"&&_==="right")){
      if(this.left<20){
        B=0;
        this.icoJ.css({marginLeft:this.left+"px"});
      }else {
        var C=Math.min(D.document.body.clientWidth,D.document.documentElement.clientWidth),E=C-(B+A);
        if(E>this.width+5){
          B=B-18;
          this.icoJ.css({marginLeft:18+"px"});
        }else {
          B=B-this.width+A+5;
          this.icoJ.css({marginLeft:this.width-5-A/2-18+"px"});
        }
      }
    }
    this.tipsContainer.css({top:this.top+this.offsetHeight-10+"px",left:B+"px",display:"block"});
  },unbind:function(){
    this.elem.unbind("mouseover.tips");
    this.htmlContainer.unbind("click.tips");
    this.tipsContainer[0].parentNode&&this.tipsContainer[0].parentNode.removeChild(this.tipsContainer[0]);
  }};
function setTips(){
  if(!top.AdLink){
    return ;
  }
  var A=top.AdLink.tips;
  if(!A){
    return ;
  }
  if(Object.prototype.toString.call(A)!=="[object Array]"){
    return ;
  }
  var _=/([^\/]*?\.[a-z]+)\?.*$/i;
  setInterval(function(){
    var B=document.body.getElementsByTagName("iframe");
    $.each(top.AdLink.tips,function(C,B){
      if($.trim(B.pageurl)==="main.htm"){
        var A=B.id;
        if(A in tips.list&&window["caiXunTip"+A]){
          window["caiXunTip"+A].show();
        }else {
          tips.list[A]=1;
          var _=document.getElementById($.trim(B.elementid));
          if(_){
            window["caiXunTip"+A]=new tips({imgSrc:B.imageurl,id:$.trim(B.elementid),content:B.content,data:B},window);
          }
        }
      }
    });
    $.each(B,function(E,B){
      if(B.parentNode.style.display==="none"){
        return ;
      }
      var C=_.exec(B.src);
      if(!C){
        return ;
      }
      var D=C[1];
      $.each(A,function(E,A){
        if($.trim(A.pageurl)===$.trim(D)){
          var C=B.contentWindow,_=A.id;
          if(!(tips.list[_])||(_ in tips.list&&!C["caiXunTip"+_])){
            tips.list[_]=1;
            (function(B,A){
              var $=setInterval(function(){
                if(B.document&&B.document.getElementById(A.elementid)&&B.jQuery){
                  B["caiXunTip"+_]=new tips({imgSrc:A.imageurl,id:A.elementid,content:A.content,data:A},B);
                  clearTimeout($);
                }
              },500);
            })(B.contentWindow,A);
          }else {
            if(tips.list[_]&&C["caiXunTip"+_]){
              C["caiXunTip"+_].show();
            }
          }
        }
      });
    });
  },1000);
}
var RemindTip={element:null,configId:32,contentId:"",show:function(_,$){
    if(top.OnlineTip&&!top.OnlineTip.isOpen(0)){
      return ;
    }
    setTimeout(function(){
      Utils.waitForReady("PopTip.isClosed",function(){
        RemindTip.showRemindTip(_,$);
      });
    },60000);
  },showRemindTip:function(A,_){
    RemindTip.isClosed=false;
    PopTip.isClosed=false;
    if(!RemindTip.element){
      RemindTip.element=document.createElement("div");
      RemindTip.element.id="remindTip";
      RemindTip.element.className="remindTip";
      RemindTip.element.style.position="absolute";
      RemindTip.element.style.right="1px";
      RemindTip.element.style.bottom="0";
      RemindTip.element.style.display="none";
      RemindTip.element.style.zIndex=9999;
      document.body.appendChild(RemindTip.element);
    }
    RemindTip.element.innerHTML=RemindTip.getHtml(A,_);
    var G=$("#popContent").find("a");
    G.attr("behavior","\u53f3\u4e0b\u89d2\u5e7f\u544a\u63d0\u9192\u94fe\u63a5");
    G.bind("click",RemindTip.setClickTag);
    var F=RemindTip,E=0,B=0,C=window.setInterval(D,100);
    function D(){
      if(RemindTip.isClosed){
        F.element.style.display="none";
        RemindTip.isClosed=false;
        window.clearInterval(C);
      }else {
        F.element.style.display="block";
        E=F.element.offsetHeight;
        if(B<=E+1){
          F.element.style.bottom=(-E+B).toString()+"px";
        }else {
          window.clearInterval(C);
          B=0;
          if(!F.isOver){
            F.timerClose=setTimeout(F.close,20000);
          }
        }
        var $=30*(E-B)/E;
        B+=$<2?2:$;
      }
    }
  },timerClose:0,isClosed:false,isOver:false,close:function(){
    var $=RemindTip;
    $.element.style.bottom=(-$.element.offsetHeight).toString()+"px";
    $.element.style.display="none";
    $.isClosed=true;
    PopTip.isClosed=true;
  },mouseMove:function(){
    isOver=true;
    clearTimeout(RemindTip.timerClose);
  },mouseOut:function(){
    isOver=false;
    this.timerClose=setTimeout(RemindTip.close,5000);
  },getHtml:function(_,$){
    var A="<div class=\"pop-rbBar remindPop-rbBar\">"+"<div class=\"remindPop-wb\"  onmousemove=\"RemindTip.mouseMove()\" onmouseout=\"RemindTip.mouseOut()\">"+"<p class=\"ta_r mr_5\"><a title=\"\u70b9\u51fb\u5173\u95ed\" onclick=\"RemindTip.setClickTag();return false;\" behavior=\"\u53f3\u4e0b\u89d2\u5e7f\u544a\u63d0\u9192\u5173\u95ed\" class=\"pop-rb_close\" href=\"#\"></a>{title}</p>"+"<div class=\"remindPop-rbBar-main\" id=\"popContent\">{text} </div>"+"</div>"+"</div>";
    return String.format(A,{title:_,text:$});
  },rollTitleCfg:{"orgTitle":document.title,"mailTitle":"","printSpeed":420,"rollSpeed":200,"strIndex":0,"timeHandler":null,"run":1,"isBindEvent":0},allDocOnClick:function(){
    RemindTip.reSetRollCfg();
    RemindTip.cancelDocClickEvent();
  },reSetRollCfg:function(){
    RemindTip.rollTitleCfg.run=RemindTip.rollTitleCfg.strIndex=0;
    RemindTip.rollTitleCfg.timeHandler=null;
    document.title=this.rollTitleCfg.orgTitle;
  },runRollTitle:function(){
    if(this.rollTitleCfg.timeHandler){
      clearTimeout(this.rollTitleCfg.timeHandler);
    }
    if(!this.rollTitleCfg.run){
      this.rollTitleCfg.run=1;
      return ;
    }
    var $=this.rollTitleCfg.mailTitle;
    document.title=$.substring(this.rollTitleCfg.strIndex,$.length)+" "+$;
    this.rollTitleCfg.strIndex++;
    if(this.rollTitleCfg.strIndex>$.length){
      this.rollTitleCfg.strIndex=0;
    }
    this.rollTitleCfg.timeHandler=setTimeout("RemindTip.runRollTitle()",this.rollTitleCfg.printSpeed);
  },playTipSound:function(){
    $(document.body).append("<embed id=\"tipSound\" src=\""+top.rmResourcePath+"/images/receiveMail.wav\" pluginspage=\"http://www.microsoft.com/isapi/redir.dll?prd=windows&amp;sbp=mediaplayer&amp;ar=media&amp;sba=plugin&amp;\" type=\"audio/x-wav\" border=\"0\" width=\"0px\" height=\"0px\" hidden=\"true\" showcontrols=\"false\" showaudiocontrols=\"false\" showstatusbar=\"false\" autostart=\"true\" loop=\"false\" enablecontextmenu=\"false\"></embed>");
    setTimeout(function(){
      $("#tipSound").remove();
    },1200);
  },setClickTag:function(){
    RemindTip.close();
    setOSUserConfigValue(RemindTip.configId,RemindTip.contentId);
  }};
ImgEditorMenu={};
ImgEditorMenu.show=function(){
  var $=this;
  clearTimeout($.hideTimer);
  $.slider.attr("title",$.sliderTitle).css({"width":$.sliderLen,"left":$.sliderLeft});
  $.setOffset();
  $.element.show();
};
ImgEditorMenu.setOffset=function(){
  var $=this,E=$.controlEl.offset(),B=E.left,C=E.top,_=$.ImgDoc.scrollLeft(),D=$.ImgDoc.scrollTop();
  B=(B-_)<0?0:(B-_);
  C=(C-D)<0?0:(C-D);
  B=B+$.options.left;
  C=C+$.options.top;
  var F=$.pDoc.scrollLeft(),A=$.pDoc.scrollTop();
  $.left=F>B?F:B;
  $.top=A>C?A:C;
  $.element.css({"left":$.left,"top":$.top});
};
ImgEditorMenu.hide=function(_){
  var $=this;
  if($.element){
    if(_){
      $.hideTimer=setTimeout(function(){
        if($.element){
          $.element.hide();
          $.remove();
        }
      },300);
    }else {
      $.element.hide();
      $.remove();
    }
  }
};
ImgEditorMenu.remove=function(){
  this.element.remove();
  delete this.element;
};
ImgEditorMenu.click=function($){
  var _=$.target.getAttribute("func");
  if(_&&ImgEditorMenu[_]){
    ImgEditorMenu[_]($);
    return false;
  }
};
ImgEditorMenu.zoomout=function(){
  var $=this;
  $.zoomCur--;
  $.zoomCur=$.zoomCur<$.zoomMin?$.zoomMin:$.zoomCur;
  $.zoommove();
};
ImgEditorMenu.zoomin=function(){
  var $=this;
  $.zoomCur++;
  $.zoomCur=$.zoomCur>$.zoomMax?$.zoomMax:$.zoomCur;
  $.zoommove();
};
ImgEditorMenu.zoomratio=function(A){
  var _=this;
  _.zoomCur=_.zoomMax/2;
  $(A.target).removeClass("menubaRatio").addClass("menubarall").attr("title","\u6700\u4f73\u5c3a\u5bf8").attr("func","zoombarall");
  _.zoommove();
};
ImgEditorMenu.zoombarall=function(B){
  var _=this,A=_.ImgDoc.width(),C=_.controlElW;
  _.zoomCur=(A/C/_.scale)*100;
  _.zoomCur=Math.round(_.zoomCur*10)/10;
  _.zoomCur=_.zoomCur>_.zoomMax?_.zoomMax:_.zoomCur;
  $(B.target).removeClass("menubarall").addClass("menubaRatio").attr("title","\u539f\u59cb\u5c3a\u5bf8").attr("func","zoomratio");
  _.zoommove();
};
ImgEditorMenu.zoommove=function(){
  var $=this;
  $.sliderTitle=$.zoomCur*$.scale+"%";
  $.sliderLeft=($.zoomCur-$.zoomMin)*$.mark+$.sliderLeftMin;
  $.slider.attr("title",$.sliderTitle).css({"left":$.sliderLeft});
  $.controlEl.attr("sliderTitle",$.sliderTitle).attr("sliderLeft",$.sliderLeft);
  $.controlEl.css({"width":$.zoomCur*$.scale*$.controlElW/100,"height":$.zoomCur*$.scale*$.controlElH/100});
  $.setOffset();
};
ImgEditorMenu.mousedown=function(A){
  var _=ImgEditorMenu,$=A.target.id;
  if($&&$=="zoomhandle"){
    _.moveStart=true;
    _.startX=A.clientX;
  }
};
ImgEditorMenu.mouseover=function(_){
  var $=ImgEditorMenu;
  clearTimeout($.hideTimer);
};
ImgEditorMenu.mousemove=function(_){
  var $=ImgEditorMenu;
  if($.moveStart){
    $.moveX=_.clientX-$.startX;
    $.startX=_.clientX;
    $.move();
  }
};
ImgEditorMenu.mouseup=function(_){
  var $=ImgEditorMenu;
  if($.moveStart){
    $.moveX=_.clientX-$.startX;
    $.startX=_.clientX;
    $.moveStart=false;
    $.move();
  }
};
ImgEditorMenu.mouseout=function(_){
  var $=ImgEditorMenu;
  if($.moveStart&&(_.clientY<$.top||_.clientY>$.top+$.height)){
    $.moveStart=false;
    $.move();
  }
  $.hide(true);
};
ImgEditorMenu.move=function(){
  var $=this;
  $.sliderLeft=$.sliderLeft+$.moveX;
  if($.sliderLeft<$.sliderLeftMin){
    $.sliderLeft=$.sliderLeftMin;
  }else {
    if($.sliderLeft>$.sliderLeftMax){
      $.sliderLeft=$.sliderLeftMax;
    }
  }
  var _=($.sliderLeft-$.sliderLeftMin+$.mark)*$.scalePerPx;
  $.zoomCur=_/$.scale;
  $.sliderTitle=_+"%";
  $.slider.attr("title",$.sliderTitle).css({"left":$.sliderLeft});
  if(!$.moveStart){
    $.controlEl.attr("sliderTitle",$.sliderTitle).attr("sliderLeft",$.sliderLeft);
    $.controlEl.css({"width":_*$.controlElW/100,"height":_*$.controlElH/100});
    $.setOffset();
  }
};
ImgEditorMenu.del=function(){
  this.hide();
  this.controlEl.remove();
};
ImgEditorMenu.init=function(A,B,E,D,F){
  var _=this;
  _.options={zoomMin:1,zoomMax:8,scale:25,mark:10,sliderLen:10,top:0,left:0,minWidth:400,minHeight:300};
  for(i in F){
    _.options[i]=F[i];
  }
  _.moveStart=false;
  _.controlEl=A;
  _.pDoc=B;
  _.ImgDoc=E;
  _.zoomMax=_.options.zoomMax;
  _.zoomMin=_.options.zoomMin;
  _.mark=_.options.mark;
  _.scale=_.options.scale;
  _.sliderLen=_.options.sliderLen;
  _.minWidth=_.options.minWidth;
  _.minHeight=_.options.minHeight;
  _.zoom=_.zoomMax-_.zoomMin;
  _.slideLen=_.zoom*_.mark;
  _.scalePerPx=_.scale/_.mark;
  _.sliderLeftMin=-_.sliderLen/2;
  _.sliderLeftMax=_.slideLen+_.sliderLeftMin;
  _.sliderTitle=A.attr("sliderTitle")||"100%";
  _.scaleCur=parseFloat(_.sliderTitle);
  _.scaleCur=isNaN(_.scaleCur)?100:_.scaleCur;
  _.zoomCur=_.scaleCur/_.scale;
  var C=A.attr("sliderLeft")/1;
  C=isNaN(C)?null:C;
  _.sliderLeft=C||(_.zoomCur-_.zoomMin)*_.mark+_.sliderLeftMin;
  _.controlElW=A.width()/_.scaleCur*100;
  _.controlElH=A.height()/_.scaleCur*100;
  if(!_.element||!B.find("div#divImgEditorMenuBar")){
    B.append(D);
    _.element=$(B.find("div#divImgEditorMenuBar"));
    _.height=_.element.outerHeight(true);
    _.width=_.element.outerWidth(true);
    _.slider=_.element.find("a#zoomhandle");
    _.slider.parent().width(_.slideLen);
    _.element.click(_.click);
    _.element.mouseover(_.mouseover);
    _.element.mousedown(_.mousedown);
    _.element.mousemove(_.mousemove);
    _.element.mouseup(_.mouseup);
    _.element.mouseout(_.mouseout);
  }
  if(_.controlElW<_.minWidth||_.controlElH<_.minHeight){
    return ;
  }
  _.show();
};